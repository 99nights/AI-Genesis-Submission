(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function i(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(r){if(r.ep)return;r.ep=!0;const c=i(r);fetch(r.href,c)}})();function ug(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var su={exports:{}},zs={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dh;function Pb(){if(dh)return zs;dh=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,r,c){var f=null;if(c!==void 0&&(f=""+c),r.key!==void 0&&(f=""+r.key),"key"in r){c={};for(var h in r)h!=="key"&&(c[h]=r[h])}else c=r;return r=c.ref,{$$typeof:n,type:s,key:f,ref:r!==void 0?r:null,props:c}}return zs.Fragment=e,zs.jsx=i,zs.jsxs=i,zs}var fh;function qb(){return fh||(fh=1,su.exports=Pb()),su.exports}var u=qb(),ou={exports:{}},Ce={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph;function kb(){if(ph)return Ce;ph=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),S=Symbol.iterator;function w(_){return _===null||typeof _!="object"?null:(_=S&&_[S]||_["@@iterator"],typeof _=="function"?_:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,P={};function k(_,L,$){this.props=_,this.context=L,this.refs=P,this.updater=$||C}k.prototype.isReactComponent={},k.prototype.setState=function(_,L){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,L,"setState")},k.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function V(){}V.prototype=k.prototype;function q(_,L,$){this.props=_,this.context=L,this.refs=P,this.updater=$||C}var D=q.prototype=new V;D.constructor=q,I(D,k.prototype),D.isPureReactComponent=!0;var R=Array.isArray;function z(){}var F={H:null,A:null,T:null,S:null},ie=Object.prototype.hasOwnProperty;function K(_,L,$){var se=$.ref;return{$$typeof:n,type:_,key:L,ref:se!==void 0?se:null,props:$}}function Y(_,L){return K(_.type,L,_.props)}function fe(_){return typeof _=="object"&&_!==null&&_.$$typeof===n}function ue(_){var L={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function($){return L[$]})}var Ne=/\/+/g;function we(_,L){return typeof _=="object"&&_!==null&&_.key!=null?ue(""+_.key):L.toString(36)}function Re(_){switch(_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:switch(typeof _.status=="string"?_.then(z,z):(_.status="pending",_.then(function(L){_.status==="pending"&&(_.status="fulfilled",_.value=L)},function(L){_.status==="pending"&&(_.status="rejected",_.reason=L)})),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason}}throw _}function A(_,L,$,se,me){var ye=typeof _;(ye==="undefined"||ye==="boolean")&&(_=null);var te=!1;if(_===null)te=!0;else switch(ye){case"bigint":case"string":case"number":te=!0;break;case"object":switch(_.$$typeof){case n:case e:te=!0;break;case v:return te=_._init,A(te(_._payload),L,$,se,me)}}if(te)return me=me(_),te=se===""?"."+we(_,0):se,R(me)?($="",te!=null&&($=te.replace(Ne,"$&/")+"/"),A(me,L,$,"",function(ce){return ce})):me!=null&&(fe(me)&&(me=Y(me,$+(me.key==null||_&&_.key===me.key?"":(""+me.key).replace(Ne,"$&/")+"/")+te)),L.push(me)),1;te=0;var Q=se===""?".":se+":";if(R(_))for(var W=0;W<_.length;W++)se=_[W],ye=Q+we(se,W),te+=A(se,L,$,ye,me);else if(W=w(_),typeof W=="function")for(_=W.call(_),W=0;!(se=_.next()).done;)se=se.value,ye=Q+we(se,W++),te+=A(se,L,$,ye,me);else if(ye==="object"){if(typeof _.then=="function")return A(Re(_),L,$,se,me);throw L=String(_),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return te}function B(_,L,$){if(_==null)return _;var se=[],me=0;return A(_,se,"","",function(ye){return L.call($,ye,me++)}),se}function Z(_){if(_._status===-1){var L=_._result;L=L(),L.then(function($){(_._status===0||_._status===-1)&&(_._status=1,_._result=$)},function($){(_._status===0||_._status===-1)&&(_._status=2,_._result=$)}),_._status===-1&&(_._status=0,_._result=L)}if(_._status===1)return _._result.default;throw _._result}var re=typeof reportError=="function"?reportError:function(_){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof _=="object"&&_!==null&&typeof _.message=="string"?String(_.message):String(_),error:_});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",_);return}console.error(_)},ae={map:B,forEach:function(_,L,$){B(_,function(){L.apply(this,arguments)},$)},count:function(_){var L=0;return B(_,function(){L++}),L},toArray:function(_){return B(_,function(L){return L})||[]},only:function(_){if(!fe(_))throw Error("React.Children.only expected to receive a single React element child.");return _}};return Ce.Activity=b,Ce.Children=ae,Ce.Component=k,Ce.Fragment=i,Ce.Profiler=r,Ce.PureComponent=q,Ce.StrictMode=s,Ce.Suspense=y,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(_){return F.H.useMemoCache(_)}},Ce.cache=function(_){return function(){return _.apply(null,arguments)}},Ce.cacheSignal=function(){return null},Ce.cloneElement=function(_,L,$){if(_==null)throw Error("The argument must be a React element, but you passed "+_+".");var se=I({},_.props),me=_.key;if(L!=null)for(ye in L.key!==void 0&&(me=""+L.key),L)!ie.call(L,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&L.ref===void 0||(se[ye]=L[ye]);var ye=arguments.length-2;if(ye===1)se.children=$;else if(1<ye){for(var te=Array(ye),Q=0;Q<ye;Q++)te[Q]=arguments[Q+2];se.children=te}return K(_.type,me,se)},Ce.createContext=function(_){return _={$$typeof:f,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null},_.Provider=_,_.Consumer={$$typeof:c,_context:_},_},Ce.createElement=function(_,L,$){var se,me={},ye=null;if(L!=null)for(se in L.key!==void 0&&(ye=""+L.key),L)ie.call(L,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(me[se]=L[se]);var te=arguments.length-2;if(te===1)me.children=$;else if(1<te){for(var Q=Array(te),W=0;W<te;W++)Q[W]=arguments[W+2];me.children=Q}if(_&&_.defaultProps)for(se in te=_.defaultProps,te)me[se]===void 0&&(me[se]=te[se]);return K(_,ye,me)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(_){return{$$typeof:h,render:_}},Ce.isValidElement=fe,Ce.lazy=function(_){return{$$typeof:v,_payload:{_status:-1,_result:_},_init:Z}},Ce.memo=function(_,L){return{$$typeof:m,type:_,compare:L===void 0?null:L}},Ce.startTransition=function(_){var L=F.T,$={};F.T=$;try{var se=_(),me=F.S;me!==null&&me($,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(z,re)}catch(ye){re(ye)}finally{L!==null&&$.types!==null&&(L.types=$.types),F.T=L}},Ce.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Ce.use=function(_){return F.H.use(_)},Ce.useActionState=function(_,L,$){return F.H.useActionState(_,L,$)},Ce.useCallback=function(_,L){return F.H.useCallback(_,L)},Ce.useContext=function(_){return F.H.useContext(_)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(_,L){return F.H.useDeferredValue(_,L)},Ce.useEffect=function(_,L){return F.H.useEffect(_,L)},Ce.useEffectEvent=function(_){return F.H.useEffectEvent(_)},Ce.useId=function(){return F.H.useId()},Ce.useImperativeHandle=function(_,L,$){return F.H.useImperativeHandle(_,L,$)},Ce.useInsertionEffect=function(_,L){return F.H.useInsertionEffect(_,L)},Ce.useLayoutEffect=function(_,L){return F.H.useLayoutEffect(_,L)},Ce.useMemo=function(_,L){return F.H.useMemo(_,L)},Ce.useOptimistic=function(_,L){return F.H.useOptimistic(_,L)},Ce.useReducer=function(_,L,$){return F.H.useReducer(_,L,$)},Ce.useRef=function(_){return F.H.useRef(_)},Ce.useState=function(_){return F.H.useState(_)},Ce.useSyncExternalStore=function(_,L,$){return F.H.useSyncExternalStore(_,L,$)},Ce.useTransition=function(){return F.H.useTransition()},Ce.version="19.2.0",Ce}var mh;function ku(){return mh||(mh=1,ou.exports=kb()),ou.exports}var T=ku();const dg=ug(T);var ru={exports:{}},Os={},lu={exports:{}},cu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hh;function Lb(){return hh||(hh=1,(function(n){function e(A,B){var Z=A.length;A.push(B);e:for(;0<Z;){var re=Z-1>>>1,ae=A[re];if(0<r(ae,B))A[re]=B,A[Z]=ae,Z=re;else break e}}function i(A){return A.length===0?null:A[0]}function s(A){if(A.length===0)return null;var B=A[0],Z=A.pop();if(Z!==B){A[0]=Z;e:for(var re=0,ae=A.length,_=ae>>>1;re<_;){var L=2*(re+1)-1,$=A[L],se=L+1,me=A[se];if(0>r($,Z))se<ae&&0>r(me,$)?(A[re]=me,A[se]=Z,re=se):(A[re]=$,A[L]=Z,re=L);else if(se<ae&&0>r(me,Z))A[re]=me,A[se]=Z,re=se;else break e}}return B}function r(A,B){var Z=A.sortIndex-B.sortIndex;return Z!==0?Z:A.id-B.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var f=Date,h=f.now();n.unstable_now=function(){return f.now()-h}}var y=[],m=[],v=1,b=null,S=3,w=!1,C=!1,I=!1,P=!1,k=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function D(A){for(var B=i(m);B!==null;){if(B.callback===null)s(m);else if(B.startTime<=A)s(m),B.sortIndex=B.expirationTime,e(y,B);else break;B=i(m)}}function R(A){if(I=!1,D(A),!C)if(i(y)!==null)C=!0,z||(z=!0,ue());else{var B=i(m);B!==null&&Re(R,B.startTime-A)}}var z=!1,F=-1,ie=5,K=-1;function Y(){return P?!0:!(n.unstable_now()-K<ie)}function fe(){if(P=!1,z){var A=n.unstable_now();K=A;var B=!0;try{e:{C=!1,I&&(I=!1,V(F),F=-1),w=!0;var Z=S;try{t:{for(D(A),b=i(y);b!==null&&!(b.expirationTime>A&&Y());){var re=b.callback;if(typeof re=="function"){b.callback=null,S=b.priorityLevel;var ae=re(b.expirationTime<=A);if(A=n.unstable_now(),typeof ae=="function"){b.callback=ae,D(A),B=!0;break t}b===i(y)&&s(y),D(A)}else s(y);b=i(y)}if(b!==null)B=!0;else{var _=i(m);_!==null&&Re(R,_.startTime-A),B=!1}}break e}finally{b=null,S=Z,w=!1}B=void 0}}finally{B?ue():z=!1}}}var ue;if(typeof q=="function")ue=function(){q(fe)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,we=Ne.port2;Ne.port1.onmessage=fe,ue=function(){we.postMessage(null)}}else ue=function(){k(fe,0)};function Re(A,B){F=k(function(){A(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(A){A.callback=null},n.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<A?Math.floor(1e3/A):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(A){switch(S){case 1:case 2:case 3:var B=3;break;default:B=S}var Z=S;S=B;try{return A()}finally{S=Z}},n.unstable_requestPaint=function(){P=!0},n.unstable_runWithPriority=function(A,B){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var Z=S;S=A;try{return B()}finally{S=Z}},n.unstable_scheduleCallback=function(A,B,Z){var re=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?re+Z:re):Z=re,A){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=Z+ae,A={id:v++,callback:B,priorityLevel:A,startTime:Z,expirationTime:ae,sortIndex:-1},Z>re?(A.sortIndex=Z,e(m,A),i(y)===null&&A===i(m)&&(I?(V(F),F=-1):I=!0,Re(R,Z-re))):(A.sortIndex=ae,e(y,A),C||w||(C=!0,z||(z=!0,ue()))),A},n.unstable_shouldYield=Y,n.unstable_wrapCallback=function(A){var B=S;return function(){var Z=S;S=B;try{return A.apply(this,arguments)}finally{S=Z}}}})(cu)),cu}var gh;function jb(){return gh||(gh=1,lu.exports=Lb()),lu.exports}var uu={exports:{}},Tt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh;function Vb(){if(yh)return Tt;yh=1;var n=ku();function e(y){var m="https://react.dev/errors/"+y;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+y+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},r=Symbol.for("react.portal");function c(y,m,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:y,containerInfo:m,implementation:v}}var f=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(y,m){if(y==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Tt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Tt.createPortal=function(y,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return c(y,m,null,v)},Tt.flushSync=function(y){var m=f.T,v=s.p;try{if(f.T=null,s.p=2,y)return y()}finally{f.T=m,s.p=v,s.d.f()}},Tt.preconnect=function(y,m){typeof y=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(y,m))},Tt.prefetchDNS=function(y){typeof y=="string"&&s.d.D(y)},Tt.preinit=function(y,m){if(typeof y=="string"&&m&&typeof m.as=="string"){var v=m.as,b=h(v,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?s.d.S(y,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:w}):v==="script"&&s.d.X(y,{crossOrigin:b,integrity:S,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Tt.preinitModule=function(y,m){if(typeof y=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=h(m.as,m.crossOrigin);s.d.M(y,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(y)},Tt.preload=function(y,m){if(typeof y=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,b=h(v,m.crossOrigin);s.d.L(y,v,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Tt.preloadModule=function(y,m){if(typeof y=="string")if(m){var v=h(m.as,m.crossOrigin);s.d.m(y,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(y)},Tt.requestFormReset=function(y){s.d.r(y)},Tt.unstable_batchedUpdates=function(y,m){return y(m)},Tt.useFormState=function(y,m,v){return f.H.useFormState(y,m,v)},Tt.useFormStatus=function(){return f.H.useHostTransitionStatus()},Tt.version="19.2.0",Tt}var xh;function Bb(){if(xh)return uu.exports;xh=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),uu.exports=Vb(),uu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh;function Gb(){if(vh)return Os;vh=1;var n=jb(),e=ku(),i=Bb();function s(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function c(t){var a=t,o=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(o=a.return),t=a.return;while(t)}return a.tag===3?o:null}function f(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function h(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function y(t){if(c(t)!==t)throw Error(s(188))}function m(t){var a=t.alternate;if(!a){if(a=c(t),a===null)throw Error(s(188));return a!==t?null:t}for(var o=t,l=a;;){var g=o.return;if(g===null)break;var x=g.alternate;if(x===null){if(l=g.return,l!==null){o=l;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===o)return y(g),t;if(x===l)return y(g),a;x=x.sibling}throw Error(s(188))}if(o.return!==l.return)o=g,l=x;else{for(var N=!1,E=g.child;E;){if(E===o){N=!0,o=g,l=x;break}if(E===l){N=!0,l=g,o=x;break}E=E.sibling}if(!N){for(E=x.child;E;){if(E===o){N=!0,o=x,l=g;break}if(E===l){N=!0,l=x,o=g;break}E=E.sibling}if(!N)throw Error(s(189))}}if(o.alternate!==l)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?t:a}function v(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=v(t),a!==null)return a;t=t.sibling}return null}var b=Object.assign,S=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),V=Symbol.for("react.consumer"),q=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),fe=Symbol.iterator;function ue(t){return t===null||typeof t!="object"?null:(t=fe&&t[fe]||t["@@iterator"],typeof t=="function"?t:null)}var Ne=Symbol.for("react.client.reference");function we(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ne?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case I:return"Fragment";case k:return"Profiler";case P:return"StrictMode";case R:return"Suspense";case z:return"SuspenseList";case K:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case C:return"Portal";case q:return t.displayName||"Context";case V:return(t._context.displayName||"Context")+".Consumer";case D:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case F:return a=t.displayName||null,a!==null?a:we(t.type)||"Memo";case ie:a=t._payload,t=t._init;try{return we(t(a))}catch{}}return null}var Re=Array.isArray,A=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},re=[],ae=-1;function _(t){return{current:t}}function L(t){0>ae||(t.current=re[ae],re[ae]=null,ae--)}function $(t,a){ae++,re[ae]=t.current,t.current=a}var se=_(null),me=_(null),ye=_(null),te=_(null);function Q(t,a){switch($(ye,a),$(me,t),$(se,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?Pm(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=Pm(a),t=qm(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}L(se),$(se,t)}function W(){L(se),L(me),L(ye)}function ce(t){t.memoizedState!==null&&$(te,t);var a=se.current,o=qm(a,t.type);a!==o&&($(me,t),$(se,o))}function je(t){me.current===t&&(L(se),L(me)),te.current===t&&(L(te),Vs._currentValue=Z)}var Ye,Ze;function ke(t){if(Ye===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);Ye=a&&a[1]||"",Ze=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ye+t+Ze}var ht=!1;function ct(t,a){if(!t||ht)return"";ht=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var ne=function(){throw Error()};if(Object.defineProperty(ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ne,[])}catch(J){var O=J}Reflect.construct(t,[],ne)}else{try{ne.call()}catch(J){O=J}t.call(ne.prototype)}}else{try{throw Error()}catch(J){O=J}(ne=t())&&typeof ne.catch=="function"&&ne.catch(function(){})}}catch(J){if(J&&O&&typeof J.stack=="string")return[J.stack,O.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=l.DetermineComponentFrameRoot(),N=x[0],E=x[1];if(N&&E){var M=N.split(`
`),H=E.split(`
`);for(g=l=0;l<M.length&&!M[l].includes("DetermineComponentFrameRoot");)l++;for(;g<H.length&&!H[g].includes("DetermineComponentFrameRoot");)g++;if(l===M.length||g===H.length)for(l=M.length-1,g=H.length-1;1<=l&&0<=g&&M[l]!==H[g];)g--;for(;1<=l&&0<=g;l--,g--)if(M[l]!==H[g]){if(l!==1||g!==1)do if(l--,g--,0>g||M[l]!==H[g]){var X=`
`+M[l].replace(" at new "," at ");return t.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",t.displayName)),X}while(1<=l&&0<=g);break}}}finally{ht=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?ke(o):""}function nt(t,a){switch(t.tag){case 26:case 27:case 5:return ke(t.type);case 16:return ke("Lazy");case 13:return t.child!==a&&a!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return ct(t.type,!1);case 11:return ct(t.type.render,!1);case 1:return ct(t.type,!0);case 31:return ke("Activity");default:return""}}function _n(t){try{var a="",o=null;do a+=nt(t,o),o=t,t=t.return;while(t);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var dn=Object.prototype.hasOwnProperty,Zt=n.unstable_scheduleCallback,Vt=n.unstable_cancelCallback,An=n.unstable_shouldYield,oe=n.unstable_requestPaint,le=n.unstable_now,Ee=n.unstable_getCurrentPriorityLevel,Ve=n.unstable_ImmediatePriority,In=n.unstable_UserBlockingPriority,_e=n.unstable_NormalPriority,_t=n.unstable_LowPriority,Sn=n.unstable_IdlePriority,Fr=n.log,Yr=n.unstable_setDisableYieldValue,Xi=null,Bt=null;function Wn(t){if(typeof Fr=="function"&&Yr(t),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(Xi,t)}catch{}}var Gt=Math.clz32?Math.clz32:bx,xx=Math.log,vx=Math.LN2;function bx(t){return t>>>=0,t===0?32:31-(xx(t)/vx|0)|0}var eo=256,to=262144,no=4194304;function Aa(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function ao(t,a,o){var l=t.pendingLanes;if(l===0)return 0;var g=0,x=t.suspendedLanes,N=t.pingedLanes;t=t.warmLanes;var E=l&134217727;return E!==0?(l=E&~x,l!==0?g=Aa(l):(N&=E,N!==0?g=Aa(N):o||(o=E&~t,o!==0&&(g=Aa(o))))):(E=l&~x,E!==0?g=Aa(E):N!==0?g=Aa(N):o||(o=l&~t,o!==0&&(g=Aa(o)))),g===0?0:a!==0&&a!==g&&(a&x)===0&&(x=g&-g,o=a&-a,x>=o||x===32&&(o&4194048)!==0)?a:g}function Zi(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function Sx(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function md(){var t=no;return no<<=1,(no&62914560)===0&&(no=4194304),t}function Jr(t){for(var a=[],o=0;31>o;o++)a.push(t);return a}function Wi(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Nx(t,a,o,l,g,x){var N=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var E=t.entanglements,M=t.expirationTimes,H=t.hiddenUpdates;for(o=N&~o;0<o;){var X=31-Gt(o),ne=1<<X;E[X]=0,M[X]=-1;var O=H[X];if(O!==null)for(H[X]=null,X=0;X<O.length;X++){var J=O[X];J!==null&&(J.lane&=-536870913)}o&=~ne}l!==0&&hd(t,l,0),x!==0&&g===0&&t.tag!==0&&(t.suspendedLanes|=x&~(N&~a))}function hd(t,a,o){t.pendingLanes|=a,t.suspendedLanes&=~a;var l=31-Gt(a);t.entangledLanes|=a,t.entanglements[l]=t.entanglements[l]|1073741824|o&261930}function gd(t,a){var o=t.entangledLanes|=a;for(t=t.entanglements;o;){var l=31-Gt(o),g=1<<l;g&a|t[l]&a&&(t[l]|=a),o&=~g}}function yd(t,a){var o=a&-a;return o=(o&42)!==0?1:Qr(o),(o&(t.suspendedLanes|a))!==0?0:o}function Qr(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function $r(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function xd(){var t=B.p;return t!==0?t:(t=window.event,t===void 0?32:ih(t.type))}function vd(t,a){var o=B.p;try{return B.p=t,a()}finally{B.p=o}}var ea=Math.random().toString(36).slice(2),vt="__reactFiber$"+ea,Rt="__reactProps$"+ea,Za="__reactContainer$"+ea,Kr="__reactEvents$"+ea,wx="__reactListeners$"+ea,Ex="__reactHandles$"+ea,bd="__reactResources$"+ea,es="__reactMarker$"+ea;function Xr(t){delete t[vt],delete t[Rt],delete t[Kr],delete t[wx],delete t[Ex]}function Wa(t){var a=t[vt];if(a)return a;for(var o=t.parentNode;o;){if(a=o[Za]||o[vt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(t=Hm(t);t!==null;){if(o=t[vt])return o;t=Hm(t)}return a}t=o,o=t.parentNode}return null}function ei(t){if(t=t[vt]||t[Za]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function ts(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(s(33))}function ti(t){var a=t[bd];return a||(a=t[bd]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function gt(t){t[es]=!0}var Sd=new Set,Nd={};function Ia(t,a){ni(t,a),ni(t+"Capture",a)}function ni(t,a){for(Nd[t]=a,t=0;t<a.length;t++)Sd.add(a[t])}var Tx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wd={},Ed={};function Cx(t){return dn.call(Ed,t)?!0:dn.call(wd,t)?!1:Tx.test(t)?Ed[t]=!0:(wd[t]=!0,!1)}function io(t,a,o){if(Cx(a))if(o===null)t.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+o)}}function so(t,a,o){if(o===null)t.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+o)}}function Dn(t,a,o,l){if(l===null)t.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(a,o,""+l)}}function Wt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Td(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function _x(t,a,o){var l=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,x=l.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return g.call(this)},set:function(N){o=""+N,x.call(this,N)}}),Object.defineProperty(t,a,{enumerable:l.enumerable}),{getValue:function(){return o},setValue:function(N){o=""+N},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Zr(t){if(!t._valueTracker){var a=Td(t)?"checked":"value";t._valueTracker=_x(t,a,""+t[a])}}function Cd(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var o=a.getValue(),l="";return t&&(l=Td(t)?t.checked?"true":"false":t.value),t=l,t!==o?(a.setValue(t),!0):!1}function oo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ax=/[\n"\\]/g;function en(t){return t.replace(Ax,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Wr(t,a,o,l,g,x,N,E){t.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?t.type=N:t.removeAttribute("type"),a!=null?N==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Wt(a)):t.value!==""+Wt(a)&&(t.value=""+Wt(a)):N!=="submit"&&N!=="reset"||t.removeAttribute("value"),a!=null?el(t,N,Wt(a)):o!=null?el(t,N,Wt(o)):l!=null&&t.removeAttribute("value"),g==null&&x!=null&&(t.defaultChecked=!!x),g!=null&&(t.checked=g&&typeof g!="function"&&typeof g!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?t.name=""+Wt(E):t.removeAttribute("name")}function _d(t,a,o,l,g,x,N,E){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(t.type=x),a!=null||o!=null){if(!(x!=="submit"&&x!=="reset"||a!=null)){Zr(t);return}o=o!=null?""+Wt(o):"",a=a!=null?""+Wt(a):o,E||a===t.value||(t.value=a),t.defaultValue=a}l=l??g,l=typeof l!="function"&&typeof l!="symbol"&&!!l,t.checked=E?t.checked:!!l,t.defaultChecked=!!l,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(t.name=N),Zr(t)}function el(t,a,o){a==="number"&&oo(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function ai(t,a,o,l){if(t=t.options,a){a={};for(var g=0;g<o.length;g++)a["$"+o[g]]=!0;for(o=0;o<t.length;o++)g=a.hasOwnProperty("$"+t[o].value),t[o].selected!==g&&(t[o].selected=g),g&&l&&(t[o].defaultSelected=!0)}else{for(o=""+Wt(o),a=null,g=0;g<t.length;g++){if(t[g].value===o){t[g].selected=!0,l&&(t[g].defaultSelected=!0);return}a!==null||t[g].disabled||(a=t[g])}a!==null&&(a.selected=!0)}}function Ad(t,a,o){if(a!=null&&(a=""+Wt(a),a!==t.value&&(t.value=a),o==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=o!=null?""+Wt(o):""}function Id(t,a,o,l){if(a==null){if(l!=null){if(o!=null)throw Error(s(92));if(Re(l)){if(1<l.length)throw Error(s(93));l=l[0]}o=l}o==null&&(o=""),a=o}o=Wt(a),t.defaultValue=o,l=t.textContent,l===o&&l!==""&&l!==null&&(t.value=l),Zr(t)}function ii(t,a){if(a){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=a;return}}t.textContent=a}var Ix=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dd(t,a,o){var l=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?l?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":l?t.setProperty(a,o):typeof o!="number"||o===0||Ix.has(a)?a==="float"?t.cssFloat=o:t[a]=(""+o).trim():t[a]=o+"px"}function Md(t,a,o){if(a!=null&&typeof a!="object")throw Error(s(62));if(t=t.style,o!=null){for(var l in o)!o.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?t.setProperty(l,""):l==="float"?t.cssFloat="":t[l]="");for(var g in a)l=a[g],a.hasOwnProperty(g)&&o[g]!==l&&Dd(t,g,l)}else for(var x in a)a.hasOwnProperty(x)&&Dd(t,x,a[x])}function tl(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ro(t){return Mx.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Mn(){}var nl=null;function al(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var si=null,oi=null;function Rd(t){var a=ei(t);if(a&&(t=a.stateNode)){var o=t[Rt]||null;e:switch(t=a.stateNode,a.type){case"input":if(Wr(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+en(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var l=o[a];if(l!==t&&l.form===t.form){var g=l[Rt]||null;if(!g)throw Error(s(90));Wr(l,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<o.length;a++)l=o[a],l.form===t.form&&Cd(l)}break e;case"textarea":Ad(t,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ai(t,!!o.multiple,a,!1)}}}var il=!1;function Ud(t,a,o){if(il)return t(a,o);il=!0;try{var l=t(a);return l}finally{if(il=!1,(si!==null||oi!==null)&&($o(),si&&(a=si,t=oi,oi=si=null,Rd(a),t)))for(a=0;a<t.length;a++)Rd(t[a])}}function ns(t,a){var o=t.stateNode;if(o===null)return null;var l=o[Rt]||null;if(l===null)return null;o=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(s(231,a,typeof o));return o}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sl=!1;if(Rn)try{var as={};Object.defineProperty(as,"passive",{get:function(){sl=!0}}),window.addEventListener("test",as,as),window.removeEventListener("test",as,as)}catch{sl=!1}var ta=null,ol=null,lo=null;function Pd(){if(lo)return lo;var t,a=ol,o=a.length,l,g="value"in ta?ta.value:ta.textContent,x=g.length;for(t=0;t<o&&a[t]===g[t];t++);var N=o-t;for(l=1;l<=N&&a[o-l]===g[x-l];l++);return lo=g.slice(t,1<l?1-l:void 0)}function co(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function uo(){return!0}function qd(){return!1}function Ut(t){function a(o,l,g,x,N){this._reactName=o,this._targetInst=g,this.type=l,this.nativeEvent=x,this.target=N,this.currentTarget=null;for(var E in t)t.hasOwnProperty(E)&&(o=t[E],this[E]=o?o(x):x[E]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?uo:qd,this.isPropagationStopped=qd,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=uo)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=uo)},persist:function(){},isPersistent:uo}),a}var Da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fo=Ut(Da),is=b({},Da,{view:0,detail:0}),Rx=Ut(is),rl,ll,ss,po=b({},is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ul,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ss&&(ss&&t.type==="mousemove"?(rl=t.screenX-ss.screenX,ll=t.screenY-ss.screenY):ll=rl=0,ss=t),rl)},movementY:function(t){return"movementY"in t?t.movementY:ll}}),kd=Ut(po),Ux=b({},po,{dataTransfer:0}),Px=Ut(Ux),qx=b({},is,{relatedTarget:0}),cl=Ut(qx),kx=b({},Da,{animationName:0,elapsedTime:0,pseudoElement:0}),Lx=Ut(kx),jx=b({},Da,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Vx=Ut(jx),Bx=b({},Da,{data:0}),Ld=Ut(Bx),Gx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ox(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=zx[t])?!!a[t]:!1}function ul(){return Ox}var Fx=b({},is,{key:function(t){if(t.key){var a=Gx[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=co(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Hx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ul,charCode:function(t){return t.type==="keypress"?co(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?co(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Yx=Ut(Fx),Jx=b({},po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=Ut(Jx),Qx=b({},is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ul}),$x=Ut(Qx),Kx=b({},Da,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xx=Ut(Kx),Zx=b({},po,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Wx=Ut(Zx),ev=b({},Da,{newState:0,oldState:0}),tv=Ut(ev),nv=[9,13,27,32],dl=Rn&&"CompositionEvent"in window,os=null;Rn&&"documentMode"in document&&(os=document.documentMode);var av=Rn&&"TextEvent"in window&&!os,Vd=Rn&&(!dl||os&&8<os&&11>=os),Bd=" ",Gd=!1;function Hd(t,a){switch(t){case"keyup":return nv.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ri=!1;function iv(t,a){switch(t){case"compositionend":return zd(a);case"keypress":return a.which!==32?null:(Gd=!0,Bd);case"textInput":return t=a.data,t===Bd&&Gd?null:t;default:return null}}function sv(t,a){if(ri)return t==="compositionend"||!dl&&Hd(t,a)?(t=Pd(),lo=ol=ta=null,ri=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Vd&&a.locale!=="ko"?null:a.data;default:return null}}var ov={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Od(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!ov[t.type]:a==="textarea"}function Fd(t,a,o,l){si?oi?oi.push(l):oi=[l]:si=l,a=nr(a,"onChange"),0<a.length&&(o=new fo("onChange","change",null,o,l),t.push({event:o,listeners:a}))}var rs=null,ls=null;function rv(t){Am(t,0)}function mo(t){var a=ts(t);if(Cd(a))return t}function Yd(t,a){if(t==="change")return a}var Jd=!1;if(Rn){var fl;if(Rn){var pl="oninput"in document;if(!pl){var Qd=document.createElement("div");Qd.setAttribute("oninput","return;"),pl=typeof Qd.oninput=="function"}fl=pl}else fl=!1;Jd=fl&&(!document.documentMode||9<document.documentMode)}function $d(){rs&&(rs.detachEvent("onpropertychange",Kd),ls=rs=null)}function Kd(t){if(t.propertyName==="value"&&mo(ls)){var a=[];Fd(a,ls,t,al(t)),Ud(rv,a)}}function lv(t,a,o){t==="focusin"?($d(),rs=a,ls=o,rs.attachEvent("onpropertychange",Kd)):t==="focusout"&&$d()}function cv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mo(ls)}function uv(t,a){if(t==="click")return mo(a)}function dv(t,a){if(t==="input"||t==="change")return mo(a)}function fv(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var Ht=typeof Object.is=="function"?Object.is:fv;function cs(t,a){if(Ht(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var o=Object.keys(t),l=Object.keys(a);if(o.length!==l.length)return!1;for(l=0;l<o.length;l++){var g=o[l];if(!dn.call(a,g)||!Ht(t[g],a[g]))return!1}return!0}function Xd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Zd(t,a){var o=Xd(t);t=0;for(var l;o;){if(o.nodeType===3){if(l=t+o.textContent.length,t<=a&&l>=a)return{node:o,offset:a-t};t=l}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Xd(o)}}function Wd(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?Wd(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function ef(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=oo(t.document);a instanceof t.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)t=a.contentWindow;else break;a=oo(t.document)}return a}function ml(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var pv=Rn&&"documentMode"in document&&11>=document.documentMode,li=null,hl=null,us=null,gl=!1;function tf(t,a,o){var l=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;gl||li==null||li!==oo(l)||(l=li,"selectionStart"in l&&ml(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),us&&cs(us,l)||(us=l,l=nr(hl,"onSelect"),0<l.length&&(a=new fo("onSelect","select",null,a,o),t.push({event:a,listeners:l}),a.target=li)))}function Ma(t,a){var o={};return o[t.toLowerCase()]=a.toLowerCase(),o["Webkit"+t]="webkit"+a,o["Moz"+t]="moz"+a,o}var ci={animationend:Ma("Animation","AnimationEnd"),animationiteration:Ma("Animation","AnimationIteration"),animationstart:Ma("Animation","AnimationStart"),transitionrun:Ma("Transition","TransitionRun"),transitionstart:Ma("Transition","TransitionStart"),transitioncancel:Ma("Transition","TransitionCancel"),transitionend:Ma("Transition","TransitionEnd")},yl={},nf={};Rn&&(nf=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);function Ra(t){if(yl[t])return yl[t];if(!ci[t])return t;var a=ci[t],o;for(o in a)if(a.hasOwnProperty(o)&&o in nf)return yl[t]=a[o];return t}var af=Ra("animationend"),sf=Ra("animationiteration"),of=Ra("animationstart"),mv=Ra("transitionrun"),hv=Ra("transitionstart"),gv=Ra("transitioncancel"),rf=Ra("transitionend"),lf=new Map,xl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xl.push("scrollEnd");function fn(t,a){lf.set(t,a),Ia(a,[t])}var ho=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},tn=[],ui=0,vl=0;function go(){for(var t=ui,a=vl=ui=0;a<t;){var o=tn[a];tn[a++]=null;var l=tn[a];tn[a++]=null;var g=tn[a];tn[a++]=null;var x=tn[a];if(tn[a++]=null,l!==null&&g!==null){var N=l.pending;N===null?g.next=g:(g.next=N.next,N.next=g),l.pending=g}x!==0&&cf(o,g,x)}}function yo(t,a,o,l){tn[ui++]=t,tn[ui++]=a,tn[ui++]=o,tn[ui++]=l,vl|=l,t.lanes|=l,t=t.alternate,t!==null&&(t.lanes|=l)}function bl(t,a,o,l){return yo(t,a,o,l),xo(t)}function Ua(t,a){return yo(t,null,null,a),xo(t)}function cf(t,a,o){t.lanes|=o;var l=t.alternate;l!==null&&(l.lanes|=o);for(var g=!1,x=t.return;x!==null;)x.childLanes|=o,l=x.alternate,l!==null&&(l.childLanes|=o),x.tag===22&&(t=x.stateNode,t===null||t._visibility&1||(g=!0)),t=x,x=x.return;return t.tag===3?(x=t.stateNode,g&&a!==null&&(g=31-Gt(o),t=x.hiddenUpdates,l=t[g],l===null?t[g]=[a]:l.push(a),a.lane=o|536870912),x):null}function xo(t){if(50<Rs)throw Rs=0,Ic=null,Error(s(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var di={};function yv(t,a,o,l){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zt(t,a,o,l){return new yv(t,a,o,l)}function Sl(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Un(t,a){var o=t.alternate;return o===null?(o=zt(t.tag,a,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=a,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,a=t.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function uf(t,a){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,a=o.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function vo(t,a,o,l,g,x){var N=0;if(l=t,typeof t=="function")Sl(t)&&(N=1);else if(typeof t=="string")N=Nb(t,o,se.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case K:return t=zt(31,o,a,g),t.elementType=K,t.lanes=x,t;case I:return Pa(o.children,g,x,a);case P:N=8,g|=24;break;case k:return t=zt(12,o,a,g|2),t.elementType=k,t.lanes=x,t;case R:return t=zt(13,o,a,g),t.elementType=R,t.lanes=x,t;case z:return t=zt(19,o,a,g),t.elementType=z,t.lanes=x,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q:N=10;break e;case V:N=9;break e;case D:N=11;break e;case F:N=14;break e;case ie:N=16,l=null;break e}N=29,o=Error(s(130,t===null?"null":typeof t,"")),l=null}return a=zt(N,o,a,g),a.elementType=t,a.type=l,a.lanes=x,a}function Pa(t,a,o,l){return t=zt(7,t,l,a),t.lanes=o,t}function Nl(t,a,o){return t=zt(6,t,null,a),t.lanes=o,t}function df(t){var a=zt(18,null,null,0);return a.stateNode=t,a}function wl(t,a,o){return a=zt(4,t.children!==null?t.children:[],t.key,a),a.lanes=o,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var ff=new WeakMap;function nn(t,a){if(typeof t=="object"&&t!==null){var o=ff.get(t);return o!==void 0?o:(a={value:t,source:a,stack:_n(a)},ff.set(t,a),a)}return{value:t,source:a,stack:_n(a)}}var fi=[],pi=0,bo=null,ds=0,an=[],sn=0,na=null,Nn=1,wn="";function Pn(t,a){fi[pi++]=ds,fi[pi++]=bo,bo=t,ds=a}function pf(t,a,o){an[sn++]=Nn,an[sn++]=wn,an[sn++]=na,na=t;var l=Nn;t=wn;var g=32-Gt(l)-1;l&=~(1<<g),o+=1;var x=32-Gt(a)+g;if(30<x){var N=g-g%5;x=(l&(1<<N)-1).toString(32),l>>=N,g-=N,Nn=1<<32-Gt(a)+g|o<<g|l,wn=x+t}else Nn=1<<x|o<<g|l,wn=t}function El(t){t.return!==null&&(Pn(t,1),pf(t,1,0))}function Tl(t){for(;t===bo;)bo=fi[--pi],fi[pi]=null,ds=fi[--pi],fi[pi]=null;for(;t===na;)na=an[--sn],an[sn]=null,wn=an[--sn],an[sn]=null,Nn=an[--sn],an[sn]=null}function mf(t,a){an[sn++]=Nn,an[sn++]=wn,an[sn++]=na,Nn=a.id,wn=a.overflow,na=t}var bt=null,We=null,Le=!1,aa=null,on=!1,Cl=Error(s(519));function ia(t){var a=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fs(nn(a,t)),Cl}function hf(t){var a=t.stateNode,o=t.type,l=t.memoizedProps;switch(a[vt]=t,a[Rt]=l,o){case"dialog":Me("cancel",a),Me("close",a);break;case"iframe":case"object":case"embed":Me("load",a);break;case"video":case"audio":for(o=0;o<Ps.length;o++)Me(Ps[o],a);break;case"source":Me("error",a);break;case"img":case"image":case"link":Me("error",a),Me("load",a);break;case"details":Me("toggle",a);break;case"input":Me("invalid",a),_d(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Me("invalid",a);break;case"textarea":Me("invalid",a),Id(a,l.value,l.defaultValue,l.children)}o=l.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||l.suppressHydrationWarning===!0||Rm(a.textContent,o)?(l.popover!=null&&(Me("beforetoggle",a),Me("toggle",a)),l.onScroll!=null&&Me("scroll",a),l.onScrollEnd!=null&&Me("scrollend",a),l.onClick!=null&&(a.onclick=Mn),a=!0):a=!1,a||ia(t,!0)}function gf(t){for(bt=t.return;bt;)switch(bt.tag){case 5:case 31:case 13:on=!1;return;case 27:case 3:on=!0;return;default:bt=bt.return}}function mi(t){if(t!==bt)return!1;if(!Le)return gf(t),Le=!0,!1;var a=t.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||Oc(t.type,t.memoizedProps)),o=!o),o&&We&&ia(t),gf(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));We=Gm(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));We=Gm(t)}else a===27?(a=We,xa(t.type)?(t=$c,$c=null,We=t):We=a):We=bt?ln(t.stateNode.nextSibling):null;return!0}function qa(){We=bt=null,Le=!1}function _l(){var t=aa;return t!==null&&(Lt===null?Lt=t:Lt.push.apply(Lt,t),aa=null),t}function fs(t){aa===null?aa=[t]:aa.push(t)}var Al=_(null),ka=null,qn=null;function sa(t,a,o){$(Al,a._currentValue),a._currentValue=o}function kn(t){t._currentValue=Al.current,L(Al)}function Il(t,a,o){for(;t!==null;){var l=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),t===o)break;t=t.return}}function Dl(t,a,o,l){var g=t.child;for(g!==null&&(g.return=t);g!==null;){var x=g.dependencies;if(x!==null){var N=g.child;x=x.firstContext;e:for(;x!==null;){var E=x;x=g;for(var M=0;M<a.length;M++)if(E.context===a[M]){x.lanes|=o,E=x.alternate,E!==null&&(E.lanes|=o),Il(x.return,o,t),l||(N=null);break e}x=E.next}}else if(g.tag===18){if(N=g.return,N===null)throw Error(s(341));N.lanes|=o,x=N.alternate,x!==null&&(x.lanes|=o),Il(N,o,t),N=null}else N=g.child;if(N!==null)N.return=g;else for(N=g;N!==null;){if(N===t){N=null;break}if(g=N.sibling,g!==null){g.return=N.return,N=g;break}N=N.return}g=N}}function hi(t,a,o,l){t=null;for(var g=a,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var N=g.alternate;if(N===null)throw Error(s(387));if(N=N.memoizedProps,N!==null){var E=g.type;Ht(g.pendingProps.value,N.value)||(t!==null?t.push(E):t=[E])}}else if(g===te.current){if(N=g.alternate,N===null)throw Error(s(387));N.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(t!==null?t.push(Vs):t=[Vs])}g=g.return}t!==null&&Dl(a,t,o,l),a.flags|=262144}function So(t){for(t=t.firstContext;t!==null;){if(!Ht(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function La(t){ka=t,qn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function St(t){return yf(ka,t)}function No(t,a){return ka===null&&La(t),yf(t,a)}function yf(t,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},qn===null){if(t===null)throw Error(s(308));qn=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else qn=qn.next=a;return o}var xv=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(o,l){t.push(l)}};this.abort=function(){a.aborted=!0,t.forEach(function(o){return o()})}},vv=n.unstable_scheduleCallback,bv=n.unstable_NormalPriority,ut={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ml(){return{controller:new xv,data:new Map,refCount:0}}function ps(t){t.refCount--,t.refCount===0&&vv(bv,function(){t.controller.abort()})}var ms=null,Rl=0,gi=0,yi=null;function Sv(t,a){if(ms===null){var o=ms=[];Rl=0,gi=qc(),yi={status:"pending",value:void 0,then:function(l){o.push(l)}}}return Rl++,a.then(xf,xf),a}function xf(){if(--Rl===0&&ms!==null){yi!==null&&(yi.status="fulfilled");var t=ms;ms=null,gi=0,yi=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function Nv(t,a){var o=[],l={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return t.then(function(){l.status="fulfilled",l.value=a;for(var g=0;g<o.length;g++)(0,o[g])(a)},function(g){for(l.status="rejected",l.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),l}var vf=A.S;A.S=function(t,a){nm=le(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Sv(t,a),vf!==null&&vf(t,a)};var ja=_(null);function Ul(){var t=ja.current;return t!==null?t:Xe.pooledCache}function wo(t,a){a===null?$(ja,ja.current):$(ja,a.pool)}function bf(){var t=Ul();return t===null?null:{parent:ut._currentValue,pool:t}}var xi=Error(s(460)),Pl=Error(s(474)),Eo=Error(s(542)),To={then:function(){}};function Sf(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Nf(t,a,o){switch(o=t[o],o===void 0?t.push(a):o!==a&&(a.then(Mn,Mn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Ef(t),t;default:if(typeof a.status=="string")a.then(Mn,Mn);else{if(t=Xe,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=a,t.status="pending",t.then(function(l){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=l}},function(l){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Ef(t),t}throw Ba=a,xi}}function Va(t){try{var a=t._init;return a(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ba=o,xi):o}}var Ba=null;function wf(){if(Ba===null)throw Error(s(459));var t=Ba;return Ba=null,t}function Ef(t){if(t===xi||t===Eo)throw Error(s(483))}var vi=null,hs=0;function Co(t){var a=hs;return hs+=1,vi===null&&(vi=[]),Nf(vi,t,a)}function gs(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function _o(t,a){throw a.$$typeof===S?Error(s(525)):(t=Object.prototype.toString.call(a),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Tf(t){function a(j,U){if(t){var G=j.deletions;G===null?(j.deletions=[U],j.flags|=16):G.push(U)}}function o(j,U){if(!t)return null;for(;U!==null;)a(j,U),U=U.sibling;return null}function l(j){for(var U=new Map;j!==null;)j.key!==null?U.set(j.key,j):U.set(j.index,j),j=j.sibling;return U}function g(j,U){return j=Un(j,U),j.index=0,j.sibling=null,j}function x(j,U,G){return j.index=G,t?(G=j.alternate,G!==null?(G=G.index,G<U?(j.flags|=67108866,U):G):(j.flags|=67108866,U)):(j.flags|=1048576,U)}function N(j){return t&&j.alternate===null&&(j.flags|=67108866),j}function E(j,U,G,ee){return U===null||U.tag!==6?(U=Nl(G,j.mode,ee),U.return=j,U):(U=g(U,G),U.return=j,U)}function M(j,U,G,ee){var be=G.type;return be===I?X(j,U,G.props.children,ee,G.key):U!==null&&(U.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===ie&&Va(be)===U.type)?(U=g(U,G.props),gs(U,G),U.return=j,U):(U=vo(G.type,G.key,G.props,null,j.mode,ee),gs(U,G),U.return=j,U)}function H(j,U,G,ee){return U===null||U.tag!==4||U.stateNode.containerInfo!==G.containerInfo||U.stateNode.implementation!==G.implementation?(U=wl(G,j.mode,ee),U.return=j,U):(U=g(U,G.children||[]),U.return=j,U)}function X(j,U,G,ee,be){return U===null||U.tag!==7?(U=Pa(G,j.mode,ee,be),U.return=j,U):(U=g(U,G),U.return=j,U)}function ne(j,U,G){if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return U=Nl(""+U,j.mode,G),U.return=j,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case w:return G=vo(U.type,U.key,U.props,null,j.mode,G),gs(G,U),G.return=j,G;case C:return U=wl(U,j.mode,G),U.return=j,U;case ie:return U=Va(U),ne(j,U,G)}if(Re(U)||ue(U))return U=Pa(U,j.mode,G,null),U.return=j,U;if(typeof U.then=="function")return ne(j,Co(U),G);if(U.$$typeof===q)return ne(j,No(j,U),G);_o(j,U)}return null}function O(j,U,G,ee){var be=U!==null?U.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return be!==null?null:E(j,U,""+G,ee);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case w:return G.key===be?M(j,U,G,ee):null;case C:return G.key===be?H(j,U,G,ee):null;case ie:return G=Va(G),O(j,U,G,ee)}if(Re(G)||ue(G))return be!==null?null:X(j,U,G,ee,null);if(typeof G.then=="function")return O(j,U,Co(G),ee);if(G.$$typeof===q)return O(j,U,No(j,G),ee);_o(j,G)}return null}function J(j,U,G,ee,be){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return j=j.get(G)||null,E(U,j,""+ee,be);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:return j=j.get(ee.key===null?G:ee.key)||null,M(U,j,ee,be);case C:return j=j.get(ee.key===null?G:ee.key)||null,H(U,j,ee,be);case ie:return ee=Va(ee),J(j,U,G,ee,be)}if(Re(ee)||ue(ee))return j=j.get(G)||null,X(U,j,ee,be,null);if(typeof ee.then=="function")return J(j,U,G,Co(ee),be);if(ee.$$typeof===q)return J(j,U,G,No(U,ee),be);_o(U,ee)}return null}function ge(j,U,G,ee){for(var be=null,Be=null,xe=U,Ie=U=0,Pe=null;xe!==null&&Ie<G.length;Ie++){xe.index>Ie?(Pe=xe,xe=null):Pe=xe.sibling;var Ge=O(j,xe,G[Ie],ee);if(Ge===null){xe===null&&(xe=Pe);break}t&&xe&&Ge.alternate===null&&a(j,xe),U=x(Ge,U,Ie),Be===null?be=Ge:Be.sibling=Ge,Be=Ge,xe=Pe}if(Ie===G.length)return o(j,xe),Le&&Pn(j,Ie),be;if(xe===null){for(;Ie<G.length;Ie++)xe=ne(j,G[Ie],ee),xe!==null&&(U=x(xe,U,Ie),Be===null?be=xe:Be.sibling=xe,Be=xe);return Le&&Pn(j,Ie),be}for(xe=l(xe);Ie<G.length;Ie++)Pe=J(xe,j,Ie,G[Ie],ee),Pe!==null&&(t&&Pe.alternate!==null&&xe.delete(Pe.key===null?Ie:Pe.key),U=x(Pe,U,Ie),Be===null?be=Pe:Be.sibling=Pe,Be=Pe);return t&&xe.forEach(function(wa){return a(j,wa)}),Le&&Pn(j,Ie),be}function Se(j,U,G,ee){if(G==null)throw Error(s(151));for(var be=null,Be=null,xe=U,Ie=U=0,Pe=null,Ge=G.next();xe!==null&&!Ge.done;Ie++,Ge=G.next()){xe.index>Ie?(Pe=xe,xe=null):Pe=xe.sibling;var wa=O(j,xe,Ge.value,ee);if(wa===null){xe===null&&(xe=Pe);break}t&&xe&&wa.alternate===null&&a(j,xe),U=x(wa,U,Ie),Be===null?be=wa:Be.sibling=wa,Be=wa,xe=Pe}if(Ge.done)return o(j,xe),Le&&Pn(j,Ie),be;if(xe===null){for(;!Ge.done;Ie++,Ge=G.next())Ge=ne(j,Ge.value,ee),Ge!==null&&(U=x(Ge,U,Ie),Be===null?be=Ge:Be.sibling=Ge,Be=Ge);return Le&&Pn(j,Ie),be}for(xe=l(xe);!Ge.done;Ie++,Ge=G.next())Ge=J(xe,j,Ie,Ge.value,ee),Ge!==null&&(t&&Ge.alternate!==null&&xe.delete(Ge.key===null?Ie:Ge.key),U=x(Ge,U,Ie),Be===null?be=Ge:Be.sibling=Ge,Be=Ge);return t&&xe.forEach(function(Ub){return a(j,Ub)}),Le&&Pn(j,Ie),be}function $e(j,U,G,ee){if(typeof G=="object"&&G!==null&&G.type===I&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case w:e:{for(var be=G.key;U!==null;){if(U.key===be){if(be=G.type,be===I){if(U.tag===7){o(j,U.sibling),ee=g(U,G.props.children),ee.return=j,j=ee;break e}}else if(U.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===ie&&Va(be)===U.type){o(j,U.sibling),ee=g(U,G.props),gs(ee,G),ee.return=j,j=ee;break e}o(j,U);break}else a(j,U);U=U.sibling}G.type===I?(ee=Pa(G.props.children,j.mode,ee,G.key),ee.return=j,j=ee):(ee=vo(G.type,G.key,G.props,null,j.mode,ee),gs(ee,G),ee.return=j,j=ee)}return N(j);case C:e:{for(be=G.key;U!==null;){if(U.key===be)if(U.tag===4&&U.stateNode.containerInfo===G.containerInfo&&U.stateNode.implementation===G.implementation){o(j,U.sibling),ee=g(U,G.children||[]),ee.return=j,j=ee;break e}else{o(j,U);break}else a(j,U);U=U.sibling}ee=wl(G,j.mode,ee),ee.return=j,j=ee}return N(j);case ie:return G=Va(G),$e(j,U,G,ee)}if(Re(G))return ge(j,U,G,ee);if(ue(G)){if(be=ue(G),typeof be!="function")throw Error(s(150));return G=be.call(G),Se(j,U,G,ee)}if(typeof G.then=="function")return $e(j,U,Co(G),ee);if(G.$$typeof===q)return $e(j,U,No(j,G),ee);_o(j,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,U!==null&&U.tag===6?(o(j,U.sibling),ee=g(U,G),ee.return=j,j=ee):(o(j,U),ee=Nl(G,j.mode,ee),ee.return=j,j=ee),N(j)):o(j,U)}return function(j,U,G,ee){try{hs=0;var be=$e(j,U,G,ee);return vi=null,be}catch(xe){if(xe===xi||xe===Eo)throw xe;var Be=zt(29,xe,null,j.mode);return Be.lanes=ee,Be.return=j,Be}finally{}}}var Ga=Tf(!0),Cf=Tf(!1),oa=!1;function ql(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kl(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ra(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function la(t,a,o){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(ze&2)!==0){var g=l.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),l.pending=a,a=xo(t),cf(t,null,o),a}return yo(t,l,a,o),xo(t)}function ys(t,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var l=a.lanes;l&=t.pendingLanes,o|=l,a.lanes=o,gd(t,o)}}function Ll(t,a){var o=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,o===l)){var g=null,x=null;if(o=o.firstBaseUpdate,o!==null){do{var N={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};x===null?g=x=N:x=x.next=N,o=o.next}while(o!==null);x===null?g=x=a:x=x.next=a}else g=x=a;o={baseState:l.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:l.shared,callbacks:l.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=a:t.next=a,o.lastBaseUpdate=a}var jl=!1;function xs(){if(jl){var t=yi;if(t!==null)throw t}}function vs(t,a,o,l){jl=!1;var g=t.updateQueue;oa=!1;var x=g.firstBaseUpdate,N=g.lastBaseUpdate,E=g.shared.pending;if(E!==null){g.shared.pending=null;var M=E,H=M.next;M.next=null,N===null?x=H:N.next=H,N=M;var X=t.alternate;X!==null&&(X=X.updateQueue,E=X.lastBaseUpdate,E!==N&&(E===null?X.firstBaseUpdate=H:E.next=H,X.lastBaseUpdate=M))}if(x!==null){var ne=g.baseState;N=0,X=H=M=null,E=x;do{var O=E.lane&-536870913,J=O!==E.lane;if(J?(Ue&O)===O:(l&O)===O){O!==0&&O===gi&&(jl=!0),X!==null&&(X=X.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var ge=t,Se=E;O=a;var $e=o;switch(Se.tag){case 1:if(ge=Se.payload,typeof ge=="function"){ne=ge.call($e,ne,O);break e}ne=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=Se.payload,O=typeof ge=="function"?ge.call($e,ne,O):ge,O==null)break e;ne=b({},ne,O);break e;case 2:oa=!0}}O=E.callback,O!==null&&(t.flags|=64,J&&(t.flags|=8192),J=g.callbacks,J===null?g.callbacks=[O]:J.push(O))}else J={lane:O,tag:E.tag,payload:E.payload,callback:E.callback,next:null},X===null?(H=X=J,M=ne):X=X.next=J,N|=O;if(E=E.next,E===null){if(E=g.shared.pending,E===null)break;J=E,E=J.next,J.next=null,g.lastBaseUpdate=J,g.shared.pending=null}}while(!0);X===null&&(M=ne),g.baseState=M,g.firstBaseUpdate=H,g.lastBaseUpdate=X,x===null&&(g.shared.lanes=0),pa|=N,t.lanes=N,t.memoizedState=ne}}function _f(t,a){if(typeof t!="function")throw Error(s(191,t));t.call(a)}function Af(t,a){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)_f(o[t],a)}var bi=_(null),Ao=_(0);function If(t,a){t=Fn,$(Ao,t),$(bi,a),Fn=t|a.baseLanes}function Vl(){$(Ao,Fn),$(bi,bi.current)}function Bl(){Fn=Ao.current,L(bi),L(Ao)}var Ot=_(null),rn=null;function ca(t){var a=t.alternate;$(ot,ot.current&1),$(Ot,t),rn===null&&(a===null||bi.current!==null||a.memoizedState!==null)&&(rn=t)}function Gl(t){$(ot,ot.current),$(Ot,t),rn===null&&(rn=t)}function Df(t){t.tag===22?($(ot,ot.current),$(Ot,t),rn===null&&(rn=t)):ua()}function ua(){$(ot,ot.current),$(Ot,Ot.current)}function Ft(t){L(Ot),rn===t&&(rn=null),L(ot)}var ot=_(0);function Io(t){for(var a=t;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Jc(o)||Qc(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ln=0,Ae=null,Je=null,dt=null,Do=!1,Si=!1,Ha=!1,Mo=0,bs=0,Ni=null,wv=0;function it(){throw Error(s(321))}function Hl(t,a){if(a===null)return!1;for(var o=0;o<a.length&&o<t.length;o++)if(!Ht(t[o],a[o]))return!1;return!0}function zl(t,a,o,l,g,x){return Ln=x,Ae=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,A.H=t===null||t.memoizedState===null?pp:ic,Ha=!1,x=o(l,g),Ha=!1,Si&&(x=Rf(a,o,l,g)),Mf(t),x}function Mf(t){A.H=ws;var a=Je!==null&&Je.next!==null;if(Ln=0,dt=Je=Ae=null,Do=!1,bs=0,Ni=null,a)throw Error(s(300));t===null||ft||(t=t.dependencies,t!==null&&So(t)&&(ft=!0))}function Rf(t,a,o,l){Ae=t;var g=0;do{if(Si&&(Ni=null),bs=0,Si=!1,25<=g)throw Error(s(301));if(g+=1,dt=Je=null,t.updateQueue!=null){var x=t.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}A.H=mp,x=a(o,l)}while(Si);return x}function Ev(){var t=A.H,a=t.useState()[0];return a=typeof a.then=="function"?Ss(a):a,t=t.useState()[0],(Je!==null?Je.memoizedState:null)!==t&&(Ae.flags|=1024),a}function Ol(){var t=Mo!==0;return Mo=0,t}function Fl(t,a,o){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~o}function Yl(t){if(Do){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Do=!1}Ln=0,dt=Je=Ae=null,Si=!1,bs=Mo=0,Ni=null}function At(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Ae.memoizedState=dt=t:dt=dt.next=t,dt}function rt(){if(Je===null){var t=Ae.alternate;t=t!==null?t.memoizedState:null}else t=Je.next;var a=dt===null?Ae.memoizedState:dt.next;if(a!==null)dt=a,Je=t;else{if(t===null)throw Ae.alternate===null?Error(s(467)):Error(s(310));Je=t,t={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},dt===null?Ae.memoizedState=dt=t:dt=dt.next=t}return dt}function Ro(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ss(t){var a=bs;return bs+=1,Ni===null&&(Ni=[]),t=Nf(Ni,t,a),a=Ae,(dt===null?a.memoizedState:dt.next)===null&&(a=a.alternate,A.H=a===null||a.memoizedState===null?pp:ic),t}function Uo(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Ss(t);if(t.$$typeof===q)return St(t)}throw Error(s(438,String(t)))}function Jl(t){var a=null,o=Ae.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var l=Ae.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=Ro(),Ae.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(t),l=0;l<t;l++)o[l]=Y;return a.index++,o}function jn(t,a){return typeof a=="function"?a(t):a}function Po(t){var a=rt();return Ql(a,Je,t)}function Ql(t,a,o){var l=t.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=o;var g=t.baseQueue,x=l.pending;if(x!==null){if(g!==null){var N=g.next;g.next=x.next,x.next=N}a.baseQueue=g=x,l.pending=null}if(x=t.baseState,g===null)t.memoizedState=x;else{a=g.next;var E=N=null,M=null,H=a,X=!1;do{var ne=H.lane&-536870913;if(ne!==H.lane?(Ue&ne)===ne:(Ln&ne)===ne){var O=H.revertLane;if(O===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),ne===gi&&(X=!0);else if((Ln&O)===O){H=H.next,O===gi&&(X=!0);continue}else ne={lane:0,revertLane:H.revertLane,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},M===null?(E=M=ne,N=x):M=M.next=ne,Ae.lanes|=O,pa|=O;ne=H.action,Ha&&o(x,ne),x=H.hasEagerState?H.eagerState:o(x,ne)}else O={lane:ne,revertLane:H.revertLane,gesture:H.gesture,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},M===null?(E=M=O,N=x):M=M.next=O,Ae.lanes|=ne,pa|=ne;H=H.next}while(H!==null&&H!==a);if(M===null?N=x:M.next=E,!Ht(x,t.memoizedState)&&(ft=!0,X&&(o=yi,o!==null)))throw o;t.memoizedState=x,t.baseState=N,t.baseQueue=M,l.lastRenderedState=x}return g===null&&(l.lanes=0),[t.memoizedState,l.dispatch]}function $l(t){var a=rt(),o=a.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=t;var l=o.dispatch,g=o.pending,x=a.memoizedState;if(g!==null){o.pending=null;var N=g=g.next;do x=t(x,N.action),N=N.next;while(N!==g);Ht(x,a.memoizedState)||(ft=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),o.lastRenderedState=x}return[x,l]}function Uf(t,a,o){var l=Ae,g=rt(),x=Le;if(x){if(o===void 0)throw Error(s(407));o=o()}else o=a();var N=!Ht((Je||g).memoizedState,o);if(N&&(g.memoizedState=o,ft=!0),g=g.queue,Zl(kf.bind(null,l,g,t),[t]),g.getSnapshot!==a||N||dt!==null&&dt.memoizedState.tag&1){if(l.flags|=2048,wi(9,{destroy:void 0},qf.bind(null,l,g,o,a),null),Xe===null)throw Error(s(349));x||(Ln&127)!==0||Pf(l,a,o)}return o}function Pf(t,a,o){t.flags|=16384,t={getSnapshot:a,value:o},a=Ae.updateQueue,a===null?(a=Ro(),Ae.updateQueue=a,a.stores=[t]):(o=a.stores,o===null?a.stores=[t]:o.push(t))}function qf(t,a,o,l){a.value=o,a.getSnapshot=l,Lf(a)&&jf(t)}function kf(t,a,o){return o(function(){Lf(a)&&jf(t)})}function Lf(t){var a=t.getSnapshot;t=t.value;try{var o=a();return!Ht(t,o)}catch{return!0}}function jf(t){var a=Ua(t,2);a!==null&&jt(a,t,2)}function Kl(t){var a=At();if(typeof t=="function"){var o=t;if(t=o(),Ha){Wn(!0);try{o()}finally{Wn(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:t},a}function Vf(t,a,o,l){return t.baseState=o,Ql(t,Je,typeof l=="function"?l:jn)}function Tv(t,a,o,l,g){if(Lo(t))throw Error(s(485));if(t=a.action,t!==null){var x={payload:g,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){x.listeners.push(N)}};A.T!==null?o(!0):x.isTransition=!1,l(x),o=a.pending,o===null?(x.next=a.pending=x,Bf(a,x)):(x.next=o.next,a.pending=o.next=x)}}function Bf(t,a){var o=a.action,l=a.payload,g=t.state;if(a.isTransition){var x=A.T,N={};A.T=N;try{var E=o(g,l),M=A.S;M!==null&&M(N,E),Gf(t,a,E)}catch(H){Xl(t,a,H)}finally{x!==null&&N.types!==null&&(x.types=N.types),A.T=x}}else try{x=o(g,l),Gf(t,a,x)}catch(H){Xl(t,a,H)}}function Gf(t,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(l){Hf(t,a,l)},function(l){return Xl(t,a,l)}):Hf(t,a,o)}function Hf(t,a,o){a.status="fulfilled",a.value=o,zf(a),t.state=o,a=t.pending,a!==null&&(o=a.next,o===a?t.pending=null:(o=o.next,a.next=o,Bf(t,o)))}function Xl(t,a,o){var l=t.pending;if(t.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=o,zf(a),a=a.next;while(a!==l)}t.action=null}function zf(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function Of(t,a){return a}function Ff(t,a){if(Le){var o=Xe.formState;if(o!==null){e:{var l=Ae;if(Le){if(We){t:{for(var g=We,x=on;g.nodeType!==8;){if(!x){g=null;break t}if(g=ln(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){We=ln(g.nextSibling),l=g.data==="F!";break e}}ia(l)}l=!1}l&&(a=o[0])}}return o=At(),o.memoizedState=o.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Of,lastRenderedState:a},o.queue=l,o=up.bind(null,Ae,l),l.dispatch=o,l=Kl(!1),x=ac.bind(null,Ae,!1,l.queue),l=At(),g={state:a,dispatch:null,action:t,pending:null},l.queue=g,o=Tv.bind(null,Ae,g,x,o),g.dispatch=o,l.memoizedState=t,[a,o,!1]}function Yf(t){var a=rt();return Jf(a,Je,t)}function Jf(t,a,o){if(a=Ql(t,a,Of)[0],t=Po(jn)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var l=Ss(a)}catch(N){throw N===xi?Eo:N}else l=a;a=rt();var g=a.queue,x=g.dispatch;return o!==a.memoizedState&&(Ae.flags|=2048,wi(9,{destroy:void 0},Cv.bind(null,g,o),null)),[l,x,t]}function Cv(t,a){t.action=a}function Qf(t){var a=rt(),o=Je;if(o!==null)return Jf(a,o,t);rt(),a=a.memoizedState,o=rt();var l=o.queue.dispatch;return o.memoizedState=t,[a,l,!1]}function wi(t,a,o,l){return t={tag:t,create:o,deps:l,inst:a,next:null},a=Ae.updateQueue,a===null&&(a=Ro(),Ae.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=t.next=t:(l=o.next,o.next=t,t.next=l,a.lastEffect=t),t}function $f(){return rt().memoizedState}function qo(t,a,o,l){var g=At();Ae.flags|=t,g.memoizedState=wi(1|a,{destroy:void 0},o,l===void 0?null:l)}function ko(t,a,o,l){var g=rt();l=l===void 0?null:l;var x=g.memoizedState.inst;Je!==null&&l!==null&&Hl(l,Je.memoizedState.deps)?g.memoizedState=wi(a,x,o,l):(Ae.flags|=t,g.memoizedState=wi(1|a,x,o,l))}function Kf(t,a){qo(8390656,8,t,a)}function Zl(t,a){ko(2048,8,t,a)}function _v(t){Ae.flags|=4;var a=Ae.updateQueue;if(a===null)a=Ro(),Ae.updateQueue=a,a.events=[t];else{var o=a.events;o===null?a.events=[t]:o.push(t)}}function Xf(t){var a=rt().memoizedState;return _v({ref:a,nextImpl:t}),function(){if((ze&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}function Zf(t,a){return ko(4,2,t,a)}function Wf(t,a){return ko(4,4,t,a)}function ep(t,a){if(typeof a=="function"){t=t();var o=a(t);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function tp(t,a,o){o=o!=null?o.concat([t]):null,ko(4,4,ep.bind(null,a,t),o)}function Wl(){}function np(t,a){var o=rt();a=a===void 0?null:a;var l=o.memoizedState;return a!==null&&Hl(a,l[1])?l[0]:(o.memoizedState=[t,a],t)}function ap(t,a){var o=rt();a=a===void 0?null:a;var l=o.memoizedState;if(a!==null&&Hl(a,l[1]))return l[0];if(l=t(),Ha){Wn(!0);try{t()}finally{Wn(!1)}}return o.memoizedState=[l,a],l}function ec(t,a,o){return o===void 0||(Ln&1073741824)!==0&&(Ue&261930)===0?t.memoizedState=a:(t.memoizedState=o,t=im(),Ae.lanes|=t,pa|=t,o)}function ip(t,a,o,l){return Ht(o,a)?o:bi.current!==null?(t=ec(t,o,l),Ht(t,a)||(ft=!0),t):(Ln&42)===0||(Ln&1073741824)!==0&&(Ue&261930)===0?(ft=!0,t.memoizedState=o):(t=im(),Ae.lanes|=t,pa|=t,a)}function sp(t,a,o,l,g){var x=B.p;B.p=x!==0&&8>x?x:8;var N=A.T,E={};A.T=E,ac(t,!1,a,o);try{var M=g(),H=A.S;if(H!==null&&H(E,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var X=Nv(M,l);Ns(t,a,X,Qt(t))}else Ns(t,a,l,Qt(t))}catch(ne){Ns(t,a,{then:function(){},status:"rejected",reason:ne},Qt())}finally{B.p=x,N!==null&&E.types!==null&&(N.types=E.types),A.T=N}}function Av(){}function tc(t,a,o,l){if(t.tag!==5)throw Error(s(476));var g=op(t).queue;sp(t,g,a,Z,o===null?Av:function(){return rp(t),o(l)})}function op(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:Z},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jn,lastRenderedState:o},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function rp(t){var a=op(t);a.next===null&&(a=t.alternate.memoizedState),Ns(t,a.next.queue,{},Qt())}function nc(){return St(Vs)}function lp(){return rt().memoizedState}function cp(){return rt().memoizedState}function Iv(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var o=Qt();t=ra(o);var l=la(a,t,o);l!==null&&(jt(l,a,o),ys(l,a,o)),a={cache:Ml()},t.payload=a;return}a=a.return}}function Dv(t,a,o){var l=Qt();o={lane:l,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Lo(t)?dp(a,o):(o=bl(t,a,o,l),o!==null&&(jt(o,t,l),fp(o,a,l)))}function up(t,a,o){var l=Qt();Ns(t,a,o,l)}function Ns(t,a,o,l){var g={lane:l,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Lo(t))dp(a,g);else{var x=t.alternate;if(t.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var N=a.lastRenderedState,E=x(N,o);if(g.hasEagerState=!0,g.eagerState=E,Ht(E,N))return yo(t,a,g,0),Xe===null&&go(),!1}catch{}finally{}if(o=bl(t,a,g,l),o!==null)return jt(o,t,l),fp(o,a,l),!0}return!1}function ac(t,a,o,l){if(l={lane:2,revertLane:qc(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Lo(t)){if(a)throw Error(s(479))}else a=bl(t,o,l,2),a!==null&&jt(a,t,2)}function Lo(t){var a=t.alternate;return t===Ae||a!==null&&a===Ae}function dp(t,a){Si=Do=!0;var o=t.pending;o===null?a.next=a:(a.next=o.next,o.next=a),t.pending=a}function fp(t,a,o){if((o&4194048)!==0){var l=a.lanes;l&=t.pendingLanes,o|=l,a.lanes=o,gd(t,o)}}var ws={readContext:St,use:Uo,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useLayoutEffect:it,useInsertionEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useSyncExternalStore:it,useId:it,useHostTransitionStatus:it,useFormState:it,useActionState:it,useOptimistic:it,useMemoCache:it,useCacheRefresh:it};ws.useEffectEvent=it;var pp={readContext:St,use:Uo,useCallback:function(t,a){return At().memoizedState=[t,a===void 0?null:a],t},useContext:St,useEffect:Kf,useImperativeHandle:function(t,a,o){o=o!=null?o.concat([t]):null,qo(4194308,4,ep.bind(null,a,t),o)},useLayoutEffect:function(t,a){return qo(4194308,4,t,a)},useInsertionEffect:function(t,a){qo(4,2,t,a)},useMemo:function(t,a){var o=At();a=a===void 0?null:a;var l=t();if(Ha){Wn(!0);try{t()}finally{Wn(!1)}}return o.memoizedState=[l,a],l},useReducer:function(t,a,o){var l=At();if(o!==void 0){var g=o(a);if(Ha){Wn(!0);try{o(a)}finally{Wn(!1)}}}else g=a;return l.memoizedState=l.baseState=g,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:g},l.queue=t,t=t.dispatch=Dv.bind(null,Ae,t),[l.memoizedState,t]},useRef:function(t){var a=At();return t={current:t},a.memoizedState=t},useState:function(t){t=Kl(t);var a=t.queue,o=up.bind(null,Ae,a);return a.dispatch=o,[t.memoizedState,o]},useDebugValue:Wl,useDeferredValue:function(t,a){var o=At();return ec(o,t,a)},useTransition:function(){var t=Kl(!1);return t=sp.bind(null,Ae,t.queue,!0,!1),At().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,o){var l=Ae,g=At();if(Le){if(o===void 0)throw Error(s(407));o=o()}else{if(o=a(),Xe===null)throw Error(s(349));(Ue&127)!==0||Pf(l,a,o)}g.memoizedState=o;var x={value:o,getSnapshot:a};return g.queue=x,Kf(kf.bind(null,l,x,t),[t]),l.flags|=2048,wi(9,{destroy:void 0},qf.bind(null,l,x,o,a),null),o},useId:function(){var t=At(),a=Xe.identifierPrefix;if(Le){var o=wn,l=Nn;o=(l&~(1<<32-Gt(l)-1)).toString(32)+o,a="_"+a+"R_"+o,o=Mo++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=wv++,a="_"+a+"r_"+o.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:nc,useFormState:Ff,useActionState:Ff,useOptimistic:function(t){var a=At();a.memoizedState=a.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=ac.bind(null,Ae,!0,o),o.dispatch=a,[t,a]},useMemoCache:Jl,useCacheRefresh:function(){return At().memoizedState=Iv.bind(null,Ae)},useEffectEvent:function(t){var a=At(),o={impl:t};return a.memoizedState=o,function(){if((ze&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}},ic={readContext:St,use:Uo,useCallback:np,useContext:St,useEffect:Zl,useImperativeHandle:tp,useInsertionEffect:Zf,useLayoutEffect:Wf,useMemo:ap,useReducer:Po,useRef:$f,useState:function(){return Po(jn)},useDebugValue:Wl,useDeferredValue:function(t,a){var o=rt();return ip(o,Je.memoizedState,t,a)},useTransition:function(){var t=Po(jn)[0],a=rt().memoizedState;return[typeof t=="boolean"?t:Ss(t),a]},useSyncExternalStore:Uf,useId:lp,useHostTransitionStatus:nc,useFormState:Yf,useActionState:Yf,useOptimistic:function(t,a){var o=rt();return Vf(o,Je,t,a)},useMemoCache:Jl,useCacheRefresh:cp};ic.useEffectEvent=Xf;var mp={readContext:St,use:Uo,useCallback:np,useContext:St,useEffect:Zl,useImperativeHandle:tp,useInsertionEffect:Zf,useLayoutEffect:Wf,useMemo:ap,useReducer:$l,useRef:$f,useState:function(){return $l(jn)},useDebugValue:Wl,useDeferredValue:function(t,a){var o=rt();return Je===null?ec(o,t,a):ip(o,Je.memoizedState,t,a)},useTransition:function(){var t=$l(jn)[0],a=rt().memoizedState;return[typeof t=="boolean"?t:Ss(t),a]},useSyncExternalStore:Uf,useId:lp,useHostTransitionStatus:nc,useFormState:Qf,useActionState:Qf,useOptimistic:function(t,a){var o=rt();return Je!==null?Vf(o,Je,t,a):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:Jl,useCacheRefresh:cp};mp.useEffectEvent=Xf;function sc(t,a,o,l){a=t.memoizedState,o=o(l,a),o=o==null?a:b({},a,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var oc={enqueueSetState:function(t,a,o){t=t._reactInternals;var l=Qt(),g=ra(l);g.payload=a,o!=null&&(g.callback=o),a=la(t,g,l),a!==null&&(jt(a,t,l),ys(a,t,l))},enqueueReplaceState:function(t,a,o){t=t._reactInternals;var l=Qt(),g=ra(l);g.tag=1,g.payload=a,o!=null&&(g.callback=o),a=la(t,g,l),a!==null&&(jt(a,t,l),ys(a,t,l))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var o=Qt(),l=ra(o);l.tag=2,a!=null&&(l.callback=a),a=la(t,l,o),a!==null&&(jt(a,t,o),ys(a,t,o))}};function hp(t,a,o,l,g,x,N){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,x,N):a.prototype&&a.prototype.isPureReactComponent?!cs(o,l)||!cs(g,x):!0}function gp(t,a,o,l){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,l),a.state!==t&&oc.enqueueReplaceState(a,a.state,null)}function za(t,a){var o=a;if("ref"in a){o={};for(var l in a)l!=="ref"&&(o[l]=a[l])}if(t=t.defaultProps){o===a&&(o=b({},o));for(var g in t)o[g]===void 0&&(o[g]=t[g])}return o}function yp(t){ho(t)}function xp(t){console.error(t)}function vp(t){ho(t)}function jo(t,a){try{var o=t.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function bp(t,a,o){try{var l=t.onCaughtError;l(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function rc(t,a,o){return o=ra(o),o.tag=3,o.payload={element:null},o.callback=function(){jo(t,a)},o}function Sp(t){return t=ra(t),t.tag=3,t}function Np(t,a,o,l){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var x=l.value;t.payload=function(){return g(x)},t.callback=function(){bp(a,o,l)}}var N=o.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(t.callback=function(){bp(a,o,l),typeof g!="function"&&(ma===null?ma=new Set([this]):ma.add(this));var E=l.stack;this.componentDidCatch(l.value,{componentStack:E!==null?E:""})})}function Mv(t,a,o,l,g){if(o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=o.alternate,a!==null&&hi(a,o,g,!0),o=Ot.current,o!==null){switch(o.tag){case 31:case 13:return rn===null?Ko():o.alternate===null&&st===0&&(st=3),o.flags&=-257,o.flags|=65536,o.lanes=g,l===To?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([l]):a.add(l),Rc(t,l,g)),!1;case 22:return o.flags|=65536,l===To?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([l]):o.add(l)),Rc(t,l,g)),!1}throw Error(s(435,o.tag))}return Rc(t,l,g),Ko(),!1}if(Le)return a=Ot.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,l!==Cl&&(t=Error(s(422),{cause:l}),fs(nn(t,o)))):(l!==Cl&&(a=Error(s(423),{cause:l}),fs(nn(a,o))),t=t.current.alternate,t.flags|=65536,g&=-g,t.lanes|=g,l=nn(l,o),g=rc(t.stateNode,l,g),Ll(t,g),st!==4&&(st=2)),!1;var x=Error(s(520),{cause:l});if(x=nn(x,o),Ms===null?Ms=[x]:Ms.push(x),st!==4&&(st=2),a===null)return!0;l=nn(l,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,t=g&-g,o.lanes|=t,t=rc(o.stateNode,l,t),Ll(o,t),!1;case 1:if(a=o.type,x=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ma===null||!ma.has(x))))return o.flags|=65536,g&=-g,o.lanes|=g,g=Sp(g),Np(g,t,o,l),Ll(o,g),!1}o=o.return}while(o!==null);return!1}var lc=Error(s(461)),ft=!1;function Nt(t,a,o,l){a.child=t===null?Cf(a,null,o,l):Ga(a,t.child,o,l)}function wp(t,a,o,l,g){o=o.render;var x=a.ref;if("ref"in l){var N={};for(var E in l)E!=="ref"&&(N[E]=l[E])}else N=l;return La(a),l=zl(t,a,o,N,x,g),E=Ol(),t!==null&&!ft?(Fl(t,a,g),Vn(t,a,g)):(Le&&E&&El(a),a.flags|=1,Nt(t,a,l,g),a.child)}function Ep(t,a,o,l,g){if(t===null){var x=o.type;return typeof x=="function"&&!Sl(x)&&x.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=x,Tp(t,a,x,l,g)):(t=vo(o.type,null,l,a,a.mode,g),t.ref=a.ref,t.return=a,a.child=t)}if(x=t.child,!gc(t,g)){var N=x.memoizedProps;if(o=o.compare,o=o!==null?o:cs,o(N,l)&&t.ref===a.ref)return Vn(t,a,g)}return a.flags|=1,t=Un(x,l),t.ref=a.ref,t.return=a,a.child=t}function Tp(t,a,o,l,g){if(t!==null){var x=t.memoizedProps;if(cs(x,l)&&t.ref===a.ref)if(ft=!1,a.pendingProps=l=x,gc(t,g))(t.flags&131072)!==0&&(ft=!0);else return a.lanes=t.lanes,Vn(t,a,g)}return cc(t,a,o,l,g)}function Cp(t,a,o,l){var g=l.children,x=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((a.flags&128)!==0){if(x=x!==null?x.baseLanes|o:o,t!==null){for(l=a.child=t.child,g=0;l!==null;)g=g|l.lanes|l.childLanes,l=l.sibling;l=g&~x}else l=0,a.child=null;return _p(t,a,x,o,l)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&wo(a,x!==null?x.cachePool:null),x!==null?If(a,x):Vl(),Df(a);else return l=a.lanes=536870912,_p(t,a,x!==null?x.baseLanes|o:o,o,l)}else x!==null?(wo(a,x.cachePool),If(a,x),ua(),a.memoizedState=null):(t!==null&&wo(a,null),Vl(),ua());return Nt(t,a,g,o),a.child}function Es(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function _p(t,a,o,l,g){var x=Ul();return x=x===null?null:{parent:ut._currentValue,pool:x},a.memoizedState={baseLanes:o,cachePool:x},t!==null&&wo(a,null),Vl(),Df(a),t!==null&&hi(t,a,l,!0),a.childLanes=g,null}function Vo(t,a){return a=Go({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function Ap(t,a,o){return Ga(a,t.child,null,o),t=Vo(a,a.pendingProps),t.flags|=2,Ft(a),a.memoizedState=null,t}function Rv(t,a,o){var l=a.pendingProps,g=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(Le){if(l.mode==="hidden")return t=Vo(a,l),a.lanes=536870912,Es(null,t);if(Gl(a),(t=We)?(t=Bm(t,on),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:na!==null?{id:Nn,overflow:wn}:null,retryLane:536870912,hydrationErrors:null},o=df(t),o.return=a,a.child=o,bt=a,We=null)):t=null,t===null)throw ia(a);return a.lanes=536870912,null}return Vo(a,l)}var x=t.memoizedState;if(x!==null){var N=x.dehydrated;if(Gl(a),g)if(a.flags&256)a.flags&=-257,a=Ap(t,a,o);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(s(558));else if(ft||hi(t,a,o,!1),g=(o&t.childLanes)!==0,ft||g){if(l=Xe,l!==null&&(N=yd(l,o),N!==0&&N!==x.retryLane))throw x.retryLane=N,Ua(t,N),jt(l,t,N),lc;Ko(),a=Ap(t,a,o)}else t=x.treeContext,We=ln(N.nextSibling),bt=a,Le=!0,aa=null,on=!1,t!==null&&mf(a,t),a=Vo(a,l),a.flags|=4096;return a}return t=Un(t.child,{mode:l.mode,children:l.children}),t.ref=a.ref,a.child=t,t.return=a,t}function Bo(t,a){var o=a.ref;if(o===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(t===null||t.ref!==o)&&(a.flags|=4194816)}}function cc(t,a,o,l,g){return La(a),o=zl(t,a,o,l,void 0,g),l=Ol(),t!==null&&!ft?(Fl(t,a,g),Vn(t,a,g)):(Le&&l&&El(a),a.flags|=1,Nt(t,a,o,g),a.child)}function Ip(t,a,o,l,g,x){return La(a),a.updateQueue=null,o=Rf(a,l,o,g),Mf(t),l=Ol(),t!==null&&!ft?(Fl(t,a,x),Vn(t,a,x)):(Le&&l&&El(a),a.flags|=1,Nt(t,a,o,x),a.child)}function Dp(t,a,o,l,g){if(La(a),a.stateNode===null){var x=di,N=o.contextType;typeof N=="object"&&N!==null&&(x=St(N)),x=new o(l,x),a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=oc,a.stateNode=x,x._reactInternals=a,x=a.stateNode,x.props=l,x.state=a.memoizedState,x.refs={},ql(a),N=o.contextType,x.context=typeof N=="object"&&N!==null?St(N):di,x.state=a.memoizedState,N=o.getDerivedStateFromProps,typeof N=="function"&&(sc(a,o,N,l),x.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(N=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),N!==x.state&&oc.enqueueReplaceState(x,x.state,null),vs(a,l,x,g),xs(),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(t===null){x=a.stateNode;var E=a.memoizedProps,M=za(o,E);x.props=M;var H=x.context,X=o.contextType;N=di,typeof X=="object"&&X!==null&&(N=St(X));var ne=o.getDerivedStateFromProps;X=typeof ne=="function"||typeof x.getSnapshotBeforeUpdate=="function",E=a.pendingProps!==E,X||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E||H!==N)&&gp(a,x,l,N),oa=!1;var O=a.memoizedState;x.state=O,vs(a,l,x,g),xs(),H=a.memoizedState,E||O!==H||oa?(typeof ne=="function"&&(sc(a,o,ne,l),H=a.memoizedState),(M=oa||hp(a,o,M,l,O,H,N))?(X||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(a.flags|=4194308)):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=H),x.props=l,x.state=H,x.context=N,l=M):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{x=a.stateNode,kl(t,a),N=a.memoizedProps,X=za(o,N),x.props=X,ne=a.pendingProps,O=x.context,H=o.contextType,M=di,typeof H=="object"&&H!==null&&(M=St(H)),E=o.getDerivedStateFromProps,(H=typeof E=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N!==ne||O!==M)&&gp(a,x,l,M),oa=!1,O=a.memoizedState,x.state=O,vs(a,l,x,g),xs();var J=a.memoizedState;N!==ne||O!==J||oa||t!==null&&t.dependencies!==null&&So(t.dependencies)?(typeof E=="function"&&(sc(a,o,E,l),J=a.memoizedState),(X=oa||hp(a,o,X,l,O,J,M)||t!==null&&t.dependencies!==null&&So(t.dependencies))?(H||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,J,M),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,J,M)),typeof x.componentDidUpdate=="function"&&(a.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof x.componentDidUpdate!="function"||N===t.memoizedProps&&O===t.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===t.memoizedProps&&O===t.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=J),x.props=l,x.state=J,x.context=M,l=X):(typeof x.componentDidUpdate!="function"||N===t.memoizedProps&&O===t.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===t.memoizedProps&&O===t.memoizedState||(a.flags|=1024),l=!1)}return x=l,Bo(t,a),l=(a.flags&128)!==0,x||l?(x=a.stateNode,o=l&&typeof o.getDerivedStateFromError!="function"?null:x.render(),a.flags|=1,t!==null&&l?(a.child=Ga(a,t.child,null,g),a.child=Ga(a,null,o,g)):Nt(t,a,o,g),a.memoizedState=x.state,t=a.child):t=Vn(t,a,g),t}function Mp(t,a,o,l){return qa(),a.flags|=256,Nt(t,a,o,l),a.child}var uc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dc(t){return{baseLanes:t,cachePool:bf()}}function fc(t,a,o){return t=t!==null?t.childLanes&~o:0,a&&(t|=Jt),t}function Rp(t,a,o){var l=a.pendingProps,g=!1,x=(a.flags&128)!==0,N;if((N=x)||(N=t!==null&&t.memoizedState===null?!1:(ot.current&2)!==0),N&&(g=!0,a.flags&=-129),N=(a.flags&32)!==0,a.flags&=-33,t===null){if(Le){if(g?ca(a):ua(),(t=We)?(t=Bm(t,on),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:na!==null?{id:Nn,overflow:wn}:null,retryLane:536870912,hydrationErrors:null},o=df(t),o.return=a,a.child=o,bt=a,We=null)):t=null,t===null)throw ia(a);return Qc(t)?a.lanes=32:a.lanes=536870912,null}var E=l.children;return l=l.fallback,g?(ua(),g=a.mode,E=Go({mode:"hidden",children:E},g),l=Pa(l,g,o,null),E.return=a,l.return=a,E.sibling=l,a.child=E,l=a.child,l.memoizedState=dc(o),l.childLanes=fc(t,N,o),a.memoizedState=uc,Es(null,l)):(ca(a),pc(a,E))}var M=t.memoizedState;if(M!==null&&(E=M.dehydrated,E!==null)){if(x)a.flags&256?(ca(a),a.flags&=-257,a=mc(t,a,o)):a.memoizedState!==null?(ua(),a.child=t.child,a.flags|=128,a=null):(ua(),E=l.fallback,g=a.mode,l=Go({mode:"visible",children:l.children},g),E=Pa(E,g,o,null),E.flags|=2,l.return=a,E.return=a,l.sibling=E,a.child=l,Ga(a,t.child,null,o),l=a.child,l.memoizedState=dc(o),l.childLanes=fc(t,N,o),a.memoizedState=uc,a=Es(null,l));else if(ca(a),Qc(E)){if(N=E.nextSibling&&E.nextSibling.dataset,N)var H=N.dgst;N=H,l=Error(s(419)),l.stack="",l.digest=N,fs({value:l,source:null,stack:null}),a=mc(t,a,o)}else if(ft||hi(t,a,o,!1),N=(o&t.childLanes)!==0,ft||N){if(N=Xe,N!==null&&(l=yd(N,o),l!==0&&l!==M.retryLane))throw M.retryLane=l,Ua(t,l),jt(N,t,l),lc;Jc(E)||Ko(),a=mc(t,a,o)}else Jc(E)?(a.flags|=192,a.child=t.child,a=null):(t=M.treeContext,We=ln(E.nextSibling),bt=a,Le=!0,aa=null,on=!1,t!==null&&mf(a,t),a=pc(a,l.children),a.flags|=4096);return a}return g?(ua(),E=l.fallback,g=a.mode,M=t.child,H=M.sibling,l=Un(M,{mode:"hidden",children:l.children}),l.subtreeFlags=M.subtreeFlags&65011712,H!==null?E=Un(H,E):(E=Pa(E,g,o,null),E.flags|=2),E.return=a,l.return=a,l.sibling=E,a.child=l,Es(null,l),l=a.child,E=t.child.memoizedState,E===null?E=dc(o):(g=E.cachePool,g!==null?(M=ut._currentValue,g=g.parent!==M?{parent:M,pool:M}:g):g=bf(),E={baseLanes:E.baseLanes|o,cachePool:g}),l.memoizedState=E,l.childLanes=fc(t,N,o),a.memoizedState=uc,Es(t.child,l)):(ca(a),o=t.child,t=o.sibling,o=Un(o,{mode:"visible",children:l.children}),o.return=a,o.sibling=null,t!==null&&(N=a.deletions,N===null?(a.deletions=[t],a.flags|=16):N.push(t)),a.child=o,a.memoizedState=null,o)}function pc(t,a){return a=Go({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function Go(t,a){return t=zt(22,t,null,a),t.lanes=0,t}function mc(t,a,o){return Ga(a,t.child,null,o),t=pc(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Up(t,a,o){t.lanes|=a;var l=t.alternate;l!==null&&(l.lanes|=a),Il(t.return,a,o)}function hc(t,a,o,l,g,x){var N=t.memoizedState;N===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:o,tailMode:g,treeForkCount:x}:(N.isBackwards=a,N.rendering=null,N.renderingStartTime=0,N.last=l,N.tail=o,N.tailMode=g,N.treeForkCount=x)}function Pp(t,a,o){var l=a.pendingProps,g=l.revealOrder,x=l.tail;l=l.children;var N=ot.current,E=(N&2)!==0;if(E?(N=N&1|2,a.flags|=128):N&=1,$(ot,N),Nt(t,a,l,o),l=Le?ds:0,!E&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Up(t,o,a);else if(t.tag===19)Up(t,o,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(g){case"forwards":for(o=a.child,g=null;o!==null;)t=o.alternate,t!==null&&Io(t)===null&&(g=o),o=o.sibling;o=g,o===null?(g=a.child,a.child=null):(g=o.sibling,o.sibling=null),hc(a,!1,g,o,x,l);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=a.child,a.child=null;g!==null;){if(t=g.alternate,t!==null&&Io(t)===null){a.child=g;break}t=g.sibling,g.sibling=o,o=g,g=t}hc(a,!0,o,null,x,l);break;case"together":hc(a,!1,null,null,void 0,l);break;default:a.memoizedState=null}return a.child}function Vn(t,a,o){if(t!==null&&(a.dependencies=t.dependencies),pa|=a.lanes,(o&a.childLanes)===0)if(t!==null){if(hi(t,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(s(153));if(a.child!==null){for(t=a.child,o=Un(t,t.pendingProps),a.child=o,o.return=a;t.sibling!==null;)t=t.sibling,o=o.sibling=Un(t,t.pendingProps),o.return=a;o.sibling=null}return a.child}function gc(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&So(t)))}function Uv(t,a,o){switch(a.tag){case 3:Q(a,a.stateNode.containerInfo),sa(a,ut,t.memoizedState.cache),qa();break;case 27:case 5:ce(a);break;case 4:Q(a,a.stateNode.containerInfo);break;case 10:sa(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Gl(a),null;break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(ca(a),a.flags|=128,null):(o&a.child.childLanes)!==0?Rp(t,a,o):(ca(a),t=Vn(t,a,o),t!==null?t.sibling:null);ca(a);break;case 19:var g=(t.flags&128)!==0;if(l=(o&a.childLanes)!==0,l||(hi(t,a,o,!1),l=(o&a.childLanes)!==0),g){if(l)return Pp(t,a,o);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),$(ot,ot.current),l)break;return null;case 22:return a.lanes=0,Cp(t,a,o,a.pendingProps);case 24:sa(a,ut,t.memoizedState.cache)}return Vn(t,a,o)}function qp(t,a,o){if(t!==null)if(t.memoizedProps!==a.pendingProps)ft=!0;else{if(!gc(t,o)&&(a.flags&128)===0)return ft=!1,Uv(t,a,o);ft=(t.flags&131072)!==0}else ft=!1,Le&&(a.flags&1048576)!==0&&pf(a,ds,a.index);switch(a.lanes=0,a.tag){case 16:e:{var l=a.pendingProps;if(t=Va(a.elementType),a.type=t,typeof t=="function")Sl(t)?(l=za(t,l),a.tag=1,a=Dp(null,a,t,l,o)):(a.tag=0,a=cc(null,a,t,l,o));else{if(t!=null){var g=t.$$typeof;if(g===D){a.tag=11,a=wp(null,a,t,l,o);break e}else if(g===F){a.tag=14,a=Ep(null,a,t,l,o);break e}}throw a=we(t)||t,Error(s(306,a,""))}}return a;case 0:return cc(t,a,a.type,a.pendingProps,o);case 1:return l=a.type,g=za(l,a.pendingProps),Dp(t,a,l,g,o);case 3:e:{if(Q(a,a.stateNode.containerInfo),t===null)throw Error(s(387));l=a.pendingProps;var x=a.memoizedState;g=x.element,kl(t,a),vs(a,l,null,o);var N=a.memoizedState;if(l=N.cache,sa(a,ut,l),l!==x.cache&&Dl(a,[ut],o,!0),xs(),l=N.element,x.isDehydrated)if(x={element:l,isDehydrated:!1,cache:N.cache},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){a=Mp(t,a,l,o);break e}else if(l!==g){g=nn(Error(s(424)),a),fs(g),a=Mp(t,a,l,o);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(We=ln(t.firstChild),bt=a,Le=!0,aa=null,on=!0,o=Cf(a,null,l,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(qa(),l===g){a=Vn(t,a,o);break e}Nt(t,a,l,o)}a=a.child}return a;case 26:return Bo(t,a),t===null?(o=Ym(a.type,null,a.pendingProps,null))?a.memoizedState=o:Le||(o=a.type,t=a.pendingProps,l=ar(ye.current).createElement(o),l[vt]=a,l[Rt]=t,wt(l,o,t),gt(l),a.stateNode=l):a.memoizedState=Ym(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return ce(a),t===null&&Le&&(l=a.stateNode=zm(a.type,a.pendingProps,ye.current),bt=a,on=!0,g=We,xa(a.type)?($c=g,We=ln(l.firstChild)):We=g),Nt(t,a,a.pendingProps.children,o),Bo(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&Le&&((g=l=We)&&(l=cb(l,a.type,a.pendingProps,on),l!==null?(a.stateNode=l,bt=a,We=ln(l.firstChild),on=!1,g=!0):g=!1),g||ia(a)),ce(a),g=a.type,x=a.pendingProps,N=t!==null?t.memoizedProps:null,l=x.children,Oc(g,x)?l=null:N!==null&&Oc(g,N)&&(a.flags|=32),a.memoizedState!==null&&(g=zl(t,a,Ev,null,null,o),Vs._currentValue=g),Bo(t,a),Nt(t,a,l,o),a.child;case 6:return t===null&&Le&&((t=o=We)&&(o=ub(o,a.pendingProps,on),o!==null?(a.stateNode=o,bt=a,We=null,t=!0):t=!1),t||ia(a)),null;case 13:return Rp(t,a,o);case 4:return Q(a,a.stateNode.containerInfo),l=a.pendingProps,t===null?a.child=Ga(a,null,l,o):Nt(t,a,l,o),a.child;case 11:return wp(t,a,a.type,a.pendingProps,o);case 7:return Nt(t,a,a.pendingProps,o),a.child;case 8:return Nt(t,a,a.pendingProps.children,o),a.child;case 12:return Nt(t,a,a.pendingProps.children,o),a.child;case 10:return l=a.pendingProps,sa(a,a.type,l.value),Nt(t,a,l.children,o),a.child;case 9:return g=a.type._context,l=a.pendingProps.children,La(a),g=St(g),l=l(g),a.flags|=1,Nt(t,a,l,o),a.child;case 14:return Ep(t,a,a.type,a.pendingProps,o);case 15:return Tp(t,a,a.type,a.pendingProps,o);case 19:return Pp(t,a,o);case 31:return Rv(t,a,o);case 22:return Cp(t,a,o,a.pendingProps);case 24:return La(a),l=St(ut),t===null?(g=Ul(),g===null&&(g=Xe,x=Ml(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=o),g=x),a.memoizedState={parent:l,cache:g},ql(a),sa(a,ut,g)):((t.lanes&o)!==0&&(kl(t,a),vs(a,null,null,o),xs()),g=t.memoizedState,x=a.memoizedState,g.parent!==l?(g={parent:l,cache:l},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),sa(a,ut,l)):(l=x.cache,sa(a,ut,l),l!==g.cache&&Dl(a,[ut],o,!0))),Nt(t,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function Bn(t){t.flags|=4}function yc(t,a,o,l,g){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(g&335544128)===g)if(t.stateNode.complete)t.flags|=8192;else if(lm())t.flags|=8192;else throw Ba=To,Pl}else t.flags&=-16777217}function kp(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Xm(a))if(lm())t.flags|=8192;else throw Ba=To,Pl}function Ho(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?md():536870912,t.lanes|=a,_i|=a)}function Ts(t,a){if(!Le)switch(t.tailMode){case"hidden":a=t.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function et(t){var a=t.alternate!==null&&t.alternate.child===t.child,o=0,l=0;if(a)for(var g=t.child;g!==null;)o|=g.lanes|g.childLanes,l|=g.subtreeFlags&65011712,l|=g.flags&65011712,g.return=t,g=g.sibling;else for(g=t.child;g!==null;)o|=g.lanes|g.childLanes,l|=g.subtreeFlags,l|=g.flags,g.return=t,g=g.sibling;return t.subtreeFlags|=l,t.childLanes=o,a}function Pv(t,a,o){var l=a.pendingProps;switch(Tl(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return et(a),null;case 1:return et(a),null;case 3:return o=a.stateNode,l=null,t!==null&&(l=t.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),kn(ut),W(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(mi(a)?Bn(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,_l())),et(a),null;case 26:var g=a.type,x=a.memoizedState;return t===null?(Bn(a),x!==null?(et(a),kp(a,x)):(et(a),yc(a,g,null,l,o))):x?x!==t.memoizedState?(Bn(a),et(a),kp(a,x)):(et(a),a.flags&=-16777217):(t=t.memoizedProps,t!==l&&Bn(a),et(a),yc(a,g,t,l,o)),null;case 27:if(je(a),o=ye.current,g=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&Bn(a);else{if(!l){if(a.stateNode===null)throw Error(s(166));return et(a),null}t=se.current,mi(a)?hf(a):(t=zm(g,l,o),a.stateNode=t,Bn(a))}return et(a),null;case 5:if(je(a),g=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&Bn(a);else{if(!l){if(a.stateNode===null)throw Error(s(166));return et(a),null}if(x=se.current,mi(a))hf(a);else{var N=ar(ye.current);switch(x){case 1:x=N.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:x=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":x=N.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":x=N.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":x=N.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof l.is=="string"?N.createElement("select",{is:l.is}):N.createElement("select"),l.multiple?x.multiple=!0:l.size&&(x.size=l.size);break;default:x=typeof l.is=="string"?N.createElement(g,{is:l.is}):N.createElement(g)}}x[vt]=a,x[Rt]=l;e:for(N=a.child;N!==null;){if(N.tag===5||N.tag===6)x.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===a)break e;for(;N.sibling===null;){if(N.return===null||N.return===a)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}a.stateNode=x;e:switch(wt(x,g,l),g){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&Bn(a)}}return et(a),yc(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,o),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==l&&Bn(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(s(166));if(t=ye.current,mi(a)){if(t=a.stateNode,o=a.memoizedProps,l=null,g=bt,g!==null)switch(g.tag){case 27:case 5:l=g.memoizedProps}t[vt]=a,t=!!(t.nodeValue===o||l!==null&&l.suppressHydrationWarning===!0||Rm(t.nodeValue,o)),t||ia(a,!0)}else t=ar(t).createTextNode(l),t[vt]=a,a.stateNode=t}return et(a),null;case 31:if(o=a.memoizedState,t===null||t.memoizedState!==null){if(l=mi(a),o!==null){if(t===null){if(!l)throw Error(s(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[vt]=a}else qa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;et(a),t=!1}else o=_l(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return a.flags&256?(Ft(a),a):(Ft(a),null);if((a.flags&128)!==0)throw Error(s(558))}return et(a),null;case 13:if(l=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(g=mi(a),l!==null&&l.dehydrated!==null){if(t===null){if(!g)throw Error(s(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[vt]=a}else qa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;et(a),g=!1}else g=_l(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(Ft(a),a):(Ft(a),null)}return Ft(a),(a.flags&128)!==0?(a.lanes=o,a):(o=l!==null,t=t!==null&&t.memoizedState!==null,o&&(l=a.child,g=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(g=l.alternate.memoizedState.cachePool.pool),x=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(x=l.memoizedState.cachePool.pool),x!==g&&(l.flags|=2048)),o!==t&&o&&(a.child.flags|=8192),Ho(a,a.updateQueue),et(a),null);case 4:return W(),t===null&&Vc(a.stateNode.containerInfo),et(a),null;case 10:return kn(a.type),et(a),null;case 19:if(L(ot),l=a.memoizedState,l===null)return et(a),null;if(g=(a.flags&128)!==0,x=l.rendering,x===null)if(g)Ts(l,!1);else{if(st!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(x=Io(t),x!==null){for(a.flags|=128,Ts(l,!1),t=x.updateQueue,a.updateQueue=t,Ho(a,t),a.subtreeFlags=0,t=o,o=a.child;o!==null;)uf(o,t),o=o.sibling;return $(ot,ot.current&1|2),Le&&Pn(a,l.treeForkCount),a.child}t=t.sibling}l.tail!==null&&le()>Jo&&(a.flags|=128,g=!0,Ts(l,!1),a.lanes=4194304)}else{if(!g)if(t=Io(x),t!==null){if(a.flags|=128,g=!0,t=t.updateQueue,a.updateQueue=t,Ho(a,t),Ts(l,!0),l.tail===null&&l.tailMode==="hidden"&&!x.alternate&&!Le)return et(a),null}else 2*le()-l.renderingStartTime>Jo&&o!==536870912&&(a.flags|=128,g=!0,Ts(l,!1),a.lanes=4194304);l.isBackwards?(x.sibling=a.child,a.child=x):(t=l.last,t!==null?t.sibling=x:a.child=x,l.last=x)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=le(),t.sibling=null,o=ot.current,$(ot,g?o&1|2:o&1),Le&&Pn(a,l.treeForkCount),t):(et(a),null);case 22:case 23:return Ft(a),Bl(),l=a.memoizedState!==null,t!==null?t.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(o&536870912)!==0&&(a.flags&128)===0&&(et(a),a.subtreeFlags&6&&(a.flags|=8192)):et(a),o=a.updateQueue,o!==null&&Ho(a,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==o&&(a.flags|=2048),t!==null&&L(ja),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),kn(ut),et(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function qv(t,a){switch(Tl(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return kn(ut),W(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return je(a),null;case 31:if(a.memoizedState!==null){if(Ft(a),a.alternate===null)throw Error(s(340));qa()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(Ft(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(s(340));qa()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return L(ot),null;case 4:return W(),null;case 10:return kn(a.type),null;case 22:case 23:return Ft(a),Bl(),t!==null&&L(ja),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return kn(ut),null;case 25:return null;default:return null}}function Lp(t,a){switch(Tl(a),a.tag){case 3:kn(ut),W();break;case 26:case 27:case 5:je(a);break;case 4:W();break;case 31:a.memoizedState!==null&&Ft(a);break;case 13:Ft(a);break;case 19:L(ot);break;case 10:kn(a.type);break;case 22:case 23:Ft(a),Bl(),t!==null&&L(ja);break;case 24:kn(ut)}}function Cs(t,a){try{var o=a.updateQueue,l=o!==null?o.lastEffect:null;if(l!==null){var g=l.next;o=g;do{if((o.tag&t)===t){l=void 0;var x=o.create,N=o.inst;l=x(),N.destroy=l}o=o.next}while(o!==g)}}catch(E){Fe(a,a.return,E)}}function da(t,a,o){try{var l=a.updateQueue,g=l!==null?l.lastEffect:null;if(g!==null){var x=g.next;l=x;do{if((l.tag&t)===t){var N=l.inst,E=N.destroy;if(E!==void 0){N.destroy=void 0,g=a;var M=o,H=E;try{H()}catch(X){Fe(g,M,X)}}}l=l.next}while(l!==x)}}catch(X){Fe(a,a.return,X)}}function jp(t){var a=t.updateQueue;if(a!==null){var o=t.stateNode;try{Af(a,o)}catch(l){Fe(t,t.return,l)}}}function Vp(t,a,o){o.props=za(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(l){Fe(t,a,l)}}function _s(t,a){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var l=t.stateNode;break;case 30:l=t.stateNode;break;default:l=t.stateNode}typeof o=="function"?t.refCleanup=o(l):o.current=l}}catch(g){Fe(t,a,g)}}function En(t,a){var o=t.ref,l=t.refCleanup;if(o!==null)if(typeof l=="function")try{l()}catch(g){Fe(t,a,g)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Fe(t,a,g)}else o.current=null}function Bp(t){var a=t.type,o=t.memoizedProps,l=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&l.focus();break e;case"img":o.src?l.src=o.src:o.srcSet&&(l.srcset=o.srcSet)}}catch(g){Fe(t,t.return,g)}}function xc(t,a,o){try{var l=t.stateNode;ab(l,t.type,o,a),l[Rt]=a}catch(g){Fe(t,t.return,g)}}function Gp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&xa(t.type)||t.tag===4}function vc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&xa(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bc(t,a,o){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(t),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Mn));else if(l!==4&&(l===27&&xa(t.type)&&(o=t.stateNode,a=null),t=t.child,t!==null))for(bc(t,a,o),t=t.sibling;t!==null;)bc(t,a,o),t=t.sibling}function zo(t,a,o){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?o.insertBefore(t,a):o.appendChild(t);else if(l!==4&&(l===27&&xa(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(zo(t,a,o),t=t.sibling;t!==null;)zo(t,a,o),t=t.sibling}function Hp(t){var a=t.stateNode,o=t.memoizedProps;try{for(var l=t.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);wt(a,l,o),a[vt]=t,a[Rt]=o}catch(x){Fe(t,t.return,x)}}var Gn=!1,pt=!1,Sc=!1,zp=typeof WeakSet=="function"?WeakSet:Set,yt=null;function kv(t,a){if(t=t.containerInfo,Hc=ur,t=ef(t),ml(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var l=o.getSelection&&o.getSelection();if(l&&l.rangeCount!==0){o=l.anchorNode;var g=l.anchorOffset,x=l.focusNode;l=l.focusOffset;try{o.nodeType,x.nodeType}catch{o=null;break e}var N=0,E=-1,M=-1,H=0,X=0,ne=t,O=null;t:for(;;){for(var J;ne!==o||g!==0&&ne.nodeType!==3||(E=N+g),ne!==x||l!==0&&ne.nodeType!==3||(M=N+l),ne.nodeType===3&&(N+=ne.nodeValue.length),(J=ne.firstChild)!==null;)O=ne,ne=J;for(;;){if(ne===t)break t;if(O===o&&++H===g&&(E=N),O===x&&++X===l&&(M=N),(J=ne.nextSibling)!==null)break;ne=O,O=ne.parentNode}ne=J}o=E===-1||M===-1?null:{start:E,end:M}}else o=null}o=o||{start:0,end:0}}else o=null;for(zc={focusedElem:t,selectionRange:o},ur=!1,yt=a;yt!==null;)if(a=yt,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,yt=t;else for(;yt!==null;){switch(a=yt,x=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)g=t[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&x!==null){t=void 0,o=a,g=x.memoizedProps,x=x.memoizedState,l=o.stateNode;try{var ge=za(o.type,g);t=l.getSnapshotBeforeUpdate(ge,x),l.__reactInternalSnapshotBeforeUpdate=t}catch(Se){Fe(o,o.return,Se)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,o=t.nodeType,o===9)Yc(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Yc(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=a.sibling,t!==null){t.return=a.return,yt=t;break}yt=a.return}}function Op(t,a,o){var l=o.flags;switch(o.tag){case 0:case 11:case 15:zn(t,o),l&4&&Cs(5,o);break;case 1:if(zn(t,o),l&4)if(t=o.stateNode,a===null)try{t.componentDidMount()}catch(N){Fe(o,o.return,N)}else{var g=za(o.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(g,a,t.__reactInternalSnapshotBeforeUpdate)}catch(N){Fe(o,o.return,N)}}l&64&&jp(o),l&512&&_s(o,o.return);break;case 3:if(zn(t,o),l&64&&(t=o.updateQueue,t!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Af(t,a)}catch(N){Fe(o,o.return,N)}}break;case 27:a===null&&l&4&&Hp(o);case 26:case 5:zn(t,o),a===null&&l&4&&Bp(o),l&512&&_s(o,o.return);break;case 12:zn(t,o);break;case 31:zn(t,o),l&4&&Jp(t,o);break;case 13:zn(t,o),l&4&&Qp(t,o),l&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=Fv.bind(null,o),db(t,o))));break;case 22:if(l=o.memoizedState!==null||Gn,!l){a=a!==null&&a.memoizedState!==null||pt,g=Gn;var x=pt;Gn=l,(pt=a)&&!x?On(t,o,(o.subtreeFlags&8772)!==0):zn(t,o),Gn=g,pt=x}break;case 30:break;default:zn(t,o)}}function Fp(t){var a=t.alternate;a!==null&&(t.alternate=null,Fp(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&Xr(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var at=null,Pt=!1;function Hn(t,a,o){for(o=o.child;o!==null;)Yp(t,a,o),o=o.sibling}function Yp(t,a,o){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(Xi,o)}catch{}switch(o.tag){case 26:pt||En(o,a),Hn(t,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:pt||En(o,a);var l=at,g=Pt;xa(o.type)&&(at=o.stateNode,Pt=!1),Hn(t,a,o),ks(o.stateNode),at=l,Pt=g;break;case 5:pt||En(o,a);case 6:if(l=at,g=Pt,at=null,Hn(t,a,o),at=l,Pt=g,at!==null)if(Pt)try{(at.nodeType===9?at.body:at.nodeName==="HTML"?at.ownerDocument.body:at).removeChild(o.stateNode)}catch(x){Fe(o,a,x)}else try{at.removeChild(o.stateNode)}catch(x){Fe(o,a,x)}break;case 18:at!==null&&(Pt?(t=at,jm(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),qi(t)):jm(at,o.stateNode));break;case 4:l=at,g=Pt,at=o.stateNode.containerInfo,Pt=!0,Hn(t,a,o),at=l,Pt=g;break;case 0:case 11:case 14:case 15:da(2,o,a),pt||da(4,o,a),Hn(t,a,o);break;case 1:pt||(En(o,a),l=o.stateNode,typeof l.componentWillUnmount=="function"&&Vp(o,a,l)),Hn(t,a,o);break;case 21:Hn(t,a,o);break;case 22:pt=(l=pt)||o.memoizedState!==null,Hn(t,a,o),pt=l;break;default:Hn(t,a,o)}}function Jp(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{qi(t)}catch(o){Fe(a,a.return,o)}}}function Qp(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{qi(t)}catch(o){Fe(a,a.return,o)}}function Lv(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new zp),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new zp),a;default:throw Error(s(435,t.tag))}}function Oo(t,a){var o=Lv(t);a.forEach(function(l){if(!o.has(l)){o.add(l);var g=Yv.bind(null,t,l);l.then(g,g)}})}function qt(t,a){var o=a.deletions;if(o!==null)for(var l=0;l<o.length;l++){var g=o[l],x=t,N=a,E=N;e:for(;E!==null;){switch(E.tag){case 27:if(xa(E.type)){at=E.stateNode,Pt=!1;break e}break;case 5:at=E.stateNode,Pt=!1;break e;case 3:case 4:at=E.stateNode.containerInfo,Pt=!0;break e}E=E.return}if(at===null)throw Error(s(160));Yp(x,N,g),at=null,Pt=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)$p(a,t),a=a.sibling}var pn=null;function $p(t,a){var o=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:qt(a,t),kt(t),l&4&&(da(3,t,t.return),Cs(3,t),da(5,t,t.return));break;case 1:qt(a,t),kt(t),l&512&&(pt||o===null||En(o,o.return)),l&64&&Gn&&(t=t.updateQueue,t!==null&&(l=t.callbacks,l!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?l:o.concat(l))));break;case 26:var g=pn;if(qt(a,t),kt(t),l&512&&(pt||o===null||En(o,o.return)),l&4){var x=o!==null?o.memoizedState:null;if(l=t.memoizedState,o===null)if(l===null)if(t.stateNode===null){e:{l=t.type,o=t.memoizedProps,g=g.ownerDocument||g;t:switch(l){case"title":x=g.getElementsByTagName("title")[0],(!x||x[es]||x[vt]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(l),g.head.insertBefore(x,g.querySelector("head > title"))),wt(x,l,o),x[vt]=t,gt(x),l=x;break e;case"link":var N=$m("link","href",g).get(l+(o.href||""));if(N){for(var E=0;E<N.length;E++)if(x=N[E],x.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&x.getAttribute("rel")===(o.rel==null?null:o.rel)&&x.getAttribute("title")===(o.title==null?null:o.title)&&x.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){N.splice(E,1);break t}}x=g.createElement(l),wt(x,l,o),g.head.appendChild(x);break;case"meta":if(N=$m("meta","content",g).get(l+(o.content||""))){for(E=0;E<N.length;E++)if(x=N[E],x.getAttribute("content")===(o.content==null?null:""+o.content)&&x.getAttribute("name")===(o.name==null?null:o.name)&&x.getAttribute("property")===(o.property==null?null:o.property)&&x.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&x.getAttribute("charset")===(o.charSet==null?null:o.charSet)){N.splice(E,1);break t}}x=g.createElement(l),wt(x,l,o),g.head.appendChild(x);break;default:throw Error(s(468,l))}x[vt]=t,gt(x),l=x}t.stateNode=l}else Km(g,t.type,t.stateNode);else t.stateNode=Qm(g,l,t.memoizedProps);else x!==l?(x===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):x.count--,l===null?Km(g,t.type,t.stateNode):Qm(g,l,t.memoizedProps)):l===null&&t.stateNode!==null&&xc(t,t.memoizedProps,o.memoizedProps)}break;case 27:qt(a,t),kt(t),l&512&&(pt||o===null||En(o,o.return)),o!==null&&l&4&&xc(t,t.memoizedProps,o.memoizedProps);break;case 5:if(qt(a,t),kt(t),l&512&&(pt||o===null||En(o,o.return)),t.flags&32){g=t.stateNode;try{ii(g,"")}catch(ge){Fe(t,t.return,ge)}}l&4&&t.stateNode!=null&&(g=t.memoizedProps,xc(t,g,o!==null?o.memoizedProps:g)),l&1024&&(Sc=!0);break;case 6:if(qt(a,t),kt(t),l&4){if(t.stateNode===null)throw Error(s(162));l=t.memoizedProps,o=t.stateNode;try{o.nodeValue=l}catch(ge){Fe(t,t.return,ge)}}break;case 3:if(or=null,g=pn,pn=ir(a.containerInfo),qt(a,t),pn=g,kt(t),l&4&&o!==null&&o.memoizedState.isDehydrated)try{qi(a.containerInfo)}catch(ge){Fe(t,t.return,ge)}Sc&&(Sc=!1,Kp(t));break;case 4:l=pn,pn=ir(t.stateNode.containerInfo),qt(a,t),kt(t),pn=l;break;case 12:qt(a,t),kt(t);break;case 31:qt(a,t),kt(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Oo(t,l)));break;case 13:qt(a,t),kt(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Yo=le()),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Oo(t,l)));break;case 22:g=t.memoizedState!==null;var M=o!==null&&o.memoizedState!==null,H=Gn,X=pt;if(Gn=H||g,pt=X||M,qt(a,t),pt=X,Gn=H,kt(t),l&8192)e:for(a=t.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(o===null||M||Gn||pt||Oa(t)),o=null,a=t;;){if(a.tag===5||a.tag===26){if(o===null){M=o=a;try{if(x=M.stateNode,g)N=x.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{E=M.stateNode;var ne=M.memoizedProps.style,O=ne!=null&&ne.hasOwnProperty("display")?ne.display:null;E.style.display=O==null||typeof O=="boolean"?"":(""+O).trim()}}catch(ge){Fe(M,M.return,ge)}}}else if(a.tag===6){if(o===null){M=a;try{M.stateNode.nodeValue=g?"":M.memoizedProps}catch(ge){Fe(M,M.return,ge)}}}else if(a.tag===18){if(o===null){M=a;try{var J=M.stateNode;g?Vm(J,!0):Vm(M.stateNode,!1)}catch(ge){Fe(M,M.return,ge)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=t.updateQueue,l!==null&&(o=l.retryQueue,o!==null&&(l.retryQueue=null,Oo(t,o))));break;case 19:qt(a,t),kt(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Oo(t,l)));break;case 30:break;case 21:break;default:qt(a,t),kt(t)}}function kt(t){var a=t.flags;if(a&2){try{for(var o,l=t.return;l!==null;){if(Gp(l)){o=l;break}l=l.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var g=o.stateNode,x=vc(t);zo(t,x,g);break;case 5:var N=o.stateNode;o.flags&32&&(ii(N,""),o.flags&=-33);var E=vc(t);zo(t,E,N);break;case 3:case 4:var M=o.stateNode.containerInfo,H=vc(t);bc(t,H,M);break;default:throw Error(s(161))}}catch(X){Fe(t,t.return,X)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function Kp(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;Kp(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function zn(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Op(t,a.alternate,a),a=a.sibling}function Oa(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:da(4,a,a.return),Oa(a);break;case 1:En(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Vp(a,a.return,o),Oa(a);break;case 27:ks(a.stateNode);case 26:case 5:En(a,a.return),Oa(a);break;case 22:a.memoizedState===null&&Oa(a);break;case 30:Oa(a);break;default:Oa(a)}t=t.sibling}}function On(t,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,g=t,x=a,N=x.flags;switch(x.tag){case 0:case 11:case 15:On(g,x,o),Cs(4,x);break;case 1:if(On(g,x,o),l=x,g=l.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(H){Fe(l,l.return,H)}if(l=x,g=l.updateQueue,g!==null){var E=l.stateNode;try{var M=g.shared.hiddenCallbacks;if(M!==null)for(g.shared.hiddenCallbacks=null,g=0;g<M.length;g++)_f(M[g],E)}catch(H){Fe(l,l.return,H)}}o&&N&64&&jp(x),_s(x,x.return);break;case 27:Hp(x);case 26:case 5:On(g,x,o),o&&l===null&&N&4&&Bp(x),_s(x,x.return);break;case 12:On(g,x,o);break;case 31:On(g,x,o),o&&N&4&&Jp(g,x);break;case 13:On(g,x,o),o&&N&4&&Qp(g,x);break;case 22:x.memoizedState===null&&On(g,x,o),_s(x,x.return);break;case 30:break;default:On(g,x,o)}a=a.sibling}}function Nc(t,a){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&ps(o))}function wc(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ps(t))}function mn(t,a,o,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Xp(t,a,o,l),a=a.sibling}function Xp(t,a,o,l){var g=a.flags;switch(a.tag){case 0:case 11:case 15:mn(t,a,o,l),g&2048&&Cs(9,a);break;case 1:mn(t,a,o,l);break;case 3:mn(t,a,o,l),g&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ps(t)));break;case 12:if(g&2048){mn(t,a,o,l),t=a.stateNode;try{var x=a.memoizedProps,N=x.id,E=x.onPostCommit;typeof E=="function"&&E(N,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(M){Fe(a,a.return,M)}}else mn(t,a,o,l);break;case 31:mn(t,a,o,l);break;case 13:mn(t,a,o,l);break;case 23:break;case 22:x=a.stateNode,N=a.alternate,a.memoizedState!==null?x._visibility&2?mn(t,a,o,l):As(t,a):x._visibility&2?mn(t,a,o,l):(x._visibility|=2,Ei(t,a,o,l,(a.subtreeFlags&10256)!==0||!1)),g&2048&&Nc(N,a);break;case 24:mn(t,a,o,l),g&2048&&wc(a.alternate,a);break;default:mn(t,a,o,l)}}function Ei(t,a,o,l,g){for(g=g&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var x=t,N=a,E=o,M=l,H=N.flags;switch(N.tag){case 0:case 11:case 15:Ei(x,N,E,M,g),Cs(8,N);break;case 23:break;case 22:var X=N.stateNode;N.memoizedState!==null?X._visibility&2?Ei(x,N,E,M,g):As(x,N):(X._visibility|=2,Ei(x,N,E,M,g)),g&&H&2048&&Nc(N.alternate,N);break;case 24:Ei(x,N,E,M,g),g&&H&2048&&wc(N.alternate,N);break;default:Ei(x,N,E,M,g)}a=a.sibling}}function As(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=t,l=a,g=l.flags;switch(l.tag){case 22:As(o,l),g&2048&&Nc(l.alternate,l);break;case 24:As(o,l),g&2048&&wc(l.alternate,l);break;default:As(o,l)}a=a.sibling}}var Is=8192;function Ti(t,a,o){if(t.subtreeFlags&Is)for(t=t.child;t!==null;)Zp(t,a,o),t=t.sibling}function Zp(t,a,o){switch(t.tag){case 26:Ti(t,a,o),t.flags&Is&&t.memoizedState!==null&&wb(o,pn,t.memoizedState,t.memoizedProps);break;case 5:Ti(t,a,o);break;case 3:case 4:var l=pn;pn=ir(t.stateNode.containerInfo),Ti(t,a,o),pn=l;break;case 22:t.memoizedState===null&&(l=t.alternate,l!==null&&l.memoizedState!==null?(l=Is,Is=16777216,Ti(t,a,o),Is=l):Ti(t,a,o));break;default:Ti(t,a,o)}}function Wp(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function Ds(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var l=a[o];yt=l,tm(l,t)}Wp(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)em(t),t=t.sibling}function em(t){switch(t.tag){case 0:case 11:case 15:Ds(t),t.flags&2048&&da(9,t,t.return);break;case 3:Ds(t);break;case 12:Ds(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,Fo(t)):Ds(t);break;default:Ds(t)}}function Fo(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var l=a[o];yt=l,tm(l,t)}Wp(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:da(8,a,a.return),Fo(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Fo(a));break;default:Fo(a)}t=t.sibling}}function tm(t,a){for(;yt!==null;){var o=yt;switch(o.tag){case 0:case 11:case 15:da(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var l=o.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:ps(o.memoizedState.cache)}if(l=o.child,l!==null)l.return=o,yt=l;else e:for(o=t;yt!==null;){l=yt;var g=l.sibling,x=l.return;if(Fp(l),l===o){yt=null;break e}if(g!==null){g.return=x,yt=g;break e}yt=x}}}var jv={getCacheForType:function(t){var a=St(ut),o=a.data.get(t);return o===void 0&&(o=t(),a.data.set(t,o)),o},cacheSignal:function(){return St(ut).controller.signal}},Vv=typeof WeakMap=="function"?WeakMap:Map,ze=0,Xe=null,De=null,Ue=0,Oe=0,Yt=null,fa=!1,Ci=!1,Ec=!1,Fn=0,st=0,pa=0,Fa=0,Tc=0,Jt=0,_i=0,Ms=null,Lt=null,Cc=!1,Yo=0,nm=0,Jo=1/0,Qo=null,ma=null,mt=0,ha=null,Ai=null,Yn=0,_c=0,Ac=null,am=null,Rs=0,Ic=null;function Qt(){return(ze&2)!==0&&Ue!==0?Ue&-Ue:A.T!==null?qc():xd()}function im(){if(Jt===0)if((Ue&536870912)===0||Le){var t=to;to<<=1,(to&3932160)===0&&(to=262144),Jt=t}else Jt=536870912;return t=Ot.current,t!==null&&(t.flags|=32),Jt}function jt(t,a,o){(t===Xe&&(Oe===2||Oe===9)||t.cancelPendingCommit!==null)&&(Ii(t,0),ga(t,Ue,Jt,!1)),Wi(t,o),((ze&2)===0||t!==Xe)&&(t===Xe&&((ze&2)===0&&(Fa|=o),st===4&&ga(t,Ue,Jt,!1)),Tn(t))}function sm(t,a,o){if((ze&6)!==0)throw Error(s(327));var l=!o&&(a&127)===0&&(a&t.expiredLanes)===0||Zi(t,a),g=l?Hv(t,a):Mc(t,a,!0),x=l;do{if(g===0){Ci&&!l&&ga(t,a,0,!1);break}else{if(o=t.current.alternate,x&&!Bv(o)){g=Mc(t,a,!1),x=!1;continue}if(g===2){if(x=a,t.errorRecoveryDisabledLanes&x)var N=0;else N=t.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){a=N;e:{var E=t;g=Ms;var M=E.current.memoizedState.isDehydrated;if(M&&(Ii(E,N).flags|=256),N=Mc(E,N,!1),N!==2){if(Ec&&!M){E.errorRecoveryDisabledLanes|=x,Fa|=x,g=4;break e}x=Lt,Lt=g,x!==null&&(Lt===null?Lt=x:Lt.push.apply(Lt,x))}g=N}if(x=!1,g!==2)continue}}if(g===1){Ii(t,0),ga(t,a,0,!0);break}e:{switch(l=t,x=g,x){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:ga(l,a,Jt,!fa);break e;case 2:Lt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(g=Yo+300-le(),10<g)){if(ga(l,a,Jt,!fa),ao(l,0,!0)!==0)break e;Yn=a,l.timeoutHandle=km(om.bind(null,l,o,Lt,Qo,Cc,a,Jt,Fa,_i,fa,x,"Throttled",-0,0),g);break e}om(l,o,Lt,Qo,Cc,a,Jt,Fa,_i,fa,x,null,-0,0)}}break}while(!0);Tn(t)}function om(t,a,o,l,g,x,N,E,M,H,X,ne,O,J){if(t.timeoutHandle=-1,ne=a.subtreeFlags,ne&8192||(ne&16785408)===16785408){ne={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Mn},Zp(a,x,ne);var ge=(x&62914560)===x?Yo-le():(x&4194048)===x?nm-le():0;if(ge=Eb(ne,ge),ge!==null){Yn=x,t.cancelPendingCommit=ge(mm.bind(null,t,a,x,o,l,g,N,E,M,X,ne,null,O,J)),ga(t,x,N,!H);return}}mm(t,a,x,o,l,g,N,E,M)}function Bv(t){for(var a=t;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var l=0;l<o.length;l++){var g=o[l],x=g.getSnapshot;g=g.value;try{if(!Ht(x(),g))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ga(t,a,o,l){a&=~Tc,a&=~Fa,t.suspendedLanes|=a,t.pingedLanes&=~a,l&&(t.warmLanes|=a),l=t.expirationTimes;for(var g=a;0<g;){var x=31-Gt(g),N=1<<x;l[x]=-1,g&=~N}o!==0&&hd(t,o,a)}function $o(){return(ze&6)===0?(Us(0),!1):!0}function Dc(){if(De!==null){if(Oe===0)var t=De.return;else t=De,qn=ka=null,Yl(t),vi=null,hs=0,t=De;for(;t!==null;)Lp(t.alternate,t),t=t.return;De=null}}function Ii(t,a){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,ob(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),Yn=0,Dc(),Xe=t,De=o=Un(t.current,null),Ue=a,Oe=0,Yt=null,fa=!1,Ci=Zi(t,a),Ec=!1,_i=Jt=Tc=Fa=pa=st=0,Lt=Ms=null,Cc=!1,(a&8)!==0&&(a|=a&32);var l=t.entangledLanes;if(l!==0)for(t=t.entanglements,l&=a;0<l;){var g=31-Gt(l),x=1<<g;a|=t[g],l&=~x}return Fn=a,go(),o}function rm(t,a){Ae=null,A.H=ws,a===xi||a===Eo?(a=wf(),Oe=3):a===Pl?(a=wf(),Oe=4):Oe=a===lc?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Yt=a,De===null&&(st=1,jo(t,nn(a,t.current)))}function lm(){var t=Ot.current;return t===null?!0:(Ue&4194048)===Ue?rn===null:(Ue&62914560)===Ue||(Ue&536870912)!==0?t===rn:!1}function cm(){var t=A.H;return A.H=ws,t===null?ws:t}function um(){var t=A.A;return A.A=jv,t}function Ko(){st=4,fa||(Ue&4194048)!==Ue&&Ot.current!==null||(Ci=!0),(pa&134217727)===0&&(Fa&134217727)===0||Xe===null||ga(Xe,Ue,Jt,!1)}function Mc(t,a,o){var l=ze;ze|=2;var g=cm(),x=um();(Xe!==t||Ue!==a)&&(Qo=null,Ii(t,a)),a=!1;var N=st;e:do try{if(Oe!==0&&De!==null){var E=De,M=Yt;switch(Oe){case 8:Dc(),N=6;break e;case 3:case 2:case 9:case 6:Ot.current===null&&(a=!0);var H=Oe;if(Oe=0,Yt=null,Di(t,E,M,H),o&&Ci){N=0;break e}break;default:H=Oe,Oe=0,Yt=null,Di(t,E,M,H)}}Gv(),N=st;break}catch(X){rm(t,X)}while(!0);return a&&t.shellSuspendCounter++,qn=ka=null,ze=l,A.H=g,A.A=x,De===null&&(Xe=null,Ue=0,go()),N}function Gv(){for(;De!==null;)dm(De)}function Hv(t,a){var o=ze;ze|=2;var l=cm(),g=um();Xe!==t||Ue!==a?(Qo=null,Jo=le()+500,Ii(t,a)):Ci=Zi(t,a);e:do try{if(Oe!==0&&De!==null){a=De;var x=Yt;t:switch(Oe){case 1:Oe=0,Yt=null,Di(t,a,x,1);break;case 2:case 9:if(Sf(x)){Oe=0,Yt=null,fm(a);break}a=function(){Oe!==2&&Oe!==9||Xe!==t||(Oe=7),Tn(t)},x.then(a,a);break e;case 3:Oe=7;break e;case 4:Oe=5;break e;case 7:Sf(x)?(Oe=0,Yt=null,fm(a)):(Oe=0,Yt=null,Di(t,a,x,7));break;case 5:var N=null;switch(De.tag){case 26:N=De.memoizedState;case 5:case 27:var E=De;if(N?Xm(N):E.stateNode.complete){Oe=0,Yt=null;var M=E.sibling;if(M!==null)De=M;else{var H=E.return;H!==null?(De=H,Xo(H)):De=null}break t}}Oe=0,Yt=null,Di(t,a,x,5);break;case 6:Oe=0,Yt=null,Di(t,a,x,6);break;case 8:Dc(),st=6;break e;default:throw Error(s(462))}}zv();break}catch(X){rm(t,X)}while(!0);return qn=ka=null,A.H=l,A.A=g,ze=o,De!==null?0:(Xe=null,Ue=0,go(),st)}function zv(){for(;De!==null&&!An();)dm(De)}function dm(t){var a=qp(t.alternate,t,Fn);t.memoizedProps=t.pendingProps,a===null?Xo(t):De=a}function fm(t){var a=t,o=a.alternate;switch(a.tag){case 15:case 0:a=Ip(o,a,a.pendingProps,a.type,void 0,Ue);break;case 11:a=Ip(o,a,a.pendingProps,a.type.render,a.ref,Ue);break;case 5:Yl(a);default:Lp(o,a),a=De=uf(a,Fn),a=qp(o,a,Fn)}t.memoizedProps=t.pendingProps,a===null?Xo(t):De=a}function Di(t,a,o,l){qn=ka=null,Yl(a),vi=null,hs=0;var g=a.return;try{if(Mv(t,g,a,o,Ue)){st=1,jo(t,nn(o,t.current)),De=null;return}}catch(x){if(g!==null)throw De=g,x;st=1,jo(t,nn(o,t.current)),De=null;return}a.flags&32768?(Le||l===1?t=!0:Ci||(Ue&536870912)!==0?t=!1:(fa=t=!0,(l===2||l===9||l===3||l===6)&&(l=Ot.current,l!==null&&l.tag===13&&(l.flags|=16384))),pm(a,t)):Xo(a)}function Xo(t){var a=t;do{if((a.flags&32768)!==0){pm(a,fa);return}t=a.return;var o=Pv(a.alternate,a,Fn);if(o!==null){De=o;return}if(a=a.sibling,a!==null){De=a;return}De=a=t}while(a!==null);st===0&&(st=5)}function pm(t,a){do{var o=qv(t.alternate,t);if(o!==null){o.flags&=32767,De=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(t=t.sibling,t!==null)){De=t;return}De=t=o}while(t!==null);st=6,De=null}function mm(t,a,o,l,g,x,N,E,M){t.cancelPendingCommit=null;do Zo();while(mt!==0);if((ze&6)!==0)throw Error(s(327));if(a!==null){if(a===t.current)throw Error(s(177));if(x=a.lanes|a.childLanes,x|=vl,Nx(t,o,x,N,E,M),t===Xe&&(De=Xe=null,Ue=0),Ai=a,ha=t,Yn=o,_c=x,Ac=g,am=l,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Jv(_e,function(){return vm(),null})):(t.callbackNode=null,t.callbackPriority=0),l=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||l){l=A.T,A.T=null,g=B.p,B.p=2,N=ze,ze|=4;try{kv(t,a,o)}finally{ze=N,B.p=g,A.T=l}}mt=1,hm(),gm(),ym()}}function hm(){if(mt===1){mt=0;var t=ha,a=Ai,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=A.T,A.T=null;var l=B.p;B.p=2;var g=ze;ze|=4;try{$p(a,t);var x=zc,N=ef(t.containerInfo),E=x.focusedElem,M=x.selectionRange;if(N!==E&&E&&E.ownerDocument&&Wd(E.ownerDocument.documentElement,E)){if(M!==null&&ml(E)){var H=M.start,X=M.end;if(X===void 0&&(X=H),"selectionStart"in E)E.selectionStart=H,E.selectionEnd=Math.min(X,E.value.length);else{var ne=E.ownerDocument||document,O=ne&&ne.defaultView||window;if(O.getSelection){var J=O.getSelection(),ge=E.textContent.length,Se=Math.min(M.start,ge),$e=M.end===void 0?Se:Math.min(M.end,ge);!J.extend&&Se>$e&&(N=$e,$e=Se,Se=N);var j=Zd(E,Se),U=Zd(E,$e);if(j&&U&&(J.rangeCount!==1||J.anchorNode!==j.node||J.anchorOffset!==j.offset||J.focusNode!==U.node||J.focusOffset!==U.offset)){var G=ne.createRange();G.setStart(j.node,j.offset),J.removeAllRanges(),Se>$e?(J.addRange(G),J.extend(U.node,U.offset)):(G.setEnd(U.node,U.offset),J.addRange(G))}}}}for(ne=[],J=E;J=J.parentNode;)J.nodeType===1&&ne.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<ne.length;E++){var ee=ne[E];ee.element.scrollLeft=ee.left,ee.element.scrollTop=ee.top}}ur=!!Hc,zc=Hc=null}finally{ze=g,B.p=l,A.T=o}}t.current=a,mt=2}}function gm(){if(mt===2){mt=0;var t=ha,a=Ai,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=A.T,A.T=null;var l=B.p;B.p=2;var g=ze;ze|=4;try{Op(t,a.alternate,a)}finally{ze=g,B.p=l,A.T=o}}mt=3}}function ym(){if(mt===4||mt===3){mt=0,oe();var t=ha,a=Ai,o=Yn,l=am;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?mt=5:(mt=0,Ai=ha=null,xm(t,t.pendingLanes));var g=t.pendingLanes;if(g===0&&(ma=null),$r(o),a=a.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(Xi,a,void 0,(a.current.flags&128)===128)}catch{}if(l!==null){a=A.T,g=B.p,B.p=2,A.T=null;try{for(var x=t.onRecoverableError,N=0;N<l.length;N++){var E=l[N];x(E.value,{componentStack:E.stack})}}finally{A.T=a,B.p=g}}(Yn&3)!==0&&Zo(),Tn(t),g=t.pendingLanes,(o&261930)!==0&&(g&42)!==0?t===Ic?Rs++:(Rs=0,Ic=t):Rs=0,Us(0)}}function xm(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,ps(a)))}function Zo(){return hm(),gm(),ym(),vm()}function vm(){if(mt!==5)return!1;var t=ha,a=_c;_c=0;var o=$r(Yn),l=A.T,g=B.p;try{B.p=32>o?32:o,A.T=null,o=Ac,Ac=null;var x=ha,N=Yn;if(mt=0,Ai=ha=null,Yn=0,(ze&6)!==0)throw Error(s(331));var E=ze;if(ze|=4,em(x.current),Xp(x,x.current,N,o),ze=E,Us(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(Xi,x)}catch{}return!0}finally{B.p=g,A.T=l,xm(t,a)}}function bm(t,a,o){a=nn(o,a),a=rc(t.stateNode,a,2),t=la(t,a,2),t!==null&&(Wi(t,2),Tn(t))}function Fe(t,a,o){if(t.tag===3)bm(t,t,o);else for(;a!==null;){if(a.tag===3){bm(a,t,o);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(ma===null||!ma.has(l))){t=nn(o,t),o=Sp(2),l=la(a,o,2),l!==null&&(Np(o,l,a,t),Wi(l,2),Tn(l));break}}a=a.return}}function Rc(t,a,o){var l=t.pingCache;if(l===null){l=t.pingCache=new Vv;var g=new Set;l.set(a,g)}else g=l.get(a),g===void 0&&(g=new Set,l.set(a,g));g.has(o)||(Ec=!0,g.add(o),t=Ov.bind(null,t,a,o),a.then(t,t))}function Ov(t,a,o){var l=t.pingCache;l!==null&&l.delete(a),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Xe===t&&(Ue&o)===o&&(st===4||st===3&&(Ue&62914560)===Ue&&300>le()-Yo?(ze&2)===0&&Ii(t,0):Tc|=o,_i===Ue&&(_i=0)),Tn(t)}function Sm(t,a){a===0&&(a=md()),t=Ua(t,a),t!==null&&(Wi(t,a),Tn(t))}function Fv(t){var a=t.memoizedState,o=0;a!==null&&(o=a.retryLane),Sm(t,o)}function Yv(t,a){var o=0;switch(t.tag){case 31:case 13:var l=t.stateNode,g=t.memoizedState;g!==null&&(o=g.retryLane);break;case 19:l=t.stateNode;break;case 22:l=t.stateNode._retryCache;break;default:throw Error(s(314))}l!==null&&l.delete(a),Sm(t,o)}function Jv(t,a){return Zt(t,a)}var Wo=null,Mi=null,Uc=!1,er=!1,Pc=!1,ya=0;function Tn(t){t!==Mi&&t.next===null&&(Mi===null?Wo=Mi=t:Mi=Mi.next=t),er=!0,Uc||(Uc=!0,$v())}function Us(t,a){if(!Pc&&er){Pc=!0;do for(var o=!1,l=Wo;l!==null;){if(t!==0){var g=l.pendingLanes;if(g===0)var x=0;else{var N=l.suspendedLanes,E=l.pingedLanes;x=(1<<31-Gt(42|t)+1)-1,x&=g&~(N&~E),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(o=!0,Tm(l,x))}else x=Ue,x=ao(l,l===Xe?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(x&3)===0||Zi(l,x)||(o=!0,Tm(l,x));l=l.next}while(o);Pc=!1}}function Qv(){Nm()}function Nm(){er=Uc=!1;var t=0;ya!==0&&sb()&&(t=ya);for(var a=le(),o=null,l=Wo;l!==null;){var g=l.next,x=wm(l,a);x===0?(l.next=null,o===null?Wo=g:o.next=g,g===null&&(Mi=o)):(o=l,(t!==0||(x&3)!==0)&&(er=!0)),l=g}mt!==0&&mt!==5||Us(t),ya!==0&&(ya=0)}function wm(t,a){for(var o=t.suspendedLanes,l=t.pingedLanes,g=t.expirationTimes,x=t.pendingLanes&-62914561;0<x;){var N=31-Gt(x),E=1<<N,M=g[N];M===-1?((E&o)===0||(E&l)!==0)&&(g[N]=Sx(E,a)):M<=a&&(t.expiredLanes|=E),x&=~E}if(a=Xe,o=Ue,o=ao(t,t===a?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l=t.callbackNode,o===0||t===a&&(Oe===2||Oe===9)||t.cancelPendingCommit!==null)return l!==null&&l!==null&&Vt(l),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Zi(t,o)){if(a=o&-o,a===t.callbackPriority)return a;switch(l!==null&&Vt(l),$r(o)){case 2:case 8:o=In;break;case 32:o=_e;break;case 268435456:o=Sn;break;default:o=_e}return l=Em.bind(null,t),o=Zt(o,l),t.callbackPriority=a,t.callbackNode=o,a}return l!==null&&l!==null&&Vt(l),t.callbackPriority=2,t.callbackNode=null,2}function Em(t,a){if(mt!==0&&mt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Zo()&&t.callbackNode!==o)return null;var l=Ue;return l=ao(t,t===Xe?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l===0?null:(sm(t,l,a),wm(t,le()),t.callbackNode!=null&&t.callbackNode===o?Em.bind(null,t):null)}function Tm(t,a){if(Zo())return null;sm(t,a,!0)}function $v(){rb(function(){(ze&6)!==0?Zt(Ve,Qv):Nm()})}function qc(){if(ya===0){var t=gi;t===0&&(t=eo,eo<<=1,(eo&261888)===0&&(eo=256)),ya=t}return ya}function Cm(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ro(""+t)}function _m(t,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,t.id&&o.setAttribute("form",t.id),a.parentNode.insertBefore(o,a),t=new FormData(t),o.parentNode.removeChild(o),t}function Kv(t,a,o,l,g){if(a==="submit"&&o&&o.stateNode===g){var x=Cm((g[Rt]||null).action),N=l.submitter;N&&(a=(a=N[Rt]||null)?Cm(a.formAction):N.getAttribute("formAction"),a!==null&&(x=a,N=null));var E=new fo("action","action",null,l,g);t.push({event:E,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(ya!==0){var M=N?_m(g,N):new FormData(g);tc(o,{pending:!0,data:M,method:g.method,action:x},null,M)}}else typeof x=="function"&&(E.preventDefault(),M=N?_m(g,N):new FormData(g),tc(o,{pending:!0,data:M,method:g.method,action:x},x,M))},currentTarget:g}]})}}for(var kc=0;kc<xl.length;kc++){var Lc=xl[kc],Xv=Lc.toLowerCase(),Zv=Lc[0].toUpperCase()+Lc.slice(1);fn(Xv,"on"+Zv)}fn(af,"onAnimationEnd"),fn(sf,"onAnimationIteration"),fn(of,"onAnimationStart"),fn("dblclick","onDoubleClick"),fn("focusin","onFocus"),fn("focusout","onBlur"),fn(mv,"onTransitionRun"),fn(hv,"onTransitionStart"),fn(gv,"onTransitionCancel"),fn(rf,"onTransitionEnd"),ni("onMouseEnter",["mouseout","mouseover"]),ni("onMouseLeave",["mouseout","mouseover"]),ni("onPointerEnter",["pointerout","pointerover"]),ni("onPointerLeave",["pointerout","pointerover"]),Ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ps="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ps));function Am(t,a){a=(a&4)!==0;for(var o=0;o<t.length;o++){var l=t[o],g=l.event;l=l.listeners;e:{var x=void 0;if(a)for(var N=l.length-1;0<=N;N--){var E=l[N],M=E.instance,H=E.currentTarget;if(E=E.listener,M!==x&&g.isPropagationStopped())break e;x=E,g.currentTarget=H;try{x(g)}catch(X){ho(X)}g.currentTarget=null,x=M}else for(N=0;N<l.length;N++){if(E=l[N],M=E.instance,H=E.currentTarget,E=E.listener,M!==x&&g.isPropagationStopped())break e;x=E,g.currentTarget=H;try{x(g)}catch(X){ho(X)}g.currentTarget=null,x=M}}}}function Me(t,a){var o=a[Kr];o===void 0&&(o=a[Kr]=new Set);var l=t+"__bubble";o.has(l)||(Im(a,t,2,!1),o.add(l))}function jc(t,a,o){var l=0;a&&(l|=4),Im(o,t,l,a)}var tr="_reactListening"+Math.random().toString(36).slice(2);function Vc(t){if(!t[tr]){t[tr]=!0,Sd.forEach(function(o){o!=="selectionchange"&&(Wv.has(o)||jc(o,!1,t),jc(o,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[tr]||(a[tr]=!0,jc("selectionchange",!1,a))}}function Im(t,a,o,l){switch(ih(a)){case 2:var g=_b;break;case 8:g=Ab;break;default:g=eu}o=g.bind(null,a,o,t),g=void 0,!sl||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),l?g!==void 0?t.addEventListener(a,o,{capture:!0,passive:g}):t.addEventListener(a,o,!0):g!==void 0?t.addEventListener(a,o,{passive:g}):t.addEventListener(a,o,!1)}function Bc(t,a,o,l,g){var x=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var N=l.tag;if(N===3||N===4){var E=l.stateNode.containerInfo;if(E===g)break;if(N===4)for(N=l.return;N!==null;){var M=N.tag;if((M===3||M===4)&&N.stateNode.containerInfo===g)return;N=N.return}for(;E!==null;){if(N=Wa(E),N===null)return;if(M=N.tag,M===5||M===6||M===26||M===27){l=x=N;continue e}E=E.parentNode}}l=l.return}Ud(function(){var H=x,X=al(o),ne=[];e:{var O=lf.get(t);if(O!==void 0){var J=fo,ge=t;switch(t){case"keypress":if(co(o)===0)break e;case"keydown":case"keyup":J=Yx;break;case"focusin":ge="focus",J=cl;break;case"focusout":ge="blur",J=cl;break;case"beforeblur":case"afterblur":J=cl;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=kd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Px;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=$x;break;case af:case sf:case of:J=Lx;break;case rf:J=Xx;break;case"scroll":case"scrollend":J=Rx;break;case"wheel":J=Wx;break;case"copy":case"cut":case"paste":J=Vx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=jd;break;case"toggle":case"beforetoggle":J=tv}var Se=(a&4)!==0,$e=!Se&&(t==="scroll"||t==="scrollend"),j=Se?O!==null?O+"Capture":null:O;Se=[];for(var U=H,G;U!==null;){var ee=U;if(G=ee.stateNode,ee=ee.tag,ee!==5&&ee!==26&&ee!==27||G===null||j===null||(ee=ns(U,j),ee!=null&&Se.push(qs(U,ee,G))),$e)break;U=U.return}0<Se.length&&(O=new J(O,ge,null,o,X),ne.push({event:O,listeners:Se}))}}if((a&7)===0){e:{if(O=t==="mouseover"||t==="pointerover",J=t==="mouseout"||t==="pointerout",O&&o!==nl&&(ge=o.relatedTarget||o.fromElement)&&(Wa(ge)||ge[Za]))break e;if((J||O)&&(O=X.window===X?X:(O=X.ownerDocument)?O.defaultView||O.parentWindow:window,J?(ge=o.relatedTarget||o.toElement,J=H,ge=ge?Wa(ge):null,ge!==null&&($e=c(ge),Se=ge.tag,ge!==$e||Se!==5&&Se!==27&&Se!==6)&&(ge=null)):(J=null,ge=H),J!==ge)){if(Se=kd,ee="onMouseLeave",j="onMouseEnter",U="mouse",(t==="pointerout"||t==="pointerover")&&(Se=jd,ee="onPointerLeave",j="onPointerEnter",U="pointer"),$e=J==null?O:ts(J),G=ge==null?O:ts(ge),O=new Se(ee,U+"leave",J,o,X),O.target=$e,O.relatedTarget=G,ee=null,Wa(X)===H&&(Se=new Se(j,U+"enter",ge,o,X),Se.target=G,Se.relatedTarget=$e,ee=Se),$e=ee,J&&ge)t:{for(Se=eb,j=J,U=ge,G=0,ee=j;ee;ee=Se(ee))G++;ee=0;for(var be=U;be;be=Se(be))ee++;for(;0<G-ee;)j=Se(j),G--;for(;0<ee-G;)U=Se(U),ee--;for(;G--;){if(j===U||U!==null&&j===U.alternate){Se=j;break t}j=Se(j),U=Se(U)}Se=null}else Se=null;J!==null&&Dm(ne,O,J,Se,!1),ge!==null&&$e!==null&&Dm(ne,$e,ge,Se,!0)}}e:{if(O=H?ts(H):window,J=O.nodeName&&O.nodeName.toLowerCase(),J==="select"||J==="input"&&O.type==="file")var Be=Yd;else if(Od(O))if(Jd)Be=dv;else{Be=cv;var xe=lv}else J=O.nodeName,!J||J.toLowerCase()!=="input"||O.type!=="checkbox"&&O.type!=="radio"?H&&tl(H.elementType)&&(Be=Yd):Be=uv;if(Be&&(Be=Be(t,H))){Fd(ne,Be,o,X);break e}xe&&xe(t,O,H),t==="focusout"&&H&&O.type==="number"&&H.memoizedProps.value!=null&&el(O,"number",O.value)}switch(xe=H?ts(H):window,t){case"focusin":(Od(xe)||xe.contentEditable==="true")&&(li=xe,hl=H,us=null);break;case"focusout":us=hl=li=null;break;case"mousedown":gl=!0;break;case"contextmenu":case"mouseup":case"dragend":gl=!1,tf(ne,o,X);break;case"selectionchange":if(pv)break;case"keydown":case"keyup":tf(ne,o,X)}var Ie;if(dl)e:{switch(t){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else ri?Hd(t,o)&&(Pe="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(Pe="onCompositionStart");Pe&&(Vd&&o.locale!=="ko"&&(ri||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&ri&&(Ie=Pd()):(ta=X,ol="value"in ta?ta.value:ta.textContent,ri=!0)),xe=nr(H,Pe),0<xe.length&&(Pe=new Ld(Pe,t,null,o,X),ne.push({event:Pe,listeners:xe}),Ie?Pe.data=Ie:(Ie=zd(o),Ie!==null&&(Pe.data=Ie)))),(Ie=av?iv(t,o):sv(t,o))&&(Pe=nr(H,"onBeforeInput"),0<Pe.length&&(xe=new Ld("onBeforeInput","beforeinput",null,o,X),ne.push({event:xe,listeners:Pe}),xe.data=Ie)),Kv(ne,t,H,o,X)}Am(ne,a)})}function qs(t,a,o){return{instance:t,listener:a,currentTarget:o}}function nr(t,a){for(var o=a+"Capture",l=[];t!==null;){var g=t,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=ns(t,o),g!=null&&l.unshift(qs(t,g,x)),g=ns(t,a),g!=null&&l.push(qs(t,g,x))),t.tag===3)return l;t=t.return}return[]}function eb(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Dm(t,a,o,l,g){for(var x=a._reactName,N=[];o!==null&&o!==l;){var E=o,M=E.alternate,H=E.stateNode;if(E=E.tag,M!==null&&M===l)break;E!==5&&E!==26&&E!==27||H===null||(M=H,g?(H=ns(o,x),H!=null&&N.unshift(qs(o,H,M))):g||(H=ns(o,x),H!=null&&N.push(qs(o,H,M)))),o=o.return}N.length!==0&&t.push({event:a,listeners:N})}var tb=/\r\n?/g,nb=/\u0000|\uFFFD/g;function Mm(t){return(typeof t=="string"?t:""+t).replace(tb,`
`).replace(nb,"")}function Rm(t,a){return a=Mm(a),Mm(t)===a}function Qe(t,a,o,l,g,x){switch(o){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||ii(t,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&ii(t,""+l);break;case"className":so(t,"class",l);break;case"tabIndex":so(t,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":so(t,o,l);break;case"style":Md(t,l,x);break;case"data":if(a!=="object"){so(t,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||o!=="href")){t.removeAttribute(o);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(o);break}l=ro(""+l),t.setAttribute(o,l);break;case"action":case"formAction":if(typeof l=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(o==="formAction"?(a!=="input"&&Qe(t,a,"name",g.name,g,null),Qe(t,a,"formEncType",g.formEncType,g,null),Qe(t,a,"formMethod",g.formMethod,g,null),Qe(t,a,"formTarget",g.formTarget,g,null)):(Qe(t,a,"encType",g.encType,g,null),Qe(t,a,"method",g.method,g,null),Qe(t,a,"target",g.target,g,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(o);break}l=ro(""+l),t.setAttribute(o,l);break;case"onClick":l!=null&&(t.onclick=Mn);break;case"onScroll":l!=null&&Me("scroll",t);break;case"onScrollEnd":l!=null&&Me("scrollend",t);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(o=l.__html,o!=null){if(g.children!=null)throw Error(s(60));t.innerHTML=o}}break;case"multiple":t.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":t.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){t.removeAttribute("xlink:href");break}o=ro(""+l),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(o,""+l):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":l===!0?t.setAttribute(o,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(o,l):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?t.setAttribute(o,l):t.removeAttribute(o);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?t.removeAttribute(o):t.setAttribute(o,l);break;case"popover":Me("beforetoggle",t),Me("toggle",t),io(t,"popover",l);break;case"xlinkActuate":Dn(t,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Dn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Dn(t,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Dn(t,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Dn(t,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Dn(t,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Dn(t,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Dn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Dn(t,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":io(t,"is",l);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Dx.get(o)||o,io(t,o,l))}}function Gc(t,a,o,l,g,x){switch(o){case"style":Md(t,l,x);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(o=l.__html,o!=null){if(g.children!=null)throw Error(s(60));t.innerHTML=o}}break;case"children":typeof l=="string"?ii(t,l):(typeof l=="number"||typeof l=="bigint")&&ii(t,""+l);break;case"onScroll":l!=null&&Me("scroll",t);break;case"onScrollEnd":l!=null&&Me("scrollend",t);break;case"onClick":l!=null&&(t.onclick=Mn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Nd.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),a=o.slice(2,g?o.length-7:void 0),x=t[Rt]||null,x=x!=null?x[o]:null,typeof x=="function"&&t.removeEventListener(a,x,g),typeof l=="function")){typeof x!="function"&&x!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(a,l,g);break e}o in t?t[o]=l:l===!0?t.setAttribute(o,""):io(t,o,l)}}}function wt(t,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",t),Me("load",t);var l=!1,g=!1,x;for(x in o)if(o.hasOwnProperty(x)){var N=o[x];if(N!=null)switch(x){case"src":l=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:Qe(t,a,x,N,o,null)}}g&&Qe(t,a,"srcSet",o.srcSet,o,null),l&&Qe(t,a,"src",o.src,o,null);return;case"input":Me("invalid",t);var E=x=N=g=null,M=null,H=null;for(l in o)if(o.hasOwnProperty(l)){var X=o[l];if(X!=null)switch(l){case"name":g=X;break;case"type":N=X;break;case"checked":M=X;break;case"defaultChecked":H=X;break;case"value":x=X;break;case"defaultValue":E=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(s(137,a));break;default:Qe(t,a,l,X,o,null)}}_d(t,x,E,M,H,N,g,!1);return;case"select":Me("invalid",t),l=N=x=null;for(g in o)if(o.hasOwnProperty(g)&&(E=o[g],E!=null))switch(g){case"value":x=E;break;case"defaultValue":N=E;break;case"multiple":l=E;default:Qe(t,a,g,E,o,null)}a=x,o=N,t.multiple=!!l,a!=null?ai(t,!!l,a,!1):o!=null&&ai(t,!!l,o,!0);return;case"textarea":Me("invalid",t),x=g=l=null;for(N in o)if(o.hasOwnProperty(N)&&(E=o[N],E!=null))switch(N){case"value":l=E;break;case"defaultValue":g=E;break;case"children":x=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(s(91));break;default:Qe(t,a,N,E,o,null)}Id(t,l,g,x);return;case"option":for(M in o)if(o.hasOwnProperty(M)&&(l=o[M],l!=null))switch(M){case"selected":t.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Qe(t,a,M,l,o,null)}return;case"dialog":Me("beforetoggle",t),Me("toggle",t),Me("cancel",t),Me("close",t);break;case"iframe":case"object":Me("load",t);break;case"video":case"audio":for(l=0;l<Ps.length;l++)Me(Ps[l],t);break;case"image":Me("error",t),Me("load",t);break;case"details":Me("toggle",t);break;case"embed":case"source":case"link":Me("error",t),Me("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(H in o)if(o.hasOwnProperty(H)&&(l=o[H],l!=null))switch(H){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:Qe(t,a,H,l,o,null)}return;default:if(tl(a)){for(X in o)o.hasOwnProperty(X)&&(l=o[X],l!==void 0&&Gc(t,a,X,l,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(l=o[E],l!=null&&Qe(t,a,E,l,o,null))}function ab(t,a,o,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,N=null,E=null,M=null,H=null,X=null;for(J in o){var ne=o[J];if(o.hasOwnProperty(J)&&ne!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":M=ne;default:l.hasOwnProperty(J)||Qe(t,a,J,null,l,ne)}}for(var O in l){var J=l[O];if(ne=o[O],l.hasOwnProperty(O)&&(J!=null||ne!=null))switch(O){case"type":x=J;break;case"name":g=J;break;case"checked":H=J;break;case"defaultChecked":X=J;break;case"value":N=J;break;case"defaultValue":E=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(s(137,a));break;default:J!==ne&&Qe(t,a,O,J,l,ne)}}Wr(t,N,E,M,H,X,x,g);return;case"select":J=N=E=O=null;for(x in o)if(M=o[x],o.hasOwnProperty(x)&&M!=null)switch(x){case"value":break;case"multiple":J=M;default:l.hasOwnProperty(x)||Qe(t,a,x,null,l,M)}for(g in l)if(x=l[g],M=o[g],l.hasOwnProperty(g)&&(x!=null||M!=null))switch(g){case"value":O=x;break;case"defaultValue":E=x;break;case"multiple":N=x;default:x!==M&&Qe(t,a,g,x,l,M)}a=E,o=N,l=J,O!=null?ai(t,!!o,O,!1):!!l!=!!o&&(a!=null?ai(t,!!o,a,!0):ai(t,!!o,o?[]:"",!1));return;case"textarea":J=O=null;for(E in o)if(g=o[E],o.hasOwnProperty(E)&&g!=null&&!l.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Qe(t,a,E,null,l,g)}for(N in l)if(g=l[N],x=o[N],l.hasOwnProperty(N)&&(g!=null||x!=null))switch(N){case"value":O=g;break;case"defaultValue":J=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==x&&Qe(t,a,N,g,l,x)}Ad(t,O,J);return;case"option":for(var ge in o)if(O=o[ge],o.hasOwnProperty(ge)&&O!=null&&!l.hasOwnProperty(ge))switch(ge){case"selected":t.selected=!1;break;default:Qe(t,a,ge,null,l,O)}for(M in l)if(O=l[M],J=o[M],l.hasOwnProperty(M)&&O!==J&&(O!=null||J!=null))switch(M){case"selected":t.selected=O&&typeof O!="function"&&typeof O!="symbol";break;default:Qe(t,a,M,O,l,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Se in o)O=o[Se],o.hasOwnProperty(Se)&&O!=null&&!l.hasOwnProperty(Se)&&Qe(t,a,Se,null,l,O);for(H in l)if(O=l[H],J=o[H],l.hasOwnProperty(H)&&O!==J&&(O!=null||J!=null))switch(H){case"children":case"dangerouslySetInnerHTML":if(O!=null)throw Error(s(137,a));break;default:Qe(t,a,H,O,l,J)}return;default:if(tl(a)){for(var $e in o)O=o[$e],o.hasOwnProperty($e)&&O!==void 0&&!l.hasOwnProperty($e)&&Gc(t,a,$e,void 0,l,O);for(X in l)O=l[X],J=o[X],!l.hasOwnProperty(X)||O===J||O===void 0&&J===void 0||Gc(t,a,X,O,l,J);return}}for(var j in o)O=o[j],o.hasOwnProperty(j)&&O!=null&&!l.hasOwnProperty(j)&&Qe(t,a,j,null,l,O);for(ne in l)O=l[ne],J=o[ne],!l.hasOwnProperty(ne)||O===J||O==null&&J==null||Qe(t,a,ne,O,l,J)}function Um(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ib(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,o=performance.getEntriesByType("resource"),l=0;l<o.length;l++){var g=o[l],x=g.transferSize,N=g.initiatorType,E=g.duration;if(x&&E&&Um(N)){for(N=0,E=g.responseEnd,l+=1;l<o.length;l++){var M=o[l],H=M.startTime;if(H>E)break;var X=M.transferSize,ne=M.initiatorType;X&&Um(ne)&&(M=M.responseEnd,N+=X*(M<E?1:(E-H)/(M-H)))}if(--l,a+=8*(x+N)/(g.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Hc=null,zc=null;function ar(t){return t.nodeType===9?t:t.ownerDocument}function Pm(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qm(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function Oc(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Fc=null;function sb(){var t=window.event;return t&&t.type==="popstate"?t===Fc?!1:(Fc=t,!0):(Fc=null,!1)}var km=typeof setTimeout=="function"?setTimeout:void 0,ob=typeof clearTimeout=="function"?clearTimeout:void 0,Lm=typeof Promise=="function"?Promise:void 0,rb=typeof queueMicrotask=="function"?queueMicrotask:typeof Lm<"u"?function(t){return Lm.resolve(null).then(t).catch(lb)}:km;function lb(t){setTimeout(function(){throw t})}function xa(t){return t==="head"}function jm(t,a){var o=a,l=0;do{var g=o.nextSibling;if(t.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(l===0){t.removeChild(g),qi(a);return}l--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")l++;else if(o==="html")ks(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,ks(o);for(var x=o.firstChild;x;){var N=x.nextSibling,E=x.nodeName;x[es]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&x.rel.toLowerCase()==="stylesheet"||o.removeChild(x),x=N}}else o==="body"&&ks(t.ownerDocument.body);o=g}while(o);qi(a)}function Vm(t,a){var o=t;t=0;do{var l=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),l&&l.nodeType===8)if(o=l.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=l}while(o)}function Yc(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Yc(o),Xr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function cb(t,a,o,l){for(;t.nodeType===1;){var g=o;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(l){if(!t[es])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(x=t.getAttribute("rel"),x==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(x!==g.rel||t.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||t.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||t.getAttribute("title")!==(g.title==null?null:g.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(x=t.getAttribute("src"),(x!==(g.src==null?null:g.src)||t.getAttribute("type")!==(g.type==null?null:g.type)||t.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&t.getAttribute("name")===x)return t}else return t;if(t=ln(t.nextSibling),t===null)break}return null}function ub(t,a,o){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=ln(t.nextSibling),t===null))return null;return t}function Bm(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=ln(t.nextSibling),t===null))return null;return t}function Jc(t){return t.data==="$?"||t.data==="$~"}function Qc(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function db(t,a){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||o.readyState!=="loading")a();else{var l=function(){a(),o.removeEventListener("DOMContentLoaded",l)};o.addEventListener("DOMContentLoaded",l),t._reactRetry=l}}function ln(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var $c=null;function Gm(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(a===0)return ln(t.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}t=t.nextSibling}return null}function Hm(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return t;a--}else o!=="/$"&&o!=="/&"||a++}t=t.previousSibling}return null}function zm(t,a,o){switch(a=ar(o),t){case"html":if(t=a.documentElement,!t)throw Error(s(452));return t;case"head":if(t=a.head,!t)throw Error(s(453));return t;case"body":if(t=a.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function ks(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Xr(t)}var cn=new Map,Om=new Set;function ir(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Jn=B.d;B.d={f:fb,r:pb,D:mb,C:hb,L:gb,m:yb,X:vb,S:xb,M:bb};function fb(){var t=Jn.f(),a=$o();return t||a}function pb(t){var a=ei(t);a!==null&&a.tag===5&&a.type==="form"?rp(a):Jn.r(t)}var Ri=typeof document>"u"?null:document;function Fm(t,a,o){var l=Ri;if(l&&typeof a=="string"&&a){var g=en(a);g='link[rel="'+t+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Om.has(g)||(Om.add(g),t={rel:t,crossOrigin:o,href:a},l.querySelector(g)===null&&(a=l.createElement("link"),wt(a,"link",t),gt(a),l.head.appendChild(a)))}}function mb(t){Jn.D(t),Fm("dns-prefetch",t,null)}function hb(t,a){Jn.C(t,a),Fm("preconnect",t,a)}function gb(t,a,o){Jn.L(t,a,o);var l=Ri;if(l&&t&&a){var g='link[rel="preload"][as="'+en(a)+'"]';a==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+en(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+en(o.imageSizes)+'"]')):g+='[href="'+en(t)+'"]';var x=g;switch(a){case"style":x=Ui(t);break;case"script":x=Pi(t)}cn.has(x)||(t=b({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:t,as:a},o),cn.set(x,t),l.querySelector(g)!==null||a==="style"&&l.querySelector(Ls(x))||a==="script"&&l.querySelector(js(x))||(a=l.createElement("link"),wt(a,"link",t),gt(a),l.head.appendChild(a)))}}function yb(t,a){Jn.m(t,a);var o=Ri;if(o&&t){var l=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+en(l)+'"][href="'+en(t)+'"]',x=g;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Pi(t)}if(!cn.has(x)&&(t=b({rel:"modulepreload",href:t},a),cn.set(x,t),o.querySelector(g)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(js(x)))return}l=o.createElement("link"),wt(l,"link",t),gt(l),o.head.appendChild(l)}}}function xb(t,a,o){Jn.S(t,a,o);var l=Ri;if(l&&t){var g=ti(l).hoistableStyles,x=Ui(t);a=a||"default";var N=g.get(x);if(!N){var E={loading:0,preload:null};if(N=l.querySelector(Ls(x)))E.loading=5;else{t=b({rel:"stylesheet",href:t,"data-precedence":a},o),(o=cn.get(x))&&Kc(t,o);var M=N=l.createElement("link");gt(M),wt(M,"link",t),M._p=new Promise(function(H,X){M.onload=H,M.onerror=X}),M.addEventListener("load",function(){E.loading|=1}),M.addEventListener("error",function(){E.loading|=2}),E.loading|=4,sr(N,a,l)}N={type:"stylesheet",instance:N,count:1,state:E},g.set(x,N)}}}function vb(t,a){Jn.X(t,a);var o=Ri;if(o&&t){var l=ti(o).hoistableScripts,g=Pi(t),x=l.get(g);x||(x=o.querySelector(js(g)),x||(t=b({src:t,async:!0},a),(a=cn.get(g))&&Xc(t,a),x=o.createElement("script"),gt(x),wt(x,"link",t),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},l.set(g,x))}}function bb(t,a){Jn.M(t,a);var o=Ri;if(o&&t){var l=ti(o).hoistableScripts,g=Pi(t),x=l.get(g);x||(x=o.querySelector(js(g)),x||(t=b({src:t,async:!0,type:"module"},a),(a=cn.get(g))&&Xc(t,a),x=o.createElement("script"),gt(x),wt(x,"link",t),o.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},l.set(g,x))}}function Ym(t,a,o,l){var g=(g=ye.current)?ir(g):null;if(!g)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Ui(o.href),o=ti(g).hoistableStyles,l=o.get(a),l||(l={type:"style",instance:null,count:0,state:null},o.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=Ui(o.href);var x=ti(g).hoistableStyles,N=x.get(t);if(N||(g=g.ownerDocument||g,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(t,N),(x=g.querySelector(Ls(t)))&&!x._p&&(N.instance=x,N.state.loading=5),cn.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},cn.set(t,o),x||Sb(g,t,o,N.state))),a&&l===null)throw Error(s(528,""));return N}if(a&&l!==null)throw Error(s(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Pi(o),o=ti(g).hoistableScripts,l=o.get(a),l||(l={type:"script",instance:null,count:0,state:null},o.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function Ui(t){return'href="'+en(t)+'"'}function Ls(t){return'link[rel="stylesheet"]['+t+"]"}function Jm(t){return b({},t,{"data-precedence":t.precedence,precedence:null})}function Sb(t,a,o,l){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=t.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),wt(a,"link",o),gt(a),t.head.appendChild(a))}function Pi(t){return'[src="'+en(t)+'"]'}function js(t){return"script[async]"+t}function Qm(t,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var l=t.querySelector('style[data-href~="'+en(o.href)+'"]');if(l)return a.instance=l,gt(l),l;var g=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return l=(t.ownerDocument||t).createElement("style"),gt(l),wt(l,"style",g),sr(l,o.precedence,t),a.instance=l;case"stylesheet":g=Ui(o.href);var x=t.querySelector(Ls(g));if(x)return a.state.loading|=4,a.instance=x,gt(x),x;l=Jm(o),(g=cn.get(g))&&Kc(l,g),x=(t.ownerDocument||t).createElement("link"),gt(x);var N=x;return N._p=new Promise(function(E,M){N.onload=E,N.onerror=M}),wt(x,"link",l),a.state.loading|=4,sr(x,o.precedence,t),a.instance=x;case"script":return x=Pi(o.src),(g=t.querySelector(js(x)))?(a.instance=g,gt(g),g):(l=o,(g=cn.get(x))&&(l=b({},o),Xc(l,g)),t=t.ownerDocument||t,g=t.createElement("script"),gt(g),wt(g,"link",l),t.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(s(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,sr(l,o.precedence,t));return a.instance}function sr(t,a,o){for(var l=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=l.length?l[l.length-1]:null,x=g,N=0;N<l.length;N++){var E=l[N];if(E.dataset.precedence===a)x=E;else if(x!==g)break}x?x.parentNode.insertBefore(t,x.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(t,a.firstChild))}function Kc(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Xc(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var or=null;function $m(t,a,o){if(or===null){var l=new Map,g=or=new Map;g.set(o,l)}else g=or,l=g.get(o),l||(l=new Map,g.set(o,l));if(l.has(t))return l;for(l.set(t,null),o=o.getElementsByTagName(t),g=0;g<o.length;g++){var x=o[g];if(!(x[es]||x[vt]||t==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var N=x.getAttribute(a)||"";N=t+N;var E=l.get(N);E?E.push(x):l.set(N,[x])}}return l}function Km(t,a,o){t=t.ownerDocument||t,t.head.insertBefore(o,a==="title"?t.querySelector("head > title"):null)}function Nb(t,a,o){if(o===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Xm(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function wb(t,a,o,l){if(o.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ui(l.href),x=a.querySelector(Ls(g));if(x){a=x._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=rr.bind(t),a.then(t,t)),o.state.loading|=4,o.instance=x,gt(x);return}x=a.ownerDocument||a,l=Jm(l),(g=cn.get(g))&&Kc(l,g),x=x.createElement("link"),gt(x);var N=x;N._p=new Promise(function(E,M){N.onload=E,N.onerror=M}),wt(x,"link",l),o.instance=x}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=rr.bind(t),a.addEventListener("load",o),a.addEventListener("error",o))}}var Zc=0;function Eb(t,a){return t.stylesheets&&t.count===0&&cr(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var l=setTimeout(function(){if(t.stylesheets&&cr(t,t.stylesheets),t.unsuspend){var x=t.unsuspend;t.unsuspend=null,x()}},6e4+a);0<t.imgBytes&&Zc===0&&(Zc=62500*ib());var g=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&cr(t,t.stylesheets),t.unsuspend)){var x=t.unsuspend;t.unsuspend=null,x()}},(t.imgBytes>Zc?50:800)+a);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(l),clearTimeout(g)}}:null}function rr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)cr(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var lr=null;function cr(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,lr=new Map,a.forEach(Tb,t),lr=null,rr.call(t))}function Tb(t,a){if(!(a.state.loading&4)){var o=lr.get(t);if(o)var l=o.get(null);else{o=new Map,lr.set(t,o);for(var g=t.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var N=g[x];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(o.set(N.dataset.precedence,N),l=N)}l&&o.set(null,l)}g=a.instance,N=g.getAttribute("data-precedence"),x=o.get(N)||l,x===l&&o.set(null,g),o.set(N,g),this.count++,l=rr.bind(this),g.addEventListener("load",l),g.addEventListener("error",l),x?x.parentNode.insertBefore(g,x.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(g,t.firstChild)),a.state.loading|=4}}var Vs={$$typeof:q,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function Cb(t,a,o,l,g,x,N,E,M){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jr(0),this.hiddenUpdates=Jr(null),this.identifierPrefix=l,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function Zm(t,a,o,l,g,x,N,E,M,H,X,ne){return t=new Cb(t,a,o,N,M,H,X,ne,E),a=1,x===!0&&(a|=24),x=zt(3,null,null,a),t.current=x,x.stateNode=t,a=Ml(),a.refCount++,t.pooledCache=a,a.refCount++,x.memoizedState={element:l,isDehydrated:o,cache:a},ql(x),t}function Wm(t){return t?(t=di,t):di}function eh(t,a,o,l,g,x){g=Wm(g),l.context===null?l.context=g:l.pendingContext=g,l=ra(a),l.payload={element:o},x=x===void 0?null:x,x!==null&&(l.callback=x),o=la(t,l,a),o!==null&&(jt(o,t,a),ys(o,t,a))}function th(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<a?o:a}}function Wc(t,a){th(t,a),(t=t.alternate)&&th(t,a)}function nh(t){if(t.tag===13||t.tag===31){var a=Ua(t,67108864);a!==null&&jt(a,t,67108864),Wc(t,67108864)}}function ah(t){if(t.tag===13||t.tag===31){var a=Qt();a=Qr(a);var o=Ua(t,a);o!==null&&jt(o,t,a),Wc(t,a)}}var ur=!0;function _b(t,a,o,l){var g=A.T;A.T=null;var x=B.p;try{B.p=2,eu(t,a,o,l)}finally{B.p=x,A.T=g}}function Ab(t,a,o,l){var g=A.T;A.T=null;var x=B.p;try{B.p=8,eu(t,a,o,l)}finally{B.p=x,A.T=g}}function eu(t,a,o,l){if(ur){var g=tu(l);if(g===null)Bc(t,a,l,dr,o),sh(t,l);else if(Db(g,t,a,o,l))l.stopPropagation();else if(sh(t,l),a&4&&-1<Ib.indexOf(t)){for(;g!==null;){var x=ei(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var N=Aa(x.pendingLanes);if(N!==0){var E=x;for(E.pendingLanes|=2,E.entangledLanes|=2;N;){var M=1<<31-Gt(N);E.entanglements[1]|=M,N&=~M}Tn(x),(ze&6)===0&&(Jo=le()+500,Us(0))}}break;case 31:case 13:E=Ua(x,2),E!==null&&jt(E,x,2),$o(),Wc(x,2)}if(x=tu(l),x===null&&Bc(t,a,l,dr,o),x===g)break;g=x}g!==null&&l.stopPropagation()}else Bc(t,a,l,null,o)}}function tu(t){return t=al(t),nu(t)}var dr=null;function nu(t){if(dr=null,t=Wa(t),t!==null){var a=c(t);if(a===null)t=null;else{var o=a.tag;if(o===13){if(t=f(a),t!==null)return t;t=null}else if(o===31){if(t=h(a),t!==null)return t;t=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return dr=t,null}function ih(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ee()){case Ve:return 2;case In:return 8;case _e:case _t:return 32;case Sn:return 268435456;default:return 32}default:return 32}}var au=!1,va=null,ba=null,Sa=null,Bs=new Map,Gs=new Map,Na=[],Ib="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sh(t,a){switch(t){case"focusin":case"focusout":va=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Bs.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gs.delete(a.pointerId)}}function Hs(t,a,o,l,g,x){return t===null||t.nativeEvent!==x?(t={blockedOn:a,domEventName:o,eventSystemFlags:l,nativeEvent:x,targetContainers:[g]},a!==null&&(a=ei(a),a!==null&&nh(a)),t):(t.eventSystemFlags|=l,a=t.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),t)}function Db(t,a,o,l,g){switch(a){case"focusin":return va=Hs(va,t,a,o,l,g),!0;case"dragenter":return ba=Hs(ba,t,a,o,l,g),!0;case"mouseover":return Sa=Hs(Sa,t,a,o,l,g),!0;case"pointerover":var x=g.pointerId;return Bs.set(x,Hs(Bs.get(x)||null,t,a,o,l,g)),!0;case"gotpointercapture":return x=g.pointerId,Gs.set(x,Hs(Gs.get(x)||null,t,a,o,l,g)),!0}return!1}function oh(t){var a=Wa(t.target);if(a!==null){var o=c(a);if(o!==null){if(a=o.tag,a===13){if(a=f(o),a!==null){t.blockedOn=a,vd(t.priority,function(){ah(o)});return}}else if(a===31){if(a=h(o),a!==null){t.blockedOn=a,vd(t.priority,function(){ah(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fr(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var o=tu(t.nativeEvent);if(o===null){o=t.nativeEvent;var l=new o.constructor(o.type,o);nl=l,o.target.dispatchEvent(l),nl=null}else return a=ei(o),a!==null&&nh(a),t.blockedOn=o,!1;a.shift()}return!0}function rh(t,a,o){fr(t)&&o.delete(a)}function Mb(){au=!1,va!==null&&fr(va)&&(va=null),ba!==null&&fr(ba)&&(ba=null),Sa!==null&&fr(Sa)&&(Sa=null),Bs.forEach(rh),Gs.forEach(rh)}function pr(t,a){t.blockedOn===a&&(t.blockedOn=null,au||(au=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Mb)))}var mr=null;function lh(t){mr!==t&&(mr=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){mr===t&&(mr=null);for(var a=0;a<t.length;a+=3){var o=t[a],l=t[a+1],g=t[a+2];if(typeof l!="function"){if(nu(l||o)===null)continue;break}var x=ei(o);x!==null&&(t.splice(a,3),a-=3,tc(x,{pending:!0,data:g,method:o.method,action:l},l,g))}}))}function qi(t){function a(M){return pr(M,t)}va!==null&&pr(va,t),ba!==null&&pr(ba,t),Sa!==null&&pr(Sa,t),Bs.forEach(a),Gs.forEach(a);for(var o=0;o<Na.length;o++){var l=Na[o];l.blockedOn===t&&(l.blockedOn=null)}for(;0<Na.length&&(o=Na[0],o.blockedOn===null);)oh(o),o.blockedOn===null&&Na.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(l=0;l<o.length;l+=3){var g=o[l],x=o[l+1],N=g[Rt]||null;if(typeof x=="function")N||lh(o);else if(N){var E=null;if(x&&x.hasAttribute("formAction")){if(g=x,N=x[Rt]||null)E=N.formAction;else if(nu(g)!==null)continue}else E=N.action;typeof E=="function"?o[l+1]=E:(o.splice(l,3),l-=3),lh(o)}}}function ch(){function t(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(N){return g=N})},focusReset:"manual",scroll:"manual"})}function a(){g!==null&&(g(),g=null),l||setTimeout(o,20)}function o(){if(!l&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,g=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){l=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),g!==null&&(g(),g=null)}}}function iu(t){this._internalRoot=t}hr.prototype.render=iu.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(s(409));var o=a.current,l=Qt();eh(o,l,t,a,null,null)},hr.prototype.unmount=iu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;eh(t.current,2,null,t,null,null),$o(),a[Za]=null}};function hr(t){this._internalRoot=t}hr.prototype.unstable_scheduleHydration=function(t){if(t){var a=xd();t={blockedOn:null,target:t,priority:a};for(var o=0;o<Na.length&&a!==0&&a<Na[o].priority;o++);Na.splice(o,0,t),o===0&&oh(t)}};var uh=e.version;if(uh!=="19.2.0")throw Error(s(527,uh,"19.2.0"));B.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=m(a),t=t!==null?v(t):null,t=t===null?null:t.stateNode,t};var Rb={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gr.isDisabled&&gr.supportsFiber)try{Xi=gr.inject(Rb),Bt=gr}catch{}}return Os.createRoot=function(t,a){if(!r(t))throw Error(s(299));var o=!1,l="",g=yp,x=xp,N=vp;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(x=a.onCaughtError),a.onRecoverableError!==void 0&&(N=a.onRecoverableError)),a=Zm(t,1,!1,null,null,o,l,null,g,x,N,ch),t[Za]=a.current,Vc(t),new iu(a)},Os.hydrateRoot=function(t,a,o){if(!r(t))throw Error(s(299));var l=!1,g="",x=yp,N=xp,E=vp,M=null;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(N=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(M=o.formState)),a=Zm(t,1,!0,a,o??null,l,g,M,x,N,E,ch),a.context=Wm(null),o=a.current,l=Qt(),l=Qr(l),g=ra(l),g.callback=null,la(o,g,l),o=l,a.current.lanes=o,Wi(a,o),Tn(a),t[Za]=a.current,Vc(t),new hr(a)},Os.version="19.2.0",Os}var bh;function Hb(){if(bh)return ru.exports;bh=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ru.exports=Gb(),ru.exports}var zb=Hb();const Ob=ug(zb);var Nr={isNone:function(){return!0},orElse:function(n){return n},orCall:function(n){return n()},orNull:function(){return null},orThrow:function(n){throw n===void 0&&(n="Unexpected null value"),new TypeError(n)},map:function(){return Nr},get:function(){return Nr}},fg=(function(){function n(e){this.value=e}return n.prototype.isNone=function(){return!1},n.prototype.orElse=function(){return this.value},n.prototype.orCall=function(){return this.value},n.prototype.orNull=function(){return this.value},n.prototype.orThrow=function(){return this.value},n.prototype.map=function(e){return ve(e(this.value))},n.prototype.get=function(e){return this.map(function(i){return i[e]})},n})();function Fb(n){return n===Nr||n instanceof fg}function ve(n){return Fb(n)?n:n==null?Nr:Yb(n)}function Yb(n){if(n==null)throw new TypeError("some() does not accept null or undefined");return new fg(n)}let wr=class extends Error{constructor(e){super(e.statusText),Object.setPrototypeOf(this,new.target.prototype),this.headers=e.headers,this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.data=e.data}},yu,pg;"rawJSON"in JSON&&(yu=function(n,e,i){if(Number.isInteger(e)&&!Number.isSafeInteger(e))try{return BigInt(i.source)}catch{return e}return e},pg=function(n,e){return typeof e=="bigint"?JSON.rawJSON(String(e)):e});const Lu=n=>n==="post"||n==="put"||n==="patch"||n==="delete";function Jb(n){const e=[],i=(s,r)=>`${encodeURIComponent(s)}=${encodeURIComponent(String(r))}`;return Object.keys(n).forEach(s=>{const r=n[s];r!=null&&(Array.isArray(r)?r.forEach(c=>e.push(i(s,c))):e.push(i(s,r)))}),e.length>0?`?${e.join("&")}`:""}function Qb(n,e){return n.replace(/\{([^}]+)\}/g,(i,s)=>{const r=encodeURIComponent(e[s]);return delete e[s],r})}function $b(n,e,i){let s={};return Lu(n)?i.forEach(r=>{s[r]=e[r],delete e[r]}):s={...e},Jb(s)}function Kb(n,e){const i=new Headers(e);return n!==void 0&&!(n instanceof FormData)&&!i.has("Content-Type")&&i.append("Content-Type","application/json"),i.has("Accept")||i.append("Accept","application/json"),i}function Xb(n,e){if(!Lu(n))return;const i=e instanceof FormData?e:JSON.stringify(e,pg);return n==="delete"&&i==="{}"?void 0:i}function Zb(n,e){const i=new Headers(n==null?void 0:n.headers),s=new Headers(e==null?void 0:e.headers);for(const r of s.keys()){const c=s.get(r);c!=null&&i.set(r,c)}return{...n,...e,headers:i}}function Wb(n){var y,m;const e=Object.assign(Array.isArray(n.payload)?[]:{},n.payload),i=Qb(n.path,e),s=$b(n.method,e,n.queryParams),r=Xb(n.method,e),c=Lu(n.method)?Kb(r,(y=n.init)==null?void 0:y.headers):new Headers((m=n.init)==null?void 0:m.headers),f=n.baseUrl+i+s,h={...n.init,method:n.method.toUpperCase(),headers:c,body:r};return{url:f,init:h}}async function eS(n){if(n.status===204)return;const e=n.headers.get("content-type"),i=await n.text();if(e&&e.includes("application/json"))return JSON.parse(i,yu);try{return JSON.parse(i,yu)}catch{return i}}async function tS(n,e){const i=await fetch(n,e),s=await eS(i),r={headers:i.headers,url:i.url,ok:i.ok,status:i.status,statusText:i.statusText,data:s};if(r.ok)return r;throw new wr(r)}function nS(n,e){const i=async(s,r,c)=>{if(n==null||s===n.length)return e(r,c);const f=n[s];return await f(r,c,(h,y)=>i(s+1,h,y))};return(s,r)=>i(0,s,r)}async function aS(n){const{url:e,init:i}=Wb(n);return await n.fetch(e,i)}function iS(n){const e=async(i,s)=>{try{return await n(i,s)}catch(r){throw r instanceof wr?new e.Error(r):r}};return e.Error=class extends wr{constructor(i){super(i),Object.setPrototypeOf(this,new.target.prototype)}getActualType(){return{status:this.status,data:this.data}}},e}function sS(){let n="",e={};const i=[],s=nS(i,tS);return{configure:r=>{n=r.baseUrl||"",e=r.init||{},i.splice(0),i.push(...r.use||[])},use:r=>i.push(r),path:r=>({method:c=>({create:(f=>iS((h,y)=>aS({baseUrl:n||"",path:r,method:c,queryParams:Object.keys(f||{}),payload:h,init:Zb(e,y),fetch:s})))})})}}const oS={for:()=>sS()},rS=200;class Qs extends Error{constructor(e){super(e),this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class ju extends Qs{static forResponse(e){const i=`${e.status}`,s=e.statusText?`(${e.statusText})`:"(Unrecognized Status Code)",r=`${i} ${s}`.trim(),c=e.data?JSON.stringify(e.data,null,2):null;let f="";c&&(f=c.length<=rS?c:c.slice(0,-4)+" ...");const h=`Raw response content:
${f}`;return new ju(`Unexpected Response: ${r}
${h}`)}}class yr extends Qs{}class lS extends Qs{}class cS extends Qs{constructor(e,i){super(e);const s=Number(i);if(isNaN(s))throw new Qs(`Invalid retryAfter value: ${i}`);this.retry_after=s,Object.setPrototypeOf(this,new.target.prototype)}}function uS(n){return{createShardKey:n.path("/collections/{collection_name}/shards").method("put").create({timeout:!0}),deleteShardKey:n.path("/collections/{collection_name}/shards/delete").method("post").create({timeout:!0}),root:n.path("/").method("get").create(),telemetry:n.path("/telemetry").method("get").create(),metrics:n.path("/metrics").method("get").create(),getLocks:n.path("/locks").method("get").create(),postLocks:n.path("/locks").method("post").create(),healthz:n.path("/healthz").method("get").create(),livez:n.path("/livez").method("get").create(),readyz:n.path("/readyz").method("get").create(),getIssues:n.path("/issues").method("get").create(),clearIssues:n.path("/issues").method("delete").create(),clusterStatus:n.path("/cluster").method("get").create(),recoverCurrentPeer:n.path("/cluster/recover").method("post").create(),removePeer:n.path("/cluster/peer/{peer_id}").method("delete").create({force:!0}),getCollections:n.path("/collections").method("get").create(),getCollection:n.path("/collections/{collection_name}").method("get").create(),createCollection:n.path("/collections/{collection_name}").method("put").create({timeout:!0}),deleteCollection:n.path("/collections/{collection_name}").method("delete").create({timeout:!0}),updateCollection:n.path("/collections/{collection_name}").method("patch").create({timeout:!0}),updateAliases:n.path("/collections/aliases").method("post").create({timeout:!0}),createFieldIndex:n.path("/collections/{collection_name}/index").method("put").create({wait:!0,ordering:!0}),collectionExists:n.path("/collections/{collection_name}/exists").method("get").create(),deleteFieldIndex:n.path("/collections/{collection_name}/index/{field_name}").method("delete").create({wait:!0,ordering:!0}),collectionClusterInfo:n.path("/collections/{collection_name}/cluster").method("get").create(),updateCollectionCluster:n.path("/collections/{collection_name}/cluster").method("post").create({timeout:!0}),getCollectionAliases:n.path("/collections/{collection_name}/aliases").method("get").create(),getCollectionsAliases:n.path("/aliases").method("get").create(),recoverFromUploadedSnapshot:n.path("/collections/{collection_name}/snapshots/upload").method("post").create({wait:!0,priority:!0,checksum:!0}),recoverFromSnapshot:n.path("/collections/{collection_name}/snapshots/recover").method("put").create({wait:!0}),listSnapshots:n.path("/collections/{collection_name}/snapshots").method("get").create(),createSnapshot:n.path("/collections/{collection_name}/snapshots").method("post").create({wait:!0}),getSnapshot:n.path("/collections/{collection_name}/snapshots/{snapshot_name}").method("get").create(),deleteSnapshot:n.path("/collections/{collection_name}/snapshots/{snapshot_name}").method("delete").create({wait:!0}),listFullSnapshots:n.path("/snapshots").method("get").create(),createFullSnapshot:n.path("/snapshots").method("post").create({wait:!0}),getFullSnapshot:n.path("/snapshots/{snapshot_name}").method("get").create(),deleteFullSnapshot:n.path("/snapshots/{snapshot_name}").method("delete").create({wait:!0}),recoverShardFromUploadedSnapshot:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots/upload").method("post").create({wait:!0,priority:!0,checksum:!0}),recoverShardFromSnapshot:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots/recover").method("put").create({wait:!0}),listShardSnapshots:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots").method("get").create(),createShardSnapshot:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots").method("post").create({wait:!0}),getShardSnapshot:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots/{snapshot_name}").method("get").create(),deleteShardSnapshot:n.path("/collections/{collection_name}/shards/{shard_id}/snapshots/{snapshot_name}").method("delete").create({wait:!0}),getPoint:n.path("/collections/{collection_name}/points/{id}").method("get").create(),upsertPoints:n.path("/collections/{collection_name}/points").method("put").create({wait:!0,ordering:!0}),getPoints:n.path("/collections/{collection_name}/points").method("post").create({consistency:!0,timeout:!0}),deletePoints:n.path("/collections/{collection_name}/points/delete").method("post").create({wait:!0,ordering:!0}),updateVectors:n.path("/collections/{collection_name}/points/vectors").method("put").create({wait:!0,ordering:!0}),deleteVectors:n.path("/collections/{collection_name}/points/vectors/delete").method("post").create({wait:!0,ordering:!0}),overwritePayload:n.path("/collections/{collection_name}/points/payload").method("put").create({wait:!0,ordering:!0}),setPayload:n.path("/collections/{collection_name}/points/payload").method("post").create({wait:!0,ordering:!0}),deletePayload:n.path("/collections/{collection_name}/points/payload/delete").method("post").create({wait:!0,ordering:!0}),clearPayload:n.path("/collections/{collection_name}/points/payload/clear").method("post").create({wait:!0,ordering:!0}),batchUpdate:n.path("/collections/{collection_name}/points/batch").method("post").create({wait:!0,ordering:!0}),scrollPoints:n.path("/collections/{collection_name}/points/scroll").method("post").create({consistency:!0,timeout:!0}),searchPoints:n.path("/collections/{collection_name}/points/search").method("post").create({consistency:!0,timeout:!0}),searchBatchPoints:n.path("/collections/{collection_name}/points/search/batch").method("post").create({consistency:!0,timeout:!0}),searchPointGroups:n.path("/collections/{collection_name}/points/search/groups").method("post").create({consistency:!0,timeout:!0}),recommendPoints:n.path("/collections/{collection_name}/points/recommend").method("post").create({consistency:!0,timeout:!0}),recommendBatchPoints:n.path("/collections/{collection_name}/points/recommend/batch").method("post").create({consistency:!0,timeout:!0}),recommendPointGroups:n.path("/collections/{collection_name}/points/recommend/groups").method("post").create({consistency:!0,timeout:!0}),discoverPoints:n.path("/collections/{collection_name}/points/discover").method("post").create({consistency:!0,timeout:!0}),discoverBatchPoints:n.path("/collections/{collection_name}/points/discover/batch").method("post").create({consistency:!0,timeout:!0}),countPoints:n.path("/collections/{collection_name}/points/count").method("post").create({timeout:!0}),facet:n.path("/collections/{collection_name}/facet").method("post").create({timeout:!0,consistency:!0}),queryPoints:n.path("/collections/{collection_name}/points/query").method("post").create({consistency:!0,timeout:!0}),queryBatchPoints:n.path("/collections/{collection_name}/points/query/batch").method("post").create({consistency:!0,timeout:!0}),queryPointsGroups:n.path("/collections/{collection_name}/points/query/groups").method("post").create({consistency:!0,timeout:!0}),searchMatrixPairs:n.path("/collections/{collection_name}/points/search/matrix/pairs").method("post").create({consistency:!0,timeout:!0}),searchMatrixOffsets:n.path("/collections/{collection_name}/points/search/matrix/offsets").method("post").create({consistency:!0,timeout:!0})}}function dS(n,e){const i=fS(n,e);return uS(i)}function fS(n,{headers:e,timeout:i,connections:s}){const r=[];Number.isFinite(i)&&r.push(async(f,h,y)=>{const m=new AbortController,v=setTimeout(()=>m.abort(),i);try{return await y(f,Object.assign(h,{signal:m.signal}))}catch(b){throw b instanceof Error&&b.name==="AbortError"?new lS(b.message):b}finally{clearTimeout(v)}}),r.push(async(f,h,y)=>{var v;let m;try{if(m=await y(f,h),m.status===200||m.status===201)return m}catch(b){if(b instanceof wr&&b.status===429){const S=(v=b.headers.get("retry-after"))==null?void 0:v[0];if(S)throw new cS(b.message,S)}throw b}throw ju.forResponse(m)});const c=oS.for();return c.configure({baseUrl:n,init:{headers:e,dispatcher:void 0},use:r}),c}const du="1.15.1",xu={parseVersion(n){if(!n)throw new Error("Version is null");let e,i;if([e,i]=n.split(".",2),e=parseInt(e,10),i=parseInt(i,10),isNaN(e)||isNaN(i))throw new Error(`Unable to parse version, expected format: x.y[.z], found: ${n}`);return{major:e,minor:i}},isCompatible(n,e){if(!n||!e)return console.debug(`Unable to compare versions with null values. Client: ${n}, Server: ${e}`),!1;if(n===e)return!0;try{const i=xu.parseVersion(n),s=xu.parseVersion(e);return i.major===s.major&&Math.abs(i.minor-s.minor)<=1}catch(i){return console.debug(`Unable to compare versions: ${i}`),!1}}};class pS{constructor({url:e,host:i,apiKey:s,https:r,prefix:c,port:f=6333,timeout:h=3e5,checkCompatibility:y=!0,...m}={}){if(this._https=r??typeof s=="string",this._scheme=this._https?"https":"http",this._prefix=c??"",this._prefix.length>0&&!this._prefix.startsWith("/")&&(this._prefix=`/${this._prefix}`),e&&i)throw new yr(`Only one of \`url\`, \`host\` params can be set. Url is ${e}, host is ${i}`);if(i&&(i.startsWith("http://")||i.startsWith("https://")||/:\d+$/.test(i)))throw new yr("The `host` param is not expected to contain neither protocol (http:// or https://) nor port (:6333).\nTry to use the `url` parameter instead.");if(e){if(!(e.startsWith("http://")||e.startsWith("https://")))throw new yr("The `url` param expected to contain a valid URL starting with a protocol (http:// or https://).");const I=new URL(e);if(this._host=I.hostname,this._port=I.port?Number(I.port):f,this._scheme=I.protocol.replace(":",""),this._prefix.length>0&&I.pathname!=="/")throw new yr(`Prefix can be set either in \`url\` or in \`prefix\`.
url is ${e}, prefix is ${I.pathname}`)}else this._port=f,this._host=i??"127.0.0.1";const v=new Headers([["user-agent","qdrant-js/"+String(du)]]),b=m.headers??{};Object.keys(b).forEach(I=>{b[I]&&v.set(I,String(b[I]))}),typeof s=="string"&&(this._scheme==="http"&&console.warn("Api key is used with unsecure connection."),v.set("api-key",s));const S=this._port?`${this._host}:${this._port}`:this._host;this._restUri=`${this._scheme}://${S}${this._prefix}`;const w=m.maxConnections,C={headers:v,timeout:h,connections:w};this._openApiClient=dS(this._restUri,C),y&&this._openApiClient.root({}).then(I=>{const P=I.data.version;xu.isCompatible(du,P)||console.warn(`Client version ${du} is incompatible with server version ${P}. Major versions should match and minor version difference must not exceed 1. Set checkCompatibility=false to skip version check.`)}).catch(()=>{console.warn("Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.")})}api(){return this._openApiClient}async searchBatch(e,{searches:i,consistency:s,timeout:r}){const c=await this._openApiClient.searchBatchPoints({collection_name:e,consistency:s,timeout:r,searches:i});return ve(c.data.result).orThrow("Search batch returned empty")}async search(e,{shard_key:i,vector:s,limit:r=10,offset:c=0,filter:f,params:h,with_payload:y=!0,with_vector:m=!1,score_threshold:v,consistency:b,timeout:S}){const w=await this._openApiClient.searchPoints({collection_name:e,consistency:b,timeout:S,shard_key:i,vector:s,limit:r,offset:c,filter:f,params:h,with_payload:y,with_vector:m,score_threshold:v});return ve(w.data.result).orThrow("Search returned empty")}async recommendBatch(e,{searches:i,consistency:s,timeout:r}){const c=await this._openApiClient.recommendBatchPoints({collection_name:e,searches:i,consistency:s,timeout:r});return ve(c.data.result).orElse([])}async recommend_batch(e,{searches:i,consistency:s,timeout:r}){const c=await this._openApiClient.recommendBatchPoints({collection_name:e,searches:i,consistency:s,timeout:r});return ve(c.data.result).orElse([])}async recommend(e,{shard_key:i,positive:s,negative:r,strategy:c,filter:f,params:h,limit:y=10,offset:m=0,with_payload:v=!0,with_vector:b=!1,score_threshold:S,using:w,lookup_from:C,consistency:I,timeout:P}){const k=await this._openApiClient.recommendPoints({collection_name:e,limit:y,shard_key:i,positive:s,negative:r,strategy:c,filter:f,params:h,offset:m,with_payload:v,with_vector:b,score_threshold:S,using:w,lookup_from:C,consistency:I,timeout:P});return ve(k.data.result).orThrow("Recommend points API returned empty")}async scroll(e,{shard_key:i,filter:s,consistency:r,timeout:c,limit:f=10,offset:h,with_payload:y=!0,with_vector:m=!1,order_by:v}={}){const b=await this._openApiClient.scrollPoints({collection_name:e,shard_key:i,limit:f,offset:h,filter:s,with_payload:y,with_vector:m,order_by:v,consistency:r,timeout:c});return ve(b.data.result).orThrow("Scroll points API returned empty")}async count(e,{shard_key:i,filter:s,exact:r=!0,timeout:c}={}){const f=await this._openApiClient.countPoints({collection_name:e,shard_key:i,filter:s,exact:r,timeout:c});return ve(f.data.result).orThrow("Count points returned empty")}async collectionClusterInfo(e){const i=await this._openApiClient.collectionClusterInfo({collection_name:e});return ve(i.data.result).orThrow("Collection cluster info returned empty")}async updateCollectionCluster(e,{timeout:i,...s}){const r=await this._openApiClient.updateCollectionCluster({collection_name:e,timeout:i,...s});return ve(r.data.result).orThrow("Update collection cluster returned empty")}async updateVectors(e,{wait:i=!0,ordering:s,points:r,shard_key:c}){const f=await this._openApiClient.updateVectors({collection_name:e,wait:i,ordering:s,points:r,shard_key:c});return ve(f.data.result).orThrow("Update vectors returned empty")}async deleteVectors(e,{wait:i=!0,ordering:s,points:r,filter:c,vector:f,shard_key:h}){const y=await this._openApiClient.deleteVectors({collection_name:e,wait:i,ordering:s,points:r,filter:c,vector:f,shard_key:h});return ve(y.data.result).orThrow("Delete vectors returned empty")}async searchPointGroups(e,{consistency:i,timeout:s,shard_key:r,vector:c,filter:f,params:h,with_payload:y=null,with_vector:m=null,score_threshold:v,group_by:b,group_size:S,limit:w}){const C=await this._openApiClient.searchPointGroups({collection_name:e,consistency:i,timeout:s,shard_key:r,vector:c,filter:f,params:h,with_payload:y,with_vector:m,score_threshold:v,group_by:b,group_size:S,limit:w});return ve(C.data.result).orThrow("Search point groups returned empty")}async recommendPointGroups(e,{consistency:i,timeout:s,shard_key:r,positive:c,strategy:f,negative:h=[],filter:y,params:m,with_payload:v=null,with_vector:b=null,score_threshold:S,using:w=null,lookup_from:C=null,group_by:I,group_size:P,limit:k}){const V=await this._openApiClient.recommendPointGroups({collection_name:e,consistency:i,timeout:s,shard_key:r,positive:c,negative:h,strategy:f,filter:y,params:m,with_payload:v,with_vector:b,score_threshold:S,using:w,lookup_from:C,group_by:I,group_size:P,limit:k});return ve(V.data.result).orThrow("Recommend point groups API returned empty")}async upsert(e,{wait:i=!0,ordering:s,...r}){const c=await this._openApiClient.upsertPoints({collection_name:e,wait:i,ordering:s,...r});return ve(c.data.result).orThrow("Upsert returned empty")}async retrieve(e,{shard_key:i,ids:s,with_payload:r=!0,with_vector:c,consistency:f,timeout:h}){const y=await this._openApiClient.getPoints({collection_name:e,shard_key:i,ids:s,with_payload:r,with_vector:c,consistency:f,timeout:h});return ve(y.data.result).orThrow("Retrieve API returned empty")}async delete(e,{wait:i,ordering:s,...r}){const c=await this._openApiClient.deletePoints({collection_name:e,wait:i,ordering:s,...r});return ve(c.data.result).orThrow("Delete points returned empty")}async setPayload(e,{payload:i,points:s,filter:r,shard_key:c,key:f,ordering:h,wait:y=!0}){const m=await this._openApiClient.setPayload({collection_name:e,payload:i,points:s,filter:r,shard_key:c,key:f,wait:y,ordering:h});return ve(m.data.result).orThrow("Set payload returned empty")}async overwritePayload(e,{ordering:i,payload:s,points:r,filter:c,shard_key:f,key:h,wait:y=!0}){const m=await this._openApiClient.overwritePayload({collection_name:e,payload:s,points:r,filter:c,shard_key:f,key:h,wait:y,ordering:i});return ve(m.data.result).orThrow("Overwrite payload returned empty")}async deletePayload(e,{ordering:i,keys:s,points:r,filter:c,shard_key:f,wait:h=!0}){const y=await this._openApiClient.deletePayload({collection_name:e,keys:s,points:r,filter:c,shard_key:f,wait:h,ordering:i});return ve(y.data.result).orThrow("Delete payload returned empty")}async clearPayload(e,{ordering:i,wait:s=!0,...r}){const c=await this._openApiClient.clearPayload({collection_name:e,wait:s,ordering:i,...r});return ve(c.data.result).orThrow("Clear payload returned empty")}async updateCollectionAliases({actions:e,timeout:i}){const s=await this._openApiClient.updateAliases({actions:e,timeout:i});return ve(s.data.result).orThrow("Update aliases returned empty")}async getCollectionAliases(e){const i=await this._openApiClient.getCollectionAliases({collection_name:e});return ve(i.data.result).orThrow("Get collection aliases returned empty")}async getAliases(){const e=await this._openApiClient.getCollectionsAliases({});return ve(e.data.result).orThrow("Get aliases returned empty")}async getCollections(){const e=await this._openApiClient.getCollections({});return ve(e.data.result).orThrow("Get collections returned empty")}async getCollection(e){const i=await this._openApiClient.getCollection({collection_name:e});return ve(i.data.result).orThrow("Get collection returned empty")}async updateCollection(e,i){const s=await this._openApiClient.updateCollection({collection_name:e,...i});return ve(s.data.result).orThrow("Update collection returned empty")}async deleteCollection(e,i){const s=await this._openApiClient.deleteCollection({collection_name:e,...i});return ve(s.data.result).orThrow("Delete collection returned empty")}async createCollection(e,{timeout:i,vectors:s,hnsw_config:r,init_from:c,on_disk_payload:f,optimizers_config:h,quantization_config:y,replication_factor:m,shard_number:v,sharding_method:b,wal_config:S,write_consistency_factor:w,sparse_vectors:C,strict_mode_config:I}){const P=await this._openApiClient.createCollection({collection_name:e,timeout:i,vectors:s,hnsw_config:r,init_from:c,on_disk_payload:f,optimizers_config:h,quantization_config:y,replication_factor:m,shard_number:v,sharding_method:b,wal_config:S,write_consistency_factor:w,sparse_vectors:C,strict_mode_config:I});return ve(P.data.result).orThrow("Create collection returned empty")}async recreateCollection(e,{timeout:i,vectors:s,hnsw_config:r,init_from:c,on_disk_payload:f,optimizers_config:h,quantization_config:y,replication_factor:m,shard_number:v,sharding_method:b,wal_config:S,write_consistency_factor:w,sparse_vectors:C,strict_mode_config:I}){ve(await this._openApiClient.deleteCollection({collection_name:e,timeout:i})).get("ok").orThrow("Delete collection returned failed");const P=await this._openApiClient.createCollection({collection_name:e,timeout:i,vectors:s,hnsw_config:r,init_from:c,on_disk_payload:f,optimizers_config:h,quantization_config:y,replication_factor:m,shard_number:v,sharding_method:b,wal_config:S,write_consistency_factor:w,sparse_vectors:C,strict_mode_config:I});return ve(P).orThrow("Create collection returned empty")}async createPayloadIndex(e,{wait:i,ordering:s,field_name:r,field_schema:c}){const f=await this._openApiClient.createFieldIndex({collection_name:e,field_name:r,field_schema:c,wait:i,ordering:s});return ve(f.data.result).orThrow("Create field index returned empty")}async deletePayloadIndex(e,i,{wait:s=!0,ordering:r}={}){const c=await this._openApiClient.deleteFieldIndex({collection_name:e,field_name:i,wait:s,ordering:r});return ve(c.data.result).orThrow("Delete field index returned empty")}async listSnapshots(e){const i=await this._openApiClient.listSnapshots({collection_name:e});return ve(i.data.result).orThrow("List snapshots API returned empty")}async createSnapshot(e,i){const s=await this._openApiClient.createSnapshot({collection_name:e,...i});return ve(s.data.result).orNull()}async deleteSnapshot(e,i,s){const r=await this._openApiClient.deleteSnapshot({collection_name:e,snapshot_name:i,...s});return ve(r.data.result).orThrow("Delete snapshot API returned empty")}async listFullSnapshots(){const e=await this._openApiClient.listFullSnapshots({});return ve(e.data.result).orThrow("List full snapshots API returned empty")}async createFullSnapshot(e){const i=await this._openApiClient.createFullSnapshot(e??{});return ve(i.data.result).orThrow("Create full snapshot API returned empty")}async deleteFullSnapshot(e,i){const s=await this._openApiClient.deleteFullSnapshot({snapshot_name:e,...i});return ve(s.data.result).orThrow("Delete full snapshot API returned empty")}async recoverSnapshot(e,{location:i,priority:s,checksum:r,api_key:c}){const f=await this._openApiClient.recoverFromSnapshot({collection_name:e,location:i,priority:s,checksum:r,api_key:c});return ve(f.data.result).orThrow("Recover from snapshot API returned empty")}async lockStorage(e){const i=await this._openApiClient.postLocks({write:!0,error_message:e});return ve(i.data.result).orThrow("Lock storage returned empty")}async unlockStorage(){const e=await this._openApiClient.postLocks({write:!1});return ve(e.data.result).orThrow("Post locks returned empty")}async getLocks(){const e=await this._openApiClient.getLocks({});return ve(e.data.result).orThrow("Get locks returned empty")}async batchUpdate(e,{wait:i=!0,ordering:s,...r}){const c=await this._openApiClient.batchUpdate({collection_name:e,wait:i,ordering:s,...r});return ve(c.data.result).orThrow("Batch update returned empty")}async recoverShardFromSnapshot(e,i,{wait:s=!0,...r}){const c=await this._openApiClient.recoverShardFromSnapshot({collection_name:e,shard_id:i,wait:s,...r});return ve(c.data.result).orThrow("Recover shard from snapshot returned empty")}async listShardSnapshots(e,i){const s=await this._openApiClient.listShardSnapshots({collection_name:e,shard_id:i});return ve(s.data.result).orThrow("List shard snapshots returned empty")}async createShardSnapshot(e,i,{wait:s=!0}){const r=await this._openApiClient.createShardSnapshot({collection_name:e,shard_id:i,wait:s});return ve(r.data.result).orThrow("Create shard snapshot returned empty")}async deleteShardSnapshot(e,i,s,{wait:r=!0}){const c=await this._openApiClient.deleteShardSnapshot({collection_name:e,shard_id:i,snapshot_name:s,wait:r});return ve(c.data.result).orThrow("Create shard snapshot returned empty")}async createShardKey(e,{shard_key:i,shards_number:s,replication_factor:r,placement:c,timeout:f}){const h=await this._openApiClient.createShardKey({collection_name:e,shard_key:i,shards_number:s,replication_factor:r,placement:c,timeout:f});return ve(h.data.result).orThrow("Create shard key returned empty")}async deleteShardKey(e,{shard_key:i,timeout:s}){const r=await this._openApiClient.deleteShardKey({collection_name:e,shard_key:i,timeout:s});return ve(r.data.result).orThrow("Create shard key returned empty")}async discoverPoints(e,{consistency:i,timeout:s,shard_key:r,target:c,context:f,params:h,limit:y,offset:m,with_payload:v,with_vector:b,using:S,lookup_from:w}){const C=await this._openApiClient.discoverPoints({collection_name:e,consistency:i,timeout:s,shard_key:r,target:c,context:f,params:h,limit:y,offset:m,with_payload:v,with_vector:b,using:S,lookup_from:w});return ve(C.data.result).orThrow("Discover points returned empty")}async discoverBatchPoints(e,{consistency:i,timeout:s,searches:r}){const c=await this._openApiClient.discoverBatchPoints({collection_name:e,consistency:i,timeout:s,searches:r});return ve(c.data.result).orThrow("Discover batch points returned empty")}async versionInfo(){const e=await this._openApiClient.root({});return ve(e.data).orThrow("Version Info returned empty")}async collectionExists(e){const i=await this._openApiClient.collectionExists({collection_name:e});return ve(i.data.result).orThrow("Collection exists returned empty")}async query(e,{consistency:i,timeout:s,shard_key:r,prefetch:c,query:f,using:h,filter:y,params:m,score_threshold:v,limit:b,offset:S,with_vector:w,with_payload:C,lookup_from:I}){const P=await this._openApiClient.queryPoints({collection_name:e,consistency:i,timeout:s,shard_key:r,prefetch:c,query:f,using:h,filter:y,params:m,score_threshold:v,limit:b,offset:S,with_vector:w,with_payload:C,lookup_from:I});return ve(P.data.result).orThrow("Query points returned empty")}async queryBatch(e,{consistency:i,timeout:s,searches:r}){const c=await this._openApiClient.queryBatchPoints({collection_name:e,consistency:i,timeout:s,searches:r});return ve(c.data.result).orThrow("Query points returned empty")}async queryGroups(e,{consistency:i,timeout:s,shard_key:r,prefetch:c,query:f,using:h,filter:y,params:m,score_threshold:v,with_vector:b,with_payload:S,group_by:w,group_size:C,limit:I,with_lookup:P}){const k=await this._openApiClient.queryPointsGroups({collection_name:e,consistency:i,timeout:s,shard_key:r,prefetch:c,query:f,using:h,filter:y,params:m,score_threshold:v,with_vector:b,with_payload:S,group_by:w,group_size:C,limit:I,with_lookup:P});return ve(k.data.result).orThrow("Query groups returned empty")}async facet(e,{consistency:i,timeout:s,shard_key:r,key:c,limit:f,filter:h,exact:y}){const m=await this._openApiClient.facet({collection_name:e,consistency:i,timeout:s,shard_key:r,key:c,limit:f,filter:h,exact:y});return ve(m.data.result).orThrow("Facet returned empty")}async searchMatrixPairs(e,{consistency:i,timeout:s,shard_key:r,filter:c,sample:f,limit:h,using:y}){const m=await this._openApiClient.searchMatrixPairs({collection_name:e,consistency:i,timeout:s,shard_key:r,filter:c,sample:f,limit:h,using:y});return ve(m.data.result).orThrow("Search points matrix pairs returned empty")}async searchMatrixOffsets(e,{consistency:i,timeout:s,shard_key:r,filter:c,sample:f,limit:h,using:y}){const m=await this._openApiClient.searchMatrixOffsets({collection_name:e,consistency:i,timeout:s,shard_key:r,filter:c,sample:f,limit:h,using:y});return ve(m.data.result).orThrow("Search points matrix offsets returned empty")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let mS,hS;function gS(){return{geminiUrl:mS,vertexUrl:hS}}function yS(n,e,i,s){var r,c;if(!(n!=null&&n.baseUrl)){const f=gS();return e?(r=f.vertexUrl)!==null&&r!==void 0?r:i:(c=f.geminiUrl)!==null&&c!==void 0?c:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kn{}function pe(n,e){const i=/\{([^}]+)\}/g;return n.replace(i,(s,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const c=e[r];return c!=null?String(c):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function p(n,e,i){for(let c=0;c<e.length-1;c++){const f=e[c];if(f.endsWith("[]")){const h=f.slice(0,-2);if(!(h in n))if(Array.isArray(i))n[h]=Array.from({length:i.length},()=>({}));else throw new Error(`Value must be a list given an array path ${f}`);if(Array.isArray(n[h])){const y=n[h];if(Array.isArray(i))for(let m=0;m<y.length;m++){const v=y[m];p(v,e.slice(c+1),i[m])}else for(const m of y)p(m,e.slice(c+1),i)}return}else if(f.endsWith("[0]")){const h=f.slice(0,-3);h in n||(n[h]=[{}]);const y=n[h];p(y[0],e.slice(c+1),i);return}(!n[f]||typeof n[f]!="object")&&(n[f]={}),n=n[f]}const s=e[e.length-1],r=n[s];if(r!==void 0){if(!i||typeof i=="object"&&Object.keys(i).length===0||i===r)return;if(typeof r=="object"&&typeof i=="object"&&r!==null&&i!==null)Object.assign(r,i);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof i=="object"&&i!==null&&!Array.isArray(i)?Object.assign(n,i):n[s]=i}function d(n,e,i=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let s=0;s<e.length;s++){if(typeof n!="object"||n===null)return i;const r=e[s];if(r.endsWith("[]")){const c=r.slice(0,-2);if(c in n){const f=n[c];return Array.isArray(f)?f.map(h=>d(h,e.slice(s+1),i)):i}else return i}else n=n[r]}return n}catch(s){if(s instanceof TypeError)return i;throw s}}function xS(n,e){for(const[i,s]of Object.entries(e)){const r=i.split("."),c=s.split("."),f=new Set;let h=-1;for(let y=0;y<r.length;y++)if(r[y]==="*"){h=y;break}if(h!==-1&&c.length>h)for(let y=h;y<c.length;y++){const m=c[y];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&f.add(m)}vu(n,r,c,0,f)}}function vu(n,e,i,s,r){if(s>=e.length||typeof n!="object"||n===null)return;const c=e[s];if(c.endsWith("[]")){const f=c.slice(0,-2),h=n;if(f in h&&Array.isArray(h[f]))for(const y of h[f])vu(y,e,i,s+1,r)}else if(c==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const f=n,h=Object.keys(f).filter(m=>!m.startsWith("_")&&!r.has(m)),y={};for(const m of h)y[m]=f[m];for(const[m,v]of Object.entries(y)){const b=[];for(const S of i.slice(s))S==="*"?b.push(m):b.push(S);p(f,b,v)}for(const m of h)delete f[m]}}else{const f=n;c in f&&vu(f[c],e,i,s+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vu(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vS(n){const e={},i=d(n,["operationName"]);i!=null&&p(e,["operationName"],i);const s=d(n,["resourceName"]);return s!=null&&p(e,["_url","resourceName"],s),e}function bS(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response","generateVideoResponse"]);return f!=null&&p(e,["response"],NS(f)),e}function SS(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response"]);return f!=null&&p(e,["response"],wS(f)),e}function NS(n){const e={},i=d(n,["generatedSamples"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>ES(f))),p(e,["generatedVideos"],c)}const s=d(n,["raiMediaFilteredCount"]);s!=null&&p(e,["raiMediaFilteredCount"],s);const r=d(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function wS(n){const e={},i=d(n,["videos"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>TS(f))),p(e,["generatedVideos"],c)}const s=d(n,["raiMediaFilteredCount"]);s!=null&&p(e,["raiMediaFilteredCount"],s);const r=d(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function ES(n){const e={},i=d(n,["video"]);return i!=null&&p(e,["video"],MS(i)),e}function TS(n){const e={},i=d(n,["_self"]);return i!=null&&p(e,["video"],RS(i)),e}function CS(n){const e={},i=d(n,["operationName"]);return i!=null&&p(e,["_url","operationName"],i),e}function _S(n){const e={},i=d(n,["operationName"]);return i!=null&&p(e,["_url","operationName"],i),e}function AS(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response"]);return f!=null&&p(e,["response"],IS(f)),e}function IS(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["parent"]);s!=null&&p(e,["parent"],s);const r=d(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function mg(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response"]);return f!=null&&p(e,["response"],DS(f)),e}function DS(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["parent"]);s!=null&&p(e,["parent"],s);const r=d(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function MS(n){const e={},i=d(n,["uri"]);i!=null&&p(e,["uri"],i);const s=d(n,["encodedVideo"]);s!=null&&p(e,["videoBytes"],Vu(s));const r=d(n,["encoding"]);return r!=null&&p(e,["mimeType"],r),e}function RS(n){const e={},i=d(n,["gcsUri"]);i!=null&&p(e,["uri"],i);const s=d(n,["bytesBase64Encoded"]);s!=null&&p(e,["videoBytes"],Vu(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sh;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Sh||(Sh={}));var Nh;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Nh||(Nh={}));var wh;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(wh||(wh={}));var Te;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Te||(Te={}));var Eh;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Eh||(Eh={}));var Th;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Th||(Th={}));var Ch;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Ch||(Ch={}));var _h;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(_h||(_h={}));var Ah;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Ah||(Ah={}));var Ih;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Ih||(Ih={}));var Dh;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Dh||(Dh={}));var Mh;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Mh||(Mh={}));var Rh;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Rh||(Rh={}));var Uh;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Uh||(Uh={}));var Ph;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ph||(Ph={}));var qh;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(qh||(qh={}));var kh;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(kh||(kh={}));var Lh;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Lh||(Lh={}));var Er;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Er||(Er={}));var jh;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(jh||(jh={}));var Vh;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Vh||(Vh={}));var Bh;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Bh||(Bh={}));var bu;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(bu||(bu={}));var Gh;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Gh||(Gh={}));var Hh;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(Hh||(Hh={}));var zh;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(zh||(zh={}));var Oh;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Oh||(Oh={}));var Fh;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Fh||(Fh={}));var Yh;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Yh||(Yh={}));var Jh;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Jh||(Jh={}));var Qh;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Qh||(Qh={}));var $h;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})($h||($h={}));var Kh;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Kh||(Kh={}));var Xh;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Xh||(Xh={}));var Zh;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Zh||(Zh={}));var Wh;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Wh||(Wh={}));var e0;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(e0||(e0={}));var t0;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(t0||(t0={}));var n0;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(n0||(n0={}));var a0;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(a0||(a0={}));var i0;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(i0||(i0={}));var s0;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(s0||(s0={}));var o0;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(o0||(o0={}));var r0;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(r0||(r0={}));var l0;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(l0||(l0={}));var c0;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(c0||(c0={}));var u0;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(u0||(u0={}));var d0;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(d0||(d0={}));var f0;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(f0||(f0={}));var p0;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(p0||(p0={}));var m0;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(m0||(m0={}));var h0;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(h0||(h0={}));var ji;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(ji||(ji={}));class Su{constructor(e){const i={};for(const s of e.headers.entries())i[s[0]]=s[1];this.headers=i,this.responseInternal=e}json(){return this.responseInternal.json()}}class Fs{get text(){var e,i,s,r,c,f,h,y;if(((r=(s=(i=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",v=!1;const b=[];for(const S of(y=(h=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||h===void 0?void 0:h.parts)!==null&&y!==void 0?y:[]){for(const[w,C]of Object.entries(S))w!=="text"&&w!=="thought"&&w!=="thoughtSignature"&&(C!==null||C!==void 0)&&b.push(w);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;v=!0,m+=S.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),v?m:void 0}get data(){var e,i,s,r,c,f,h,y;if(((r=(s=(i=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const v=[];for(const b of(y=(h=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||h===void 0?void 0:h.parts)!==null&&y!==void 0?y:[]){for(const[S,w]of Object.entries(b))S!=="inlineData"&&(w!==null||w!==void 0)&&v.push(S);b.inlineData&&typeof b.inlineData.data=="string"&&(m+=atob(b.inlineData.data))}return v.length>0&&console.warn(`there are non-data parts ${v} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,i,s,r,c,f,h,y;if(((r=(s=(i=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(y=(h=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||h===void 0?void 0:h.parts)===null||y===void 0?void 0:y.filter(v=>v.functionCall).map(v=>v.functionCall).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,i,s,r,c,f,h,y,m;if(((r=(s=(i=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const v=(y=(h=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||h===void 0?void 0:h.parts)===null||y===void 0?void 0:y.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(m=v==null?void 0:v[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,i,s,r,c,f,h,y,m;if(((r=(s=(i=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const v=(y=(h=(f=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content)===null||h===void 0?void 0:h.parts)===null||y===void 0?void 0:y.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(m=v==null?void 0:v[0])===null||m===void 0?void 0:m.output}}class g0{}class y0{}class US{}class PS{}class qS{}class kS{}class x0{}class v0{}class b0{}class LS{}class Tr{_fromAPIResponse({apiResponse:e,_isVertexAI:i}){const s=new Tr;let r;const c=e;return i?r=SS(c):r=bS(c),Object.assign(s,r),s}}class S0{}class N0{}class w0{}class jS{}class VS{}class BS{}class Bu{_fromAPIResponse({apiResponse:e,_isVertexAI:i}){const s=new Bu,c=AS(e);return Object.assign(s,c),s}}class GS{}class HS{}class zS{}class E0{}class OS{get text(){var e,i,s;let r="",c=!1;const f=[];for(const h of(s=(i=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||i===void 0?void 0:i.parts)!==null&&s!==void 0?s:[]){for(const[y,m]of Object.entries(h))y!=="text"&&y!=="thought"&&m!==null&&f.push(y);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;c=!0,r+=h.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?r:void 0}get data(){var e,i,s;let r="";const c=[];for(const f of(s=(i=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||i===void 0?void 0:i.parts)!==null&&s!==void 0?s:[]){for(const[h,y]of Object.entries(f))h!=="inlineData"&&y!==null&&c.push(h);f.inlineData&&typeof f.inlineData.data=="string"&&(r+=atob(f.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class FS{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Gu{_fromAPIResponse({apiResponse:e,_isVertexAI:i}){const s=new Gu,c=mg(e);return Object.assign(s,c),s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function He(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const i=e.split("/",2);return`publishers/${i[0]}/models/${i[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function hg(n,e){const i=He(n,e);return i?i.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${i}`:i.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${i}`:i:""}function gg(n){return Array.isArray(n)?n.map(e=>Cr(e)):[Cr(n)]}function Cr(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function yg(n){const e=Cr(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function xg(n){const e=Cr(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function T0(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function vg(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>T0(e)):[T0(n)]}function Nu(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function C0(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function _0(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ct(n){if(n==null)throw new Error("ContentUnion is required");return Nu(n)?n:{role:"user",parts:vg(n)}}function Hu(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(i=>{const s=Ct(i);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const i=Ct(e);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]}return Array.isArray(e)?e.map(i=>Ct(i)):[Ct(e)]}function un(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(C0(n)||_0(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ct(n)]}const e=[],i=[],s=Nu(n[0]);for(const r of n){const c=Nu(r);if(c!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(c)e.push(r);else{if(C0(r)||_0(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");i.push(r)}}return s||e.push({role:"user",parts:vg(i)}),e}function YS(n,e){n.includes("null")&&(e.nullable=!0);const i=n.filter(s=>s!=="null");if(i.length===1)e.type=Object.values(Te).includes(i[0].toUpperCase())?i[0].toUpperCase():Te.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of i)e.anyOf.push({type:Object.values(Te).includes(s.toUpperCase())?s.toUpperCase():Te.TYPE_UNSPECIFIED})}}function Vi(n){const e={},i=["items"],s=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const c=n.anyOf;c!=null&&c.length==2&&(c[0].type==="null"?(e.nullable=!0,n=c[1]):c[1].type==="null"&&(e.nullable=!0,n=c[0])),n.type instanceof Array&&YS(n.type,e);for(const[f,h]of Object.entries(n))if(h!=null)if(f=="type"){if(h==="null")throw new Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;e.type=Object.values(Te).includes(h.toUpperCase())?h.toUpperCase():Te.TYPE_UNSPECIFIED}else if(i.includes(f))e[f]=Vi(h);else if(s.includes(f)){const y=[];for(const m of h){if(m.type=="null"){e.nullable=!0;continue}y.push(Vi(m))}e[f]=y}else if(r.includes(f)){const y={};for(const[m,v]of Object.entries(h))y[m]=Vi(v);e[f]=y}else{if(f==="additionalProperties")continue;e[f]=h}return e}function zu(n){return Vi(n)}function Ou(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Fu(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Fi(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Vi(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Vi(e.response));return n}function Yi(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const i of n)e.push(i);return e}function JS(n,e,i,s=1){const r=!e.startsWith(`${i}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${i}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${i}/${e}`:e:r?`${i}/${e}`:e}function Xn(n,e){if(typeof e!="string")throw new Error("name must be a string");return JS(n,e,"cachedContents")}function bg(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Ca(n){return Vu(n)}function QS(n){return n!=null&&typeof n=="object"&&"name"in n}function $S(n){return n!=null&&typeof n=="object"&&"video"in n}function KS(n){return n!=null&&typeof n=="object"&&"uri"in n}function Sg(n){var e;let i;if(QS(n)&&(i=n.name),!(KS(n)&&(i=n.uri,i===void 0))&&!($S(n)&&(i=(e=n.video)===null||e===void 0?void 0:e.uri,i===void 0))){if(typeof n=="string"&&(i=n),i===void 0)throw new Error("Could not extract file name from the provided input.");if(i.startsWith("https://")){const r=i.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${i}`);i=r[0]}else i.startsWith("files/")&&(i=i.split("files/")[1]);return i}}function Ng(n,e){let i;return n.isVertexAI()?i=e?"publishers/google/models":"models":i=e?"models":"tunedModels",i}function wg(n){for(const e of["models","tunedModels","publisherModels"])if(XS(n,e))return n[e];return[]}function XS(n,e){return n!==null&&typeof n=="object"&&e in n}function ZS(n,e={}){const i=n,s={name:i.name,description:i.description,parametersJsonSchema:i.inputSchema};return i.outputSchema&&(s.responseJsonSchema=i.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function WS(n,e={}){const i=[],s=new Set;for(const r of n){const c=r.name;if(s.has(c))throw new Error(`Duplicate function name ${c} found in MCP tools. Please ensure function names are unique.`);s.add(c);const f=ZS(r,e);f.functionDeclarations&&i.push(...f.functionDeclarations)}return{functionDeclarations:i}}function Eg(n,e){let i;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))i={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))i={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))i={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");i={inlinedRequests:e}}else i=e;const s=[i.gcsUri,i.bigqueryUri].filter(Boolean).length,r=[i.inlinedRequests,i.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return i}function eN(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Tg(n){if(typeof n!="object"||n===null)return{};const e=n,i=e.inlinedResponses;if(typeof i!="object"||i===null)return n;const r=i.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let c=!1;for(const f of r){if(typeof f!="object"||f===null)continue;const y=f.response;if(typeof y!="object"||y===null)continue;if(y.embedding!==void 0){c=!0;break}}return c&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Ji(n,e){const i=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(i))return i.split("/").pop();throw new Error(`Invalid batch job name: ${i}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(i))return i.split("/").pop();if(/^\d+$/.test(i))return i;throw new Error(`Invalid batch job name: ${i}.`)}function Cg(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tN(n){const e={},i=d(n,["responsesFile"]);i!=null&&p(e,["fileName"],i);const s=d(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>RN(f))),p(e,["inlinedResponses"],c)}const r=d(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["inlinedEmbedContentResponses"],c)}return e}function nN(n){const e={},i=d(n,["predictionsFormat"]);i!=null&&p(e,["format"],i);const s=d(n,["gcsDestination","outputUriPrefix"]);s!=null&&p(e,["gcsUri"],s);const r=d(n,["bigqueryDestination","outputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function aN(n){const e={},i=d(n,["format"]);i!=null&&p(e,["predictionsFormat"],i);const s=d(n,["gcsUri"]);s!=null&&p(e,["gcsDestination","outputUriPrefix"],s);const r=d(n,["bigqueryUri"]);if(r!=null&&p(e,["bigqueryDestination","outputUri"],r),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function br(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata","displayName"]);s!=null&&p(e,["displayName"],s);const r=d(n,["metadata","state"]);r!=null&&p(e,["state"],Cg(r));const c=d(n,["metadata","createTime"]);c!=null&&p(e,["createTime"],c);const f=d(n,["metadata","endTime"]);f!=null&&p(e,["endTime"],f);const h=d(n,["metadata","updateTime"]);h!=null&&p(e,["updateTime"],h);const y=d(n,["metadata","model"]);y!=null&&p(e,["model"],y);const m=d(n,["metadata","output"]);return m!=null&&p(e,["dest"],tN(Tg(m))),e}function wu(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["displayName"]);s!=null&&p(e,["displayName"],s);const r=d(n,["state"]);r!=null&&p(e,["state"],Cg(r));const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["createTime"]);f!=null&&p(e,["createTime"],f);const h=d(n,["startTime"]);h!=null&&p(e,["startTime"],h);const y=d(n,["endTime"]);y!=null&&p(e,["endTime"],y);const m=d(n,["updateTime"]);m!=null&&p(e,["updateTime"],m);const v=d(n,["model"]);v!=null&&p(e,["model"],v);const b=d(n,["inputConfig"]);b!=null&&p(e,["src"],iN(b));const S=d(n,["outputConfig"]);S!=null&&p(e,["dest"],nN(Tg(S)));const w=d(n,["completionStats"]);return w!=null&&p(e,["completionStats"],w),e}function iN(n){const e={},i=d(n,["instancesFormat"]);i!=null&&p(e,["format"],i);const s=d(n,["gcsSource","uris"]);s!=null&&p(e,["gcsUri"],s);const r=d(n,["bigquerySource","inputUri"]);return r!=null&&p(e,["bigqueryUri"],r),e}function sN(n,e){const i={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=d(e,["fileName"]);s!=null&&p(i,["fileName"],s);const r=d(e,["inlinedRequests"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>MN(n,f))),p(i,["requests","requests"],c)}return i}function oN(n){const e={},i=d(n,["format"]);i!=null&&p(e,["instancesFormat"],i);const s=d(n,["gcsUri"]);s!=null&&p(e,["gcsSource","uris"],s);const r=d(n,["bigqueryUri"]);if(r!=null&&p(e,["bigquerySource","inputUri"],r),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function rN(n){const e={},i=d(n,["data"]);if(i!=null&&p(e,["data"],i),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function lN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function cN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function uN(n){const e={},i=d(n,["content"]);i!=null&&p(e,["content"],i);const s=d(n,["citationMetadata"]);s!=null&&p(e,["citationMetadata"],dN(s));const r=d(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);const c=d(n,["finishReason"]);c!=null&&p(e,["finishReason"],c);const f=d(n,["avgLogprobs"]);f!=null&&p(e,["avgLogprobs"],f);const h=d(n,["groundingMetadata"]);h!=null&&p(e,["groundingMetadata"],h);const y=d(n,["index"]);y!=null&&p(e,["index"],y);const m=d(n,["logprobsResult"]);m!=null&&p(e,["logprobsResult"],m);const v=d(n,["safetyRatings"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(w=>w)),p(e,["safetyRatings"],S)}const b=d(n,["urlContextMetadata"]);return b!=null&&p(e,["urlContextMetadata"],b),e}function dN(n){const e={},i=d(n,["citationSources"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),p(e,["citations"],s)}return e}function _g(n){const e={},i=d(n,["parts"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(c=>VN(c))),p(e,["parts"],r)}const s=d(n,["role"]);return s!=null&&p(e,["role"],s),e}function fN(n,e){const i={},s=d(n,["displayName"]);if(e!==void 0&&s!=null&&p(e,["batch","displayName"],s),d(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return i}function pN(n,e){const i={},s=d(n,["displayName"]);e!==void 0&&s!=null&&p(e,["displayName"],s);const r=d(n,["dest"]);return e!==void 0&&r!=null&&p(e,["outputConfig"],aN(eN(r))),i}function A0(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["src"]);r!=null&&p(i,["batch","inputConfig"],sN(n,Eg(n,r)));const c=d(e,["config"]);return c!=null&&fN(c,i),i}function mN(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["model"],He(n,s));const r=d(e,["src"]);r!=null&&p(i,["inputConfig"],oN(Eg(n,r)));const c=d(e,["config"]);return c!=null&&pN(c,i),i}function hN(n,e){const i={},s=d(n,["displayName"]);return e!==void 0&&s!=null&&p(e,["batch","displayName"],s),i}function gN(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["src"]);r!=null&&p(i,["batch","inputConfig"],wN(n,r));const c=d(e,["config"]);return c!=null&&hN(c,i),i}function yN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function xN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function vN(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&p(e,["name"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);return c!=null&&p(e,["error"],c),e}function bN(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&p(e,["name"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);return c!=null&&p(e,["error"],c),e}function SN(n,e){const i={},s=d(e,["contents"]);if(s!=null){let c=Hu(n,s);Array.isArray(c)&&(c=c.map(f=>f)),p(i,["requests[]","request","content"],c)}const r=d(e,["config"]);return r!=null&&(p(i,["_self"],NN(r,i)),xS(i,{"requests[].*":"requests[].request.*"})),i}function NN(n,e){const i={},s=d(n,["taskType"]);e!==void 0&&s!=null&&p(e,["requests[]","taskType"],s);const r=d(n,["title"]);e!==void 0&&r!=null&&p(e,["requests[]","title"],r);const c=d(n,["outputDimensionality"]);if(e!==void 0&&c!=null&&p(e,["requests[]","outputDimensionality"],c),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function wN(n,e){const i={},s=d(e,["fileName"]);s!=null&&p(i,["file_name"],s);const r=d(e,["inlinedRequests"]);return r!=null&&p(i,["requests"],SN(n,r)),i}function EN(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function TN(n,e,i){const s={},r=d(e,["systemInstruction"]);i!==void 0&&r!=null&&p(i,["systemInstruction"],_g(Ct(r)));const c=d(e,["temperature"]);c!=null&&p(s,["temperature"],c);const f=d(e,["topP"]);f!=null&&p(s,["topP"],f);const h=d(e,["topK"]);h!=null&&p(s,["topK"],h);const y=d(e,["candidateCount"]);y!=null&&p(s,["candidateCount"],y);const m=d(e,["maxOutputTokens"]);m!=null&&p(s,["maxOutputTokens"],m);const v=d(e,["stopSequences"]);v!=null&&p(s,["stopSequences"],v);const b=d(e,["responseLogprobs"]);b!=null&&p(s,["responseLogprobs"],b);const S=d(e,["logprobs"]);S!=null&&p(s,["logprobs"],S);const w=d(e,["presencePenalty"]);w!=null&&p(s,["presencePenalty"],w);const C=d(e,["frequencyPenalty"]);C!=null&&p(s,["frequencyPenalty"],C);const I=d(e,["seed"]);I!=null&&p(s,["seed"],I);const P=d(e,["responseMimeType"]);P!=null&&p(s,["responseMimeType"],P);const k=d(e,["responseSchema"]);k!=null&&p(s,["responseSchema"],zu(k));const V=d(e,["responseJsonSchema"]);if(V!=null&&p(s,["responseJsonSchema"],V),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=d(e,["safetySettings"]);if(i!==void 0&&q!=null){let ue=q;Array.isArray(ue)&&(ue=ue.map(Ne=>BN(Ne))),p(i,["safetySettings"],ue)}const D=d(e,["tools"]);if(i!==void 0&&D!=null){let ue=Yi(D);Array.isArray(ue)&&(ue=ue.map(Ne=>GN(Fi(Ne)))),p(i,["tools"],ue)}const R=d(e,["toolConfig"]);if(i!==void 0&&R!=null&&p(i,["toolConfig"],R),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);i!==void 0&&z!=null&&p(i,["cachedContent"],Xn(n,z));const F=d(e,["responseModalities"]);F!=null&&p(s,["responseModalities"],F);const ie=d(e,["mediaResolution"]);ie!=null&&p(s,["mediaResolution"],ie);const K=d(e,["speechConfig"]);if(K!=null&&p(s,["speechConfig"],Ou(K)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Y=d(e,["thinkingConfig"]);Y!=null&&p(s,["thinkingConfig"],Y);const fe=d(e,["imageConfig"]);return fe!=null&&p(s,["imageConfig"],fe),s}function CN(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["candidates"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(m=>uN(m))),p(e,["candidates"],y)}const r=d(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);const c=d(n,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const f=d(n,["responseId"]);f!=null&&p(e,["responseId"],f);const h=d(n,["usageMetadata"]);return h!=null&&p(e,["usageMetadata"],h),e}function _N(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function AN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Ji(n,s)),i}function IN(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=d(n,["enableWidget"]);return i!=null&&p(e,["enableWidget"],i),e}function DN(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=d(n,["timeRangeFilter"]);return i!=null&&p(e,["timeRangeFilter"],i),e}function MN(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["request","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let h=un(r);Array.isArray(h)&&(h=h.map(y=>_g(y))),p(i,["request","contents"],h)}const c=d(e,["metadata"]);c!=null&&p(i,["metadata"],c);const f=d(e,["config"]);return f!=null&&p(i,["request","generationConfig"],TN(n,f,d(i,["request"],{}))),i}function RN(n){const e={},i=d(n,["response"]);i!=null&&p(e,["response"],CN(i));const s=d(n,["error"]);return s!=null&&p(e,["error"],s),e}function UN(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);if(e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),d(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return i}function PN(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);e!==void 0&&r!=null&&p(e,["_query","pageToken"],r);const c=d(n,["filter"]);return e!==void 0&&c!=null&&p(e,["_query","filter"],c),i}function qN(n){const e={},i=d(n,["config"]);return i!=null&&UN(i,e),e}function kN(n){const e={},i=d(n,["config"]);return i!=null&&PN(i,e),e}function LN(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["operations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>br(f))),p(e,["batchJobs"],c)}return e}function jN(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["batchPredictionJobs"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>wu(f))),p(e,["batchJobs"],c)}return e}function VN(n){const e={},i=d(n,["functionCall"]);i!=null&&p(e,["functionCall"],i);const s=d(n,["codeExecutionResult"]);s!=null&&p(e,["codeExecutionResult"],s);const r=d(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);const c=d(n,["fileData"]);c!=null&&p(e,["fileData"],EN(c));const f=d(n,["functionResponse"]);f!=null&&p(e,["functionResponse"],f);const h=d(n,["inlineData"]);h!=null&&p(e,["inlineData"],rN(h));const y=d(n,["text"]);y!=null&&p(e,["text"],y);const m=d(n,["thought"]);m!=null&&p(e,["thought"],m);const v=d(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const b=d(n,["videoMetadata"]);return b!=null&&p(e,["videoMetadata"],b),e}function BN(n){const e={},i=d(n,["category"]);if(i!=null&&p(e,["category"],i),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=d(n,["threshold"]);return s!=null&&p(e,["threshold"],s),e}function GN(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=d(n,["googleSearchRetrieval"]);s!=null&&p(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);r!=null&&p(e,["computerUse"],r);const c=d(n,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const f=d(n,["codeExecution"]);if(f!=null&&p(e,["codeExecution"],f),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const h=d(n,["googleMaps"]);h!=null&&p(e,["googleMaps"],IN(h));const y=d(n,["googleSearch"]);y!=null&&p(e,["googleSearch"],DN(y));const m=d(n,["urlContext"]);return m!=null&&p(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $n;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})($n||($n={}));class Ka{constructor(e,i,s,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=i,this.init(e,s,r)}init(e,i,s){var r,c;this.nameInternal=e,this.pageInternal=i[this.nameInternal]||[],this.sdkHttpResponseInternal=i==null?void 0:i.sdkHttpResponse,this.idxInternal=0;let f={config:{}};!s||Object.keys(s).length===0?f={config:{}}:typeof s=="object"?f=Object.assign({},s):f=s,f.config&&(f.config.pageToken=i.nextPageToken),this.paramsInternal=f,this.pageInternalSize=(c=(r=f.config)===null||r===void 0?void 0:r.pageSize)!==null&&c!==void 0?c:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HN extends Kn{constructor(e){super(),this.apiClient=e,this.create=async i=>(this.apiClient.isVertexAI()&&(i.config=this.formatDestination(i.src,i.config)),this.createInternal(i)),this.createEmbeddings=async i=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(i)},this.list=async(i={})=>new Ka($n.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(i),i)}createInlinedGenerateContentRequest(e){const i=A0(this.apiClient,e),s=i._url,r=pe("{model}:batchGenerateContent",s),h=i.batch.inputConfig.requests,y=h.requests,m=[];for(const v of y){const b=Object.assign({},v);if(b.systemInstruction){const S=b.systemInstruction;delete b.systemInstruction;const w=b.request;w.systemInstruction=S,b.request=w}m.push(b)}return h.requests=m,delete i.config,delete i._url,delete i._query,{path:r,body:i}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,i){const s=i?Object.assign({},i):{},r=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${r}`),s.dest===void 0){const c=this.getGcsUri(e),f=this.getBigqueryUri(e);if(c)c.endsWith(".jsonl")?s.dest=`${c.slice(0,-6)}/dest`:s.dest=`${c}_dest_${r}`;else if(f)s.dest=`${f}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=mN(this.apiClient,e);return h=pe("batchPredictionJobs",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>wu(v))}else{const m=A0(this.apiClient,e);return h=pe("{model}:batchGenerateContent",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>br(v))}}async createEmbeddingsInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=gN(this.apiClient,e);return c=pe("{model}:asyncBatchEmbedContent",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>br(y))}}async get(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=AN(this.apiClient,e);return h=pe("batchPredictionJobs/{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>wu(v))}else{const m=_N(this.apiClient,e);return h=pe("batches/{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>br(v))}}async cancel(e){var i,s,r,c;let f="",h={};if(this.apiClient.isVertexAI()){const y=cN(this.apiClient,e);f=pe("batchPredictionJobs/{name}:cancel",y._url),h=y._query,delete y._url,delete y._query,await this.apiClient.request({path:f,queryParams:h,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const y=lN(this.apiClient,e);f=pe("batches/{name}:cancel",y._url),h=y._query,delete y._url,delete y._query,await this.apiClient.request({path:f,queryParams:h,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal})}}async listInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=kN(e);return h=pe("batchPredictionJobs",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=jN(v),S=new E0;return Object.assign(S,b),S})}else{const m=qN(e);return h=pe("batches",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=LN(v),S=new E0;return Object.assign(S,b),S})}}async delete(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=xN(this.apiClient,e);return h=pe("batchPredictionJobs/{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>bN(v))}else{const m=yN(this.apiClient,e);return h=pe("batches/{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>vN(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zN(n){const e={},i=d(n,["data"]);if(i!=null&&p(e,["data"],i),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function I0(n){const e={},i=d(n,["parts"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(c=>uw(c))),p(e,["parts"],r)}const s=d(n,["role"]);return s!=null&&p(e,["role"],s),e}function ON(n,e){const i={},s=d(n,["ttl"]);e!==void 0&&s!=null&&p(e,["ttl"],s);const r=d(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);const c=d(n,["displayName"]);e!==void 0&&c!=null&&p(e,["displayName"],c);const f=d(n,["contents"]);if(e!==void 0&&f!=null){let v=un(f);Array.isArray(v)&&(v=v.map(b=>I0(b))),p(e,["contents"],v)}const h=d(n,["systemInstruction"]);e!==void 0&&h!=null&&p(e,["systemInstruction"],I0(Ct(h)));const y=d(n,["tools"]);if(e!==void 0&&y!=null){let v=y;Array.isArray(v)&&(v=v.map(b=>dw(b))),p(e,["tools"],v)}const m=d(n,["toolConfig"]);if(e!==void 0&&m!=null&&p(e,["toolConfig"],m),d(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return i}function FN(n,e){const i={},s=d(n,["ttl"]);e!==void 0&&s!=null&&p(e,["ttl"],s);const r=d(n,["expireTime"]);e!==void 0&&r!=null&&p(e,["expireTime"],r);const c=d(n,["displayName"]);e!==void 0&&c!=null&&p(e,["displayName"],c);const f=d(n,["contents"]);if(e!==void 0&&f!=null){let b=un(f);Array.isArray(b)&&(b=b.map(S=>S)),p(e,["contents"],b)}const h=d(n,["systemInstruction"]);e!==void 0&&h!=null&&p(e,["systemInstruction"],Ct(h));const y=d(n,["tools"]);if(e!==void 0&&y!=null){let b=y;Array.isArray(b)&&(b=b.map(S=>fw(S))),p(e,["tools"],b)}const m=d(n,["toolConfig"]);e!==void 0&&m!=null&&p(e,["toolConfig"],m);const v=d(n,["kmsKeyName"]);return e!==void 0&&v!=null&&p(e,["encryption_spec","kmsKeyName"],v),i}function YN(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["model"],hg(n,s));const r=d(e,["config"]);return r!=null&&ON(r,i),i}function JN(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["model"],hg(n,s));const r=d(e,["config"]);return r!=null&&FN(r,i),i}function QN(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Xn(n,s)),i}function $N(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Xn(n,s)),i}function KN(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function XN(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function ZN(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function WN(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const i=d(n,["description"]);i!=null&&p(e,["description"],i);const s=d(n,["name"]);s!=null&&p(e,["name"],s);const r=d(n,["parameters"]);r!=null&&p(e,["parameters"],r);const c=d(n,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const f=d(n,["response"]);f!=null&&p(e,["response"],f);const h=d(n,["responseJsonSchema"]);return h!=null&&p(e,["responseJsonSchema"],h),e}function ew(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Xn(n,s)),i}function tw(n,e){const i={},s=d(e,["name"]);return s!=null&&p(i,["_url","name"],Xn(n,s)),i}function nw(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=d(n,["enableWidget"]);return i!=null&&p(e,["enableWidget"],i),e}function aw(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=d(n,["timeRangeFilter"]);return i!=null&&p(e,["timeRangeFilter"],i),e}function iw(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),i}function sw(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),i}function ow(n){const e={},i=d(n,["config"]);return i!=null&&iw(i,e),e}function rw(n){const e={},i=d(n,["config"]);return i!=null&&sw(i,e),e}function lw(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["cachedContents"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["cachedContents"],c)}return e}function cw(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["cachedContents"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["cachedContents"],c)}return e}function uw(n){const e={},i=d(n,["functionCall"]);i!=null&&p(e,["functionCall"],i);const s=d(n,["codeExecutionResult"]);s!=null&&p(e,["codeExecutionResult"],s);const r=d(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);const c=d(n,["fileData"]);c!=null&&p(e,["fileData"],ZN(c));const f=d(n,["functionResponse"]);f!=null&&p(e,["functionResponse"],f);const h=d(n,["inlineData"]);h!=null&&p(e,["inlineData"],zN(h));const y=d(n,["text"]);y!=null&&p(e,["text"],y);const m=d(n,["thought"]);m!=null&&p(e,["thought"],m);const v=d(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const b=d(n,["videoMetadata"]);return b!=null&&p(e,["videoMetadata"],b),e}function dw(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=d(n,["googleSearchRetrieval"]);s!=null&&p(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);r!=null&&p(e,["computerUse"],r);const c=d(n,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const f=d(n,["codeExecution"]);if(f!=null&&p(e,["codeExecution"],f),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const h=d(n,["googleMaps"]);h!=null&&p(e,["googleMaps"],nw(h));const y=d(n,["googleSearch"]);y!=null&&p(e,["googleSearch"],aw(y));const m=d(n,["urlContext"]);return m!=null&&p(e,["urlContext"],m),e}function fw(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let b=i;Array.isArray(b)&&(b=b.map(S=>WN(S))),p(e,["functionDeclarations"],b)}const s=d(n,["retrieval"]);s!=null&&p(e,["retrieval"],s);const r=d(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const c=d(n,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=d(n,["codeExecution"]);f!=null&&p(e,["codeExecution"],f);const h=d(n,["enterpriseWebSearch"]);h!=null&&p(e,["enterpriseWebSearch"],h);const y=d(n,["googleMaps"]);y!=null&&p(e,["googleMaps"],y);const m=d(n,["googleSearch"]);m!=null&&p(e,["googleSearch"],m);const v=d(n,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function pw(n,e){const i={},s=d(n,["ttl"]);e!==void 0&&s!=null&&p(e,["ttl"],s);const r=d(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),i}function mw(n,e){const i={},s=d(n,["ttl"]);e!==void 0&&s!=null&&p(e,["ttl"],s);const r=d(n,["expireTime"]);return e!==void 0&&r!=null&&p(e,["expireTime"],r),i}function hw(n,e){const i={},s=d(e,["name"]);s!=null&&p(i,["_url","name"],Xn(n,s));const r=d(e,["config"]);return r!=null&&pw(r,i),i}function gw(n,e){const i={},s=d(e,["name"]);s!=null&&p(i,["_url","name"],Xn(n,s));const r=d(e,["config"]);return r!=null&&mw(r,i),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yw extends Kn{constructor(e){super(),this.apiClient=e,this.list=async(i={})=>new Ka($n.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(i),i)}async create(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=JN(this.apiClient,e);return h=pe("cachedContents",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>v)}else{const m=YN(this.apiClient,e);return h=pe("cachedContents",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>v)}}async get(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=tw(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>v)}else{const m=ew(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>v)}}async delete(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=$N(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=XN(v),S=new N0;return Object.assign(S,b),S})}else{const m=QN(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=KN(v),S=new N0;return Object.assign(S,b),S})}}async update(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=gw(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>v)}else{const m=hw(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>v)}}async listInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=rw(e);return h=pe("cachedContents",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=cw(v),S=new w0;return Object.assign(S,b),S})}else{const m=ow(e);return h=pe("cachedContents",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=lw(v),S=new w0;return Object.assign(S,b),S})}}}function D0(n){var e=typeof Symbol=="function"&&Symbol.iterator,i=e&&n[e],s=0;if(i)return i.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tt(n){return this instanceof tt?(this.v=n,this):new tt(n)}function Bi(n,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(n,e||[]),r,c=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",f),r[Symbol.asyncIterator]=function(){return this},r;function f(w){return function(C){return Promise.resolve(C).then(w,b)}}function h(w,C){s[w]&&(r[w]=function(I){return new Promise(function(P,k){c.push([w,I,P,k])>1||y(w,I)})},C&&(r[w]=C(r[w])))}function y(w,C){try{m(s[w](C))}catch(I){S(c[0][3],I)}}function m(w){w.value instanceof tt?Promise.resolve(w.value.v).then(v,b):S(c[0][2],w)}function v(w){y("next",w)}function b(w){y("throw",w)}function S(w,C){w(C),c.shift(),c.length&&y(c[0][0],c[0][1])}}function Ys(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],i;return e?e.call(n):(n=typeof D0=="function"?D0(n):n[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(c){i[c]=n[c]&&function(f){return new Promise(function(h,y){f=n[c](f),r(h,y,f.done,f.value)})}}function r(c,f,h,y){Promise.resolve(y).then(function(m){c({value:m,done:h})},f)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xw(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const i=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return i===void 0?!1:Ag(i)}function Ag(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function vw(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function M0(n){if(n===void 0||n.length===0)return[];const e=[],i=n.length;let s=0;for(;s<i;)if(n[s].role==="user")e.push(n[s]),s++;else{const r=[];let c=!0;for(;s<i&&n[s].role==="model";)r.push(n[s]),c&&!Ag(n[s])&&(c=!1),s++;c?e.push(...r):e.pop()}return e}class bw{constructor(e,i){this.modelsModule=e,this.apiClient=i}create(e){return new Sw(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Sw{constructor(e,i,s,r={},c=[]){this.apiClient=e,this.modelsModule=i,this.model=s,this.config=r,this.history=c,this.sendPromise=Promise.resolve(),vw(c)}async sendMessage(e){var i;await this.sendPromise;const s=Ct(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(i=e.config)!==null&&i!==void 0?i:this.config});return this.sendPromise=(async()=>{var c,f,h;const y=await r,m=(f=(c=y.candidates)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f.content,v=y.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let S=[];v!=null&&(S=(h=v.slice(b))!==null&&h!==void 0?h:[]);const w=m?[m]:[];this.recordHistory(s,w,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var i;await this.sendPromise;const s=Ct(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(i=e.config)!==null&&i!==void 0?i:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const c=await r;return this.processStreamResponse(c,s)}getHistory(e=!1){const i=e?M0(this.history):this.history;return structuredClone(i)}processStreamResponse(e,i){var s,r;return Bi(this,arguments,function*(){var f,h,y,m;const v=[];try{for(var b=!0,S=Ys(e),w;w=yield tt(S.next()),f=w.done,!f;b=!0){m=w.value,b=!1;const C=m;if(xw(C)){const I=(r=(s=C.candidates)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.content;I!==void 0&&v.push(I)}yield yield tt(C)}}catch(C){h={error:C}}finally{try{!b&&!f&&(y=S.return)&&(yield tt(y.call(S)))}finally{if(h)throw h.error}}this.recordHistory(i,v)})}recordHistory(e,i,s){let r=[];i.length>0&&i.every(c=>c.role!==void 0)?r=i:r.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...M0(s)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ur extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ur.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nw(n){const e={},i=d(n,["file"]);return i!=null&&p(e,["file"],i),e}function ww(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function Ew(n){const e={},i=d(n,["name"]);return i!=null&&p(e,["_url","file"],Sg(i)),e}function Tw(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function Cw(n){const e={},i=d(n,["name"]);return i!=null&&p(e,["_url","file"],Sg(i)),e}function _w(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),i}function Aw(n){const e={},i=d(n,["config"]);return i!=null&&_w(i,e),e}function Iw(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["files"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["files"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dw extends Kn{constructor(e){super(),this.apiClient=e,this.list=async(i={})=>new Ka($n.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(i),i)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(i=>i)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=Aw(e);return c=pe("files",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>{const m=Iw(y),v=new GS;return Object.assign(v,m),v})}}async createInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=Nw(e);return c=pe("upload/v1beta/files",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=ww(y),v=new HS;return Object.assign(v,m),v})}}async get(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=Cw(e);return c=pe("files/{file}",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>y)}}async delete(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=Ew(e);return c=pe("files/{file}",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>{const m=Tw(y),v=new zS;return Object.assign(v,m),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sr(n){const e={},i=d(n,["data"]);if(i!=null&&p(e,["data"],i),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function Mw(n){const e={},i=d(n,["parts"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(c=>Yw(c))),p(e,["parts"],r)}const s=d(n,["role"]);return s!=null&&p(e,["role"],s),e}function Rw(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function Uw(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const i=d(n,["description"]);i!=null&&p(e,["description"],i);const s=d(n,["name"]);s!=null&&p(e,["name"],s);const r=d(n,["parameters"]);r!=null&&p(e,["parameters"],r);const c=d(n,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const f=d(n,["response"]);f!=null&&p(e,["response"],f);const h=d(n,["responseJsonSchema"]);return h!=null&&p(e,["responseJsonSchema"],h),e}function Pw(n){const e={},i=d(n,["modelSelectionConfig"]);i!=null&&p(e,["modelConfig"],i);const s=d(n,["responseJsonSchema"]);s!=null&&p(e,["responseJsonSchema"],s);const r=d(n,["audioTimestamp"]);r!=null&&p(e,["audioTimestamp"],r);const c=d(n,["candidateCount"]);c!=null&&p(e,["candidateCount"],c);const f=d(n,["enableAffectiveDialog"]);f!=null&&p(e,["enableAffectiveDialog"],f);const h=d(n,["frequencyPenalty"]);h!=null&&p(e,["frequencyPenalty"],h);const y=d(n,["logprobs"]);y!=null&&p(e,["logprobs"],y);const m=d(n,["maxOutputTokens"]);m!=null&&p(e,["maxOutputTokens"],m);const v=d(n,["mediaResolution"]);v!=null&&p(e,["mediaResolution"],v);const b=d(n,["presencePenalty"]);b!=null&&p(e,["presencePenalty"],b);const S=d(n,["responseLogprobs"]);S!=null&&p(e,["responseLogprobs"],S);const w=d(n,["responseMimeType"]);w!=null&&p(e,["responseMimeType"],w);const C=d(n,["responseModalities"]);C!=null&&p(e,["responseModalities"],C);const I=d(n,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);const P=d(n,["routingConfig"]);P!=null&&p(e,["routingConfig"],P);const k=d(n,["seed"]);k!=null&&p(e,["seed"],k);const V=d(n,["speechConfig"]);V!=null&&p(e,["speechConfig"],Ig(V));const q=d(n,["stopSequences"]);q!=null&&p(e,["stopSequences"],q);const D=d(n,["temperature"]);D!=null&&p(e,["temperature"],D);const R=d(n,["thinkingConfig"]);R!=null&&p(e,["thinkingConfig"],R);const z=d(n,["topK"]);z!=null&&p(e,["topK"],z);const F=d(n,["topP"]);if(F!=null&&p(e,["topP"],F),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function qw(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=d(n,["enableWidget"]);return i!=null&&p(e,["enableWidget"],i),e}function kw(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=d(n,["timeRangeFilter"]);return i!=null&&p(e,["timeRangeFilter"],i),e}function Lw(n,e){const i={},s=d(n,["generationConfig"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig"],s);const r=d(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const c=d(n,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const f=d(n,["topP"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topP"],f);const h=d(n,["topK"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","topK"],h);const y=d(n,["maxOutputTokens"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","maxOutputTokens"],y);const m=d(n,["mediaResolution"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","mediaResolution"],m);const v=d(n,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=d(n,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],Fu(b));const S=d(n,["thinkingConfig"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","thinkingConfig"],S);const w=d(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],w);const C=d(n,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],Mw(Ct(C)));const I=d(n,["tools"]);if(e!==void 0&&I!=null){let z=Yi(I);Array.isArray(z)&&(z=z.map(F=>Qw(Fi(F)))),p(e,["setup","tools"],z)}const P=d(n,["sessionResumption"]);e!==void 0&&P!=null&&p(e,["setup","sessionResumption"],Jw(P));const k=d(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],k);const V=d(n,["outputAudioTranscription"]);e!==void 0&&V!=null&&p(e,["setup","outputAudioTranscription"],V);const q=d(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&p(e,["setup","realtimeInputConfig"],q);const D=d(n,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],D);const R=d(n,["proactivity"]);return e!==void 0&&R!=null&&p(e,["setup","proactivity"],R),i}function jw(n,e){const i={},s=d(n,["generationConfig"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig"],Pw(s));const r=d(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const c=d(n,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const f=d(n,["topP"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topP"],f);const h=d(n,["topK"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","topK"],h);const y=d(n,["maxOutputTokens"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","maxOutputTokens"],y);const m=d(n,["mediaResolution"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","mediaResolution"],m);const v=d(n,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=d(n,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],Ig(Fu(b)));const S=d(n,["thinkingConfig"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","thinkingConfig"],S);const w=d(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],w);const C=d(n,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],Ct(C));const I=d(n,["tools"]);if(e!==void 0&&I!=null){let z=Yi(I);Array.isArray(z)&&(z=z.map(F=>$w(Fi(F)))),p(e,["setup","tools"],z)}const P=d(n,["sessionResumption"]);e!==void 0&&P!=null&&p(e,["setup","sessionResumption"],P);const k=d(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],k);const V=d(n,["outputAudioTranscription"]);e!==void 0&&V!=null&&p(e,["setup","outputAudioTranscription"],V);const q=d(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&p(e,["setup","realtimeInputConfig"],q);const D=d(n,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],D);const R=d(n,["proactivity"]);return e!==void 0&&R!=null&&p(e,["setup","proactivity"],R),i}function Vw(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["setup","model"],He(n,s));const r=d(e,["config"]);return r!=null&&p(i,["config"],Lw(r,i)),i}function Bw(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["setup","model"],He(n,s));const r=d(e,["config"]);return r!=null&&p(i,["config"],jw(r,i)),i}function Gw(n){const e={},i=d(n,["musicGenerationConfig"]);return i!=null&&p(e,["musicGenerationConfig"],i),e}function Hw(n){const e={},i=d(n,["weightedPrompts"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),p(e,["weightedPrompts"],s)}return e}function zw(n){const e={},i=d(n,["media"]);if(i!=null){let m=gg(i);Array.isArray(m)&&(m=m.map(v=>Sr(v))),p(e,["mediaChunks"],m)}const s=d(n,["audio"]);s!=null&&p(e,["audio"],Sr(xg(s)));const r=d(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);const c=d(n,["video"]);c!=null&&p(e,["video"],Sr(yg(c)));const f=d(n,["text"]);f!=null&&p(e,["text"],f);const h=d(n,["activityStart"]);h!=null&&p(e,["activityStart"],h);const y=d(n,["activityEnd"]);return y!=null&&p(e,["activityEnd"],y),e}function Ow(n){const e={},i=d(n,["media"]);if(i!=null){let m=gg(i);Array.isArray(m)&&(m=m.map(v=>v)),p(e,["mediaChunks"],m)}const s=d(n,["audio"]);s!=null&&p(e,["audio"],xg(s));const r=d(n,["audioStreamEnd"]);r!=null&&p(e,["audioStreamEnd"],r);const c=d(n,["video"]);c!=null&&p(e,["video"],yg(c));const f=d(n,["text"]);f!=null&&p(e,["text"],f);const h=d(n,["activityStart"]);h!=null&&p(e,["activityStart"],h);const y=d(n,["activityEnd"]);return y!=null&&p(e,["activityEnd"],y),e}function Fw(n){const e={},i=d(n,["setupComplete"]);i!=null&&p(e,["setupComplete"],i);const s=d(n,["serverContent"]);s!=null&&p(e,["serverContent"],s);const r=d(n,["toolCall"]);r!=null&&p(e,["toolCall"],r);const c=d(n,["toolCallCancellation"]);c!=null&&p(e,["toolCallCancellation"],c);const f=d(n,["usageMetadata"]);f!=null&&p(e,["usageMetadata"],Kw(f));const h=d(n,["goAway"]);h!=null&&p(e,["goAway"],h);const y=d(n,["sessionResumptionUpdate"]);return y!=null&&p(e,["sessionResumptionUpdate"],y),e}function Yw(n){const e={},i=d(n,["functionCall"]);i!=null&&p(e,["functionCall"],i);const s=d(n,["codeExecutionResult"]);s!=null&&p(e,["codeExecutionResult"],s);const r=d(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);const c=d(n,["fileData"]);c!=null&&p(e,["fileData"],Rw(c));const f=d(n,["functionResponse"]);f!=null&&p(e,["functionResponse"],f);const h=d(n,["inlineData"]);h!=null&&p(e,["inlineData"],Sr(h));const y=d(n,["text"]);y!=null&&p(e,["text"],y);const m=d(n,["thought"]);m!=null&&p(e,["thought"],m);const v=d(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const b=d(n,["videoMetadata"]);return b!=null&&p(e,["videoMetadata"],b),e}function Jw(n){const e={},i=d(n,["handle"]);if(i!=null&&p(e,["handle"],i),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ig(n){const e={},i=d(n,["languageCode"]);i!=null&&p(e,["languageCode"],i);const s=d(n,["voiceConfig"]);if(s!=null&&p(e,["voiceConfig"],s),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Qw(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=d(n,["googleSearchRetrieval"]);s!=null&&p(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);r!=null&&p(e,["computerUse"],r);const c=d(n,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const f=d(n,["codeExecution"]);if(f!=null&&p(e,["codeExecution"],f),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const h=d(n,["googleMaps"]);h!=null&&p(e,["googleMaps"],qw(h));const y=d(n,["googleSearch"]);y!=null&&p(e,["googleSearch"],kw(y));const m=d(n,["urlContext"]);return m!=null&&p(e,["urlContext"],m),e}function $w(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let b=i;Array.isArray(b)&&(b=b.map(S=>Uw(S))),p(e,["functionDeclarations"],b)}const s=d(n,["retrieval"]);s!=null&&p(e,["retrieval"],s);const r=d(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const c=d(n,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=d(n,["codeExecution"]);f!=null&&p(e,["codeExecution"],f);const h=d(n,["enterpriseWebSearch"]);h!=null&&p(e,["enterpriseWebSearch"],h);const y=d(n,["googleMaps"]);y!=null&&p(e,["googleMaps"],y);const m=d(n,["googleSearch"]);m!=null&&p(e,["googleSearch"],m);const v=d(n,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function Kw(n){const e={},i=d(n,["promptTokenCount"]);i!=null&&p(e,["promptTokenCount"],i);const s=d(n,["cachedContentTokenCount"]);s!=null&&p(e,["cachedContentTokenCount"],s);const r=d(n,["candidatesTokenCount"]);r!=null&&p(e,["responseTokenCount"],r);const c=d(n,["toolUsePromptTokenCount"]);c!=null&&p(e,["toolUsePromptTokenCount"],c);const f=d(n,["thoughtsTokenCount"]);f!=null&&p(e,["thoughtsTokenCount"],f);const h=d(n,["totalTokenCount"]);h!=null&&p(e,["totalTokenCount"],h);const y=d(n,["promptTokensDetails"]);if(y!=null){let w=y;Array.isArray(w)&&(w=w.map(C=>C)),p(e,["promptTokensDetails"],w)}const m=d(n,["cacheTokensDetails"]);if(m!=null){let w=m;Array.isArray(w)&&(w=w.map(C=>C)),p(e,["cacheTokensDetails"],w)}const v=d(n,["candidatesTokensDetails"]);if(v!=null){let w=v;Array.isArray(w)&&(w=w.map(C=>C)),p(e,["responseTokensDetails"],w)}const b=d(n,["toolUsePromptTokensDetails"]);if(b!=null){let w=b;Array.isArray(w)&&(w=w.map(C=>C)),p(e,["toolUsePromptTokensDetails"],w)}const S=d(n,["trafficType"]);return S!=null&&p(e,["trafficType"],S),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xw(n){const e={},i=d(n,["data"]);if(i!=null&&p(e,["data"],i),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function Zw(n){const e={},i=d(n,["content"]);i!=null&&p(e,["content"],i);const s=d(n,["citationMetadata"]);s!=null&&p(e,["citationMetadata"],Ww(s));const r=d(n,["tokenCount"]);r!=null&&p(e,["tokenCount"],r);const c=d(n,["finishReason"]);c!=null&&p(e,["finishReason"],c);const f=d(n,["avgLogprobs"]);f!=null&&p(e,["avgLogprobs"],f);const h=d(n,["groundingMetadata"]);h!=null&&p(e,["groundingMetadata"],h);const y=d(n,["index"]);y!=null&&p(e,["index"],y);const m=d(n,["logprobsResult"]);m!=null&&p(e,["logprobsResult"],m);const v=d(n,["safetyRatings"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(w=>w)),p(e,["safetyRatings"],S)}const b=d(n,["urlContextMetadata"]);return b!=null&&p(e,["urlContextMetadata"],b),e}function Ww(n){const e={},i=d(n,["citationSources"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),p(e,["citations"],s)}return e}function eE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let c=un(r);Array.isArray(c)&&(c=c.map(f=>f)),p(i,["contents"],c)}return i}function tE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["tokensInfo"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(c=>c)),p(e,["tokensInfo"],r)}return e}function nE(n){const e={},i=d(n,["values"]);i!=null&&p(e,["values"],i);const s=d(n,["statistics"]);return s!=null&&p(e,["statistics"],aE(s)),e}function aE(n){const e={},i=d(n,["truncated"]);i!=null&&p(e,["truncated"],i);const s=d(n,["token_count"]);return s!=null&&p(e,["tokenCount"],s),e}function Pr(n){const e={},i=d(n,["parts"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(c=>lT(c))),p(e,["parts"],r)}const s=d(n,["role"]);return s!=null&&p(e,["role"],s),e}function iE(n){const e={},i=d(n,["controlType"]);i!=null&&p(e,["controlType"],i);const s=d(n,["enableControlImageComputation"]);return s!=null&&p(e,["computeControl"],s),e}function sE(n){const e={};if(d(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function oE(n,e){const i={},s=d(n,["systemInstruction"]);e!==void 0&&s!=null&&p(e,["systemInstruction"],Ct(s));const r=d(n,["tools"]);if(e!==void 0&&r!=null){let f=r;Array.isArray(f)&&(f=f.map(h=>Pg(h))),p(e,["tools"],f)}const c=d(n,["generationConfig"]);return e!==void 0&&c!=null&&p(e,["generationConfig"],$E(c)),i}function rE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let f=un(r);Array.isArray(f)&&(f=f.map(h=>Pr(h))),p(i,["contents"],f)}const c=d(e,["config"]);return c!=null&&sE(c),i}function lE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let f=un(r);Array.isArray(f)&&(f=f.map(h=>h)),p(i,["contents"],f)}const c=d(e,["config"]);return c!=null&&oE(c,i),i}function cE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["totalTokens"]);s!=null&&p(e,["totalTokens"],s);const r=d(n,["cachedContentTokenCount"]);return r!=null&&p(e,["cachedContentTokenCount"],r),e}function uE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["totalTokens"]);return s!=null&&p(e,["totalTokens"],s),e}function dE(n,e){const i={},s=d(e,["model"]);return s!=null&&p(i,["_url","name"],He(n,s)),i}function fE(n,e){const i={},s=d(e,["model"]);return s!=null&&p(i,["_url","name"],He(n,s)),i}function pE(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function mE(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}function hE(n,e){const i={},s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&p(e,["parameters","storageUri"],s);const r=d(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);const c=d(n,["numberOfImages"]);e!==void 0&&c!=null&&p(e,["parameters","sampleCount"],c);const f=d(n,["aspectRatio"]);e!==void 0&&f!=null&&p(e,["parameters","aspectRatio"],f);const h=d(n,["guidanceScale"]);e!==void 0&&h!=null&&p(e,["parameters","guidanceScale"],h);const y=d(n,["seed"]);e!==void 0&&y!=null&&p(e,["parameters","seed"],y);const m=d(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&p(e,["parameters","safetySetting"],m);const v=d(n,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=d(n,["includeSafetyAttributes"]);e!==void 0&&b!=null&&p(e,["parameters","includeSafetyAttributes"],b);const S=d(n,["includeRaiReason"]);e!==void 0&&S!=null&&p(e,["parameters","includeRaiReason"],S);const w=d(n,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const C=d(n,["outputMimeType"]);e!==void 0&&C!=null&&p(e,["parameters","outputOptions","mimeType"],C);const I=d(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);const P=d(n,["addWatermark"]);e!==void 0&&P!=null&&p(e,["parameters","addWatermark"],P);const k=d(n,["labels"]);e!==void 0&&k!=null&&p(e,["labels"],k);const V=d(n,["editMode"]);e!==void 0&&V!=null&&p(e,["parameters","editMode"],V);const q=d(n,["baseSteps"]);return e!==void 0&&q!=null&&p(e,["parameters","editConfig","baseSteps"],q),i}function gE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["prompt"]);r!=null&&p(i,["instances[0]","prompt"],r);const c=d(e,["referenceImages"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(y=>mT(y))),p(i,["instances[0]","referenceImages"],h)}const f=d(e,["config"]);return f!=null&&hE(f,i),i}function yE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(c=>qr(c))),p(e,["generatedImages"],r)}return e}function xE(n,e){const i={},s=d(n,["taskType"]);e!==void 0&&s!=null&&p(e,["requests[]","taskType"],s);const r=d(n,["title"]);e!==void 0&&r!=null&&p(e,["requests[]","title"],r);const c=d(n,["outputDimensionality"]);if(e!==void 0&&c!=null&&p(e,["requests[]","outputDimensionality"],c),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function vE(n,e){const i={},s=d(n,["taskType"]);e!==void 0&&s!=null&&p(e,["instances[]","task_type"],s);const r=d(n,["title"]);e!==void 0&&r!=null&&p(e,["instances[]","title"],r);const c=d(n,["outputDimensionality"]);e!==void 0&&c!=null&&p(e,["parameters","outputDimensionality"],c);const f=d(n,["mimeType"]);e!==void 0&&f!=null&&p(e,["instances[]","mimeType"],f);const h=d(n,["autoTruncate"]);return e!==void 0&&h!=null&&p(e,["parameters","autoTruncate"],h),i}function bE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let h=Hu(n,r);Array.isArray(h)&&(h=h.map(y=>y)),p(i,["requests[]","content"],h)}const c=d(e,["config"]);c!=null&&xE(c,i);const f=d(e,["model"]);return f!==void 0&&p(i,["requests[]","model"],He(n,f)),i}function SE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let f=Hu(n,r);Array.isArray(f)&&(f=f.map(h=>h)),p(i,["instances[]","content"],f)}const c=d(e,["config"]);return c!=null&&vE(c,i),i}function NE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["embeddings"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["embeddings"],c)}const r=d(n,["metadata"]);return r!=null&&p(e,["metadata"],r),e}function wE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["predictions[]","embeddings"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>nE(f))),p(e,["embeddings"],c)}const r=d(n,["metadata"]);return r!=null&&p(e,["metadata"],r),e}function EE(n){const e={},i=d(n,["endpoint"]);i!=null&&p(e,["name"],i);const s=d(n,["deployedModelId"]);return s!=null&&p(e,["deployedModelId"],s),e}function TE(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function CE(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const i=d(n,["description"]);i!=null&&p(e,["description"],i);const s=d(n,["name"]);s!=null&&p(e,["name"],s);const r=d(n,["parameters"]);r!=null&&p(e,["parameters"],r);const c=d(n,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const f=d(n,["response"]);f!=null&&p(e,["response"],f);const h=d(n,["responseJsonSchema"]);return h!=null&&p(e,["responseJsonSchema"],h),e}function _E(n,e,i){const s={},r=d(e,["systemInstruction"]);i!==void 0&&r!=null&&p(i,["systemInstruction"],Pr(Ct(r)));const c=d(e,["temperature"]);c!=null&&p(s,["temperature"],c);const f=d(e,["topP"]);f!=null&&p(s,["topP"],f);const h=d(e,["topK"]);h!=null&&p(s,["topK"],h);const y=d(e,["candidateCount"]);y!=null&&p(s,["candidateCount"],y);const m=d(e,["maxOutputTokens"]);m!=null&&p(s,["maxOutputTokens"],m);const v=d(e,["stopSequences"]);v!=null&&p(s,["stopSequences"],v);const b=d(e,["responseLogprobs"]);b!=null&&p(s,["responseLogprobs"],b);const S=d(e,["logprobs"]);S!=null&&p(s,["logprobs"],S);const w=d(e,["presencePenalty"]);w!=null&&p(s,["presencePenalty"],w);const C=d(e,["frequencyPenalty"]);C!=null&&p(s,["frequencyPenalty"],C);const I=d(e,["seed"]);I!=null&&p(s,["seed"],I);const P=d(e,["responseMimeType"]);P!=null&&p(s,["responseMimeType"],P);const k=d(e,["responseSchema"]);k!=null&&p(s,["responseSchema"],zu(k));const V=d(e,["responseJsonSchema"]);if(V!=null&&p(s,["responseJsonSchema"],V),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=d(e,["safetySettings"]);if(i!==void 0&&q!=null){let ue=q;Array.isArray(ue)&&(ue=ue.map(Ne=>hT(Ne))),p(i,["safetySettings"],ue)}const D=d(e,["tools"]);if(i!==void 0&&D!=null){let ue=Yi(D);Array.isArray(ue)&&(ue=ue.map(Ne=>ST(Fi(Ne)))),p(i,["tools"],ue)}const R=d(e,["toolConfig"]);if(i!==void 0&&R!=null&&p(i,["toolConfig"],R),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=d(e,["cachedContent"]);i!==void 0&&z!=null&&p(i,["cachedContent"],Xn(n,z));const F=d(e,["responseModalities"]);F!=null&&p(s,["responseModalities"],F);const ie=d(e,["mediaResolution"]);ie!=null&&p(s,["mediaResolution"],ie);const K=d(e,["speechConfig"]);if(K!=null&&p(s,["speechConfig"],Ou(K)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Y=d(e,["thinkingConfig"]);Y!=null&&p(s,["thinkingConfig"],Y);const fe=d(e,["imageConfig"]);return fe!=null&&p(s,["imageConfig"],fe),s}function AE(n,e,i){const s={},r=d(e,["systemInstruction"]);i!==void 0&&r!=null&&p(i,["systemInstruction"],Ct(r));const c=d(e,["temperature"]);c!=null&&p(s,["temperature"],c);const f=d(e,["topP"]);f!=null&&p(s,["topP"],f);const h=d(e,["topK"]);h!=null&&p(s,["topK"],h);const y=d(e,["candidateCount"]);y!=null&&p(s,["candidateCount"],y);const m=d(e,["maxOutputTokens"]);m!=null&&p(s,["maxOutputTokens"],m);const v=d(e,["stopSequences"]);v!=null&&p(s,["stopSequences"],v);const b=d(e,["responseLogprobs"]);b!=null&&p(s,["responseLogprobs"],b);const S=d(e,["logprobs"]);S!=null&&p(s,["logprobs"],S);const w=d(e,["presencePenalty"]);w!=null&&p(s,["presencePenalty"],w);const C=d(e,["frequencyPenalty"]);C!=null&&p(s,["frequencyPenalty"],C);const I=d(e,["seed"]);I!=null&&p(s,["seed"],I);const P=d(e,["responseMimeType"]);P!=null&&p(s,["responseMimeType"],P);const k=d(e,["responseSchema"]);k!=null&&p(s,["responseSchema"],zu(k));const V=d(e,["responseJsonSchema"]);V!=null&&p(s,["responseJsonSchema"],V);const q=d(e,["routingConfig"]);q!=null&&p(s,["routingConfig"],q);const D=d(e,["modelSelectionConfig"]);D!=null&&p(s,["modelConfig"],D);const R=d(e,["safetySettings"]);if(i!==void 0&&R!=null){let A=R;Array.isArray(A)&&(A=A.map(B=>B)),p(i,["safetySettings"],A)}const z=d(e,["tools"]);if(i!==void 0&&z!=null){let A=Yi(z);Array.isArray(A)&&(A=A.map(B=>Pg(Fi(B)))),p(i,["tools"],A)}const F=d(e,["toolConfig"]);i!==void 0&&F!=null&&p(i,["toolConfig"],F);const ie=d(e,["labels"]);i!==void 0&&ie!=null&&p(i,["labels"],ie);const K=d(e,["cachedContent"]);i!==void 0&&K!=null&&p(i,["cachedContent"],Xn(n,K));const Y=d(e,["responseModalities"]);Y!=null&&p(s,["responseModalities"],Y);const fe=d(e,["mediaResolution"]);fe!=null&&p(s,["mediaResolution"],fe);const ue=d(e,["speechConfig"]);ue!=null&&p(s,["speechConfig"],Ug(Ou(ue)));const Ne=d(e,["audioTimestamp"]);Ne!=null&&p(s,["audioTimestamp"],Ne);const we=d(e,["thinkingConfig"]);we!=null&&p(s,["thinkingConfig"],we);const Re=d(e,["imageConfig"]);return Re!=null&&p(s,["imageConfig"],Re),s}function R0(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let f=un(r);Array.isArray(f)&&(f=f.map(h=>Pr(h))),p(i,["contents"],f)}const c=d(e,["config"]);return c!=null&&p(i,["generationConfig"],_E(n,c,i)),i}function U0(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["contents"]);if(r!=null){let f=un(r);Array.isArray(f)&&(f=f.map(h=>h)),p(i,["contents"],f)}const c=d(e,["config"]);return c!=null&&p(i,["generationConfig"],AE(n,c,i)),i}function P0(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["candidates"]);if(s!=null){let y=s;Array.isArray(y)&&(y=y.map(m=>Zw(m))),p(e,["candidates"],y)}const r=d(n,["modelVersion"]);r!=null&&p(e,["modelVersion"],r);const c=d(n,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const f=d(n,["responseId"]);f!=null&&p(e,["responseId"],f);const h=d(n,["usageMetadata"]);return h!=null&&p(e,["usageMetadata"],h),e}function q0(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["candidates"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),p(e,["candidates"],m)}const r=d(n,["createTime"]);r!=null&&p(e,["createTime"],r);const c=d(n,["modelVersion"]);c!=null&&p(e,["modelVersion"],c);const f=d(n,["promptFeedback"]);f!=null&&p(e,["promptFeedback"],f);const h=d(n,["responseId"]);h!=null&&p(e,["responseId"],h);const y=d(n,["usageMetadata"]);return y!=null&&p(e,["usageMetadata"],y),e}function IE(n,e){const i={};if(d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=d(n,["numberOfImages"]);e!==void 0&&s!=null&&p(e,["parameters","sampleCount"],s);const r=d(n,["aspectRatio"]);e!==void 0&&r!=null&&p(e,["parameters","aspectRatio"],r);const c=d(n,["guidanceScale"]);if(e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const f=d(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&p(e,["parameters","safetySetting"],f);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&p(e,["parameters","personGeneration"],h);const y=d(n,["includeSafetyAttributes"]);e!==void 0&&y!=null&&p(e,["parameters","includeSafetyAttributes"],y);const m=d(n,["includeRaiReason"]);e!==void 0&&m!=null&&p(e,["parameters","includeRaiReason"],m);const v=d(n,["language"]);e!==void 0&&v!=null&&p(e,["parameters","language"],v);const b=d(n,["outputMimeType"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","mimeType"],b);const S=d(n,["outputCompressionQuality"]);if(e!==void 0&&S!=null&&p(e,["parameters","outputOptions","compressionQuality"],S),d(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=d(n,["imageSize"]);if(e!==void 0&&w!=null&&p(e,["parameters","sampleImageSize"],w),d(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function DE(n,e){const i={},s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&p(e,["parameters","storageUri"],s);const r=d(n,["negativePrompt"]);e!==void 0&&r!=null&&p(e,["parameters","negativePrompt"],r);const c=d(n,["numberOfImages"]);e!==void 0&&c!=null&&p(e,["parameters","sampleCount"],c);const f=d(n,["aspectRatio"]);e!==void 0&&f!=null&&p(e,["parameters","aspectRatio"],f);const h=d(n,["guidanceScale"]);e!==void 0&&h!=null&&p(e,["parameters","guidanceScale"],h);const y=d(n,["seed"]);e!==void 0&&y!=null&&p(e,["parameters","seed"],y);const m=d(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&p(e,["parameters","safetySetting"],m);const v=d(n,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=d(n,["includeSafetyAttributes"]);e!==void 0&&b!=null&&p(e,["parameters","includeSafetyAttributes"],b);const S=d(n,["includeRaiReason"]);e!==void 0&&S!=null&&p(e,["parameters","includeRaiReason"],S);const w=d(n,["language"]);e!==void 0&&w!=null&&p(e,["parameters","language"],w);const C=d(n,["outputMimeType"]);e!==void 0&&C!=null&&p(e,["parameters","outputOptions","mimeType"],C);const I=d(n,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);const P=d(n,["addWatermark"]);e!==void 0&&P!=null&&p(e,["parameters","addWatermark"],P);const k=d(n,["labels"]);e!==void 0&&k!=null&&p(e,["labels"],k);const V=d(n,["imageSize"]);e!==void 0&&V!=null&&p(e,["parameters","sampleImageSize"],V);const q=d(n,["enhancePrompt"]);return e!==void 0&&q!=null&&p(e,["parameters","enhancePrompt"],q),i}function ME(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["prompt"]);r!=null&&p(i,["instances[0]","prompt"],r);const c=d(e,["config"]);return c!=null&&IE(c,i),i}function RE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["prompt"]);r!=null&&p(i,["instances[0]","prompt"],r);const c=d(e,["config"]);return c!=null&&DE(c,i),i}function UE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["predictions"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>FE(f))),p(e,["generatedImages"],c)}const r=d(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],Mg(r)),e}function PE(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["predictions"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>qr(f))),p(e,["generatedImages"],c)}const r=d(n,["positivePromptSafetyAttributes"]);return r!=null&&p(e,["positivePromptSafetyAttributes"],Rg(r)),e}function qE(n,e){const i={},s=d(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&p(e,["parameters","sampleCount"],s),d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=d(n,["durationSeconds"]);if(e!==void 0&&r!=null&&p(e,["parameters","durationSeconds"],r),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=d(n,["aspectRatio"]);e!==void 0&&c!=null&&p(e,["parameters","aspectRatio"],c);const f=d(n,["resolution"]);e!==void 0&&f!=null&&p(e,["parameters","resolution"],f);const h=d(n,["personGeneration"]);if(e!==void 0&&h!=null&&p(e,["parameters","personGeneration"],h),d(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const y=d(n,["negativePrompt"]);e!==void 0&&y!=null&&p(e,["parameters","negativePrompt"],y);const m=d(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&p(e,["parameters","enhancePrompt"],m),d(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=d(n,["lastFrame"]);e!==void 0&&v!=null&&p(e,["instances[0]","lastFrame"],kr(v));const b=d(n,["referenceImages"]);if(e!==void 0&&b!=null){let S=b;Array.isArray(S)&&(S=S.map(w=>PT(w))),p(e,["instances[0]","referenceImages"],S)}if(d(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return i}function kE(n,e){const i={},s=d(n,["numberOfVideos"]);e!==void 0&&s!=null&&p(e,["parameters","sampleCount"],s);const r=d(n,["outputGcsUri"]);e!==void 0&&r!=null&&p(e,["parameters","storageUri"],r);const c=d(n,["fps"]);e!==void 0&&c!=null&&p(e,["parameters","fps"],c);const f=d(n,["durationSeconds"]);e!==void 0&&f!=null&&p(e,["parameters","durationSeconds"],f);const h=d(n,["seed"]);e!==void 0&&h!=null&&p(e,["parameters","seed"],h);const y=d(n,["aspectRatio"]);e!==void 0&&y!=null&&p(e,["parameters","aspectRatio"],y);const m=d(n,["resolution"]);e!==void 0&&m!=null&&p(e,["parameters","resolution"],m);const v=d(n,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=d(n,["pubsubTopic"]);e!==void 0&&b!=null&&p(e,["parameters","pubsubTopic"],b);const S=d(n,["negativePrompt"]);e!==void 0&&S!=null&&p(e,["parameters","negativePrompt"],S);const w=d(n,["enhancePrompt"]);e!==void 0&&w!=null&&p(e,["parameters","enhancePrompt"],w);const C=d(n,["generateAudio"]);e!==void 0&&C!=null&&p(e,["parameters","generateAudio"],C);const I=d(n,["lastFrame"]);e!==void 0&&I!=null&&p(e,["instances[0]","lastFrame"],xn(I));const P=d(n,["referenceImages"]);if(e!==void 0&&P!=null){let q=P;Array.isArray(q)&&(q=q.map(D=>qT(D))),p(e,["instances[0]","referenceImages"],q)}const k=d(n,["mask"]);e!==void 0&&k!=null&&p(e,["instances[0]","mask"],UT(k));const V=d(n,["compressionQuality"]);return e!==void 0&&V!=null&&p(e,["parameters","compressionQuality"],V),i}function LE(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response","generateVideoResponse"]);return f!=null&&p(e,["response"],GE(f)),e}function jE(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response"]);return f!=null&&p(e,["response"],HE(f)),e}function VE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["prompt"]);r!=null&&p(i,["instances[0]","prompt"],r);const c=d(e,["image"]);c!=null&&p(i,["instances[0]","image"],kr(c));const f=d(e,["video"]);f!=null&&p(i,["instances[0]","video"],qg(f));const h=d(e,["source"]);h!=null&&zE(h,i);const y=d(e,["config"]);return y!=null&&qE(y,i),i}function BE(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["prompt"]);r!=null&&p(i,["instances[0]","prompt"],r);const c=d(e,["image"]);c!=null&&p(i,["instances[0]","image"],xn(c));const f=d(e,["video"]);f!=null&&p(i,["instances[0]","video"],kg(f));const h=d(e,["source"]);h!=null&&OE(h,i);const y=d(e,["config"]);return y!=null&&kE(y,i),i}function GE(n){const e={},i=d(n,["generatedSamples"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>JE(f))),p(e,["generatedVideos"],c)}const s=d(n,["raiMediaFilteredCount"]);s!=null&&p(e,["raiMediaFilteredCount"],s);const r=d(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function HE(n){const e={},i=d(n,["videos"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(f=>QE(f))),p(e,["generatedVideos"],c)}const s=d(n,["raiMediaFilteredCount"]);s!=null&&p(e,["raiMediaFilteredCount"],s);const r=d(n,["raiMediaFilteredReasons"]);return r!=null&&p(e,["raiMediaFilteredReasons"],r),e}function zE(n,e){const i={},s=d(n,["prompt"]);e!==void 0&&s!=null&&p(e,["instances[0]","prompt"],s);const r=d(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],kr(r));const c=d(n,["video"]);return e!==void 0&&c!=null&&p(e,["instances[0]","video"],qg(c)),i}function OE(n,e){const i={},s=d(n,["prompt"]);e!==void 0&&s!=null&&p(e,["instances[0]","prompt"],s);const r=d(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],xn(r));const c=d(n,["video"]);return e!==void 0&&c!=null&&p(e,["instances[0]","video"],kg(c)),i}function FE(n){const e={},i=d(n,["_self"]);i!=null&&p(e,["image"],eT(i));const s=d(n,["raiFilteredReason"]);s!=null&&p(e,["raiFilteredReason"],s);const r=d(n,["_self"]);return r!=null&&p(e,["safetyAttributes"],Mg(r)),e}function qr(n){const e={},i=d(n,["_self"]);i!=null&&p(e,["image"],Dg(i));const s=d(n,["raiFilteredReason"]);s!=null&&p(e,["raiFilteredReason"],s);const r=d(n,["_self"]);r!=null&&p(e,["safetyAttributes"],Rg(r));const c=d(n,["prompt"]);return c!=null&&p(e,["enhancedPrompt"],c),e}function YE(n){const e={},i=d(n,["_self"]);i!=null&&p(e,["mask"],Dg(i));const s=d(n,["labels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(c=>c)),p(e,["labels"],r)}return e}function JE(n){const e={},i=d(n,["video"]);return i!=null&&p(e,["video"],MT(i)),e}function QE(n){const e={},i=d(n,["_self"]);return i!=null&&p(e,["video"],RT(i)),e}function $E(n){const e={},i=d(n,["modelSelectionConfig"]);i!=null&&p(e,["modelConfig"],i);const s=d(n,["responseJsonSchema"]);s!=null&&p(e,["responseJsonSchema"],s);const r=d(n,["audioTimestamp"]);r!=null&&p(e,["audioTimestamp"],r);const c=d(n,["candidateCount"]);c!=null&&p(e,["candidateCount"],c);const f=d(n,["enableAffectiveDialog"]);f!=null&&p(e,["enableAffectiveDialog"],f);const h=d(n,["frequencyPenalty"]);h!=null&&p(e,["frequencyPenalty"],h);const y=d(n,["logprobs"]);y!=null&&p(e,["logprobs"],y);const m=d(n,["maxOutputTokens"]);m!=null&&p(e,["maxOutputTokens"],m);const v=d(n,["mediaResolution"]);v!=null&&p(e,["mediaResolution"],v);const b=d(n,["presencePenalty"]);b!=null&&p(e,["presencePenalty"],b);const S=d(n,["responseLogprobs"]);S!=null&&p(e,["responseLogprobs"],S);const w=d(n,["responseMimeType"]);w!=null&&p(e,["responseMimeType"],w);const C=d(n,["responseModalities"]);C!=null&&p(e,["responseModalities"],C);const I=d(n,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);const P=d(n,["routingConfig"]);P!=null&&p(e,["routingConfig"],P);const k=d(n,["seed"]);k!=null&&p(e,["seed"],k);const V=d(n,["speechConfig"]);V!=null&&p(e,["speechConfig"],Ug(V));const q=d(n,["stopSequences"]);q!=null&&p(e,["stopSequences"],q);const D=d(n,["temperature"]);D!=null&&p(e,["temperature"],D);const R=d(n,["thinkingConfig"]);R!=null&&p(e,["thinkingConfig"],R);const z=d(n,["topK"]);z!=null&&p(e,["topK"],z);const F=d(n,["topP"]);if(F!=null&&p(e,["topP"],F),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function KE(n,e){const i={},s=d(e,["model"]);return s!=null&&p(i,["_url","name"],He(n,s)),i}function XE(n,e){const i={},s=d(e,["model"]);return s!=null&&p(i,["_url","name"],He(n,s)),i}function ZE(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=d(n,["enableWidget"]);return i!=null&&p(e,["enableWidget"],i),e}function WE(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=d(n,["timeRangeFilter"]);return i!=null&&p(e,["timeRangeFilter"],i),e}function eT(n){const e={},i=d(n,["bytesBase64Encoded"]);i!=null&&p(e,["imageBytes"],Ca(i));const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function Dg(n){const e={},i=d(n,["gcsUri"]);i!=null&&p(e,["gcsUri"],i);const s=d(n,["bytesBase64Encoded"]);s!=null&&p(e,["imageBytes"],Ca(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function kr(n){const e={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=d(n,["imageBytes"]);i!=null&&p(e,["bytesBase64Encoded"],Ca(i));const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function xn(n){const e={},i=d(n,["gcsUri"]);i!=null&&p(e,["gcsUri"],i);const s=d(n,["imageBytes"]);s!=null&&p(e,["bytesBase64Encoded"],Ca(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function tT(n,e,i){const s={},r=d(e,["pageSize"]);i!==void 0&&r!=null&&p(i,["_query","pageSize"],r);const c=d(e,["pageToken"]);i!==void 0&&c!=null&&p(i,["_query","pageToken"],c);const f=d(e,["filter"]);i!==void 0&&f!=null&&p(i,["_query","filter"],f);const h=d(e,["queryBase"]);return i!==void 0&&h!=null&&p(i,["_url","models_url"],Ng(n,h)),s}function nT(n,e,i){const s={},r=d(e,["pageSize"]);i!==void 0&&r!=null&&p(i,["_query","pageSize"],r);const c=d(e,["pageToken"]);i!==void 0&&c!=null&&p(i,["_query","pageToken"],c);const f=d(e,["filter"]);i!==void 0&&f!=null&&p(i,["_query","filter"],f);const h=d(e,["queryBase"]);return i!==void 0&&h!=null&&p(i,["_url","models_url"],Ng(n,h)),s}function aT(n,e){const i={},s=d(e,["config"]);return s!=null&&tT(n,s,i),i}function iT(n,e){const i={},s=d(e,["config"]);return s!=null&&nT(n,s,i),i}function sT(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["_self"]);if(r!=null){let c=wg(r);Array.isArray(c)&&(c=c.map(f=>Eu(f))),p(e,["models"],c)}return e}function oT(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["_self"]);if(r!=null){let c=wg(r);Array.isArray(c)&&(c=c.map(f=>Tu(f))),p(e,["models"],c)}return e}function rT(n){const e={},i=d(n,["maskMode"]);i!=null&&p(e,["maskMode"],i);const s=d(n,["segmentationClasses"]);s!=null&&p(e,["maskClasses"],s);const r=d(n,["maskDilation"]);return r!=null&&p(e,["dilation"],r),e}function Eu(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["displayName"]);s!=null&&p(e,["displayName"],s);const r=d(n,["description"]);r!=null&&p(e,["description"],r);const c=d(n,["version"]);c!=null&&p(e,["version"],c);const f=d(n,["_self"]);f!=null&&p(e,["tunedModelInfo"],NT(f));const h=d(n,["inputTokenLimit"]);h!=null&&p(e,["inputTokenLimit"],h);const y=d(n,["outputTokenLimit"]);y!=null&&p(e,["outputTokenLimit"],y);const m=d(n,["supportedGenerationMethods"]);m!=null&&p(e,["supportedActions"],m);const v=d(n,["temperature"]);v!=null&&p(e,["temperature"],v);const b=d(n,["maxTemperature"]);b!=null&&p(e,["maxTemperature"],b);const S=d(n,["topP"]);S!=null&&p(e,["topP"],S);const w=d(n,["topK"]);w!=null&&p(e,["topK"],w);const C=d(n,["thinking"]);return C!=null&&p(e,["thinking"],C),e}function Tu(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["displayName"]);s!=null&&p(e,["displayName"],s);const r=d(n,["description"]);r!=null&&p(e,["description"],r);const c=d(n,["versionId"]);c!=null&&p(e,["version"],c);const f=d(n,["deployedModels"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(S=>EE(S))),p(e,["endpoints"],b)}const h=d(n,["labels"]);h!=null&&p(e,["labels"],h);const y=d(n,["_self"]);y!=null&&p(e,["tunedModelInfo"],wT(y));const m=d(n,["defaultCheckpointId"]);m!=null&&p(e,["defaultCheckpointId"],m);const v=d(n,["checkpoints"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(S=>S)),p(e,["checkpoints"],b)}return e}function lT(n){const e={},i=d(n,["functionCall"]);i!=null&&p(e,["functionCall"],i);const s=d(n,["codeExecutionResult"]);s!=null&&p(e,["codeExecutionResult"],s);const r=d(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);const c=d(n,["fileData"]);c!=null&&p(e,["fileData"],TE(c));const f=d(n,["functionResponse"]);f!=null&&p(e,["functionResponse"],f);const h=d(n,["inlineData"]);h!=null&&p(e,["inlineData"],Xw(h));const y=d(n,["text"]);y!=null&&p(e,["text"],y);const m=d(n,["thought"]);m!=null&&p(e,["thought"],m);const v=d(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const b=d(n,["videoMetadata"]);return b!=null&&p(e,["videoMetadata"],b),e}function cT(n){const e={},i=d(n,["productImage"]);return i!=null&&p(e,["image"],xn(i)),e}function uT(n,e){const i={},s=d(n,["numberOfImages"]);e!==void 0&&s!=null&&p(e,["parameters","sampleCount"],s);const r=d(n,["baseSteps"]);e!==void 0&&r!=null&&p(e,["parameters","baseSteps"],r);const c=d(n,["outputGcsUri"]);e!==void 0&&c!=null&&p(e,["parameters","storageUri"],c);const f=d(n,["seed"]);e!==void 0&&f!=null&&p(e,["parameters","seed"],f);const h=d(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&p(e,["parameters","safetySetting"],h);const y=d(n,["personGeneration"]);e!==void 0&&y!=null&&p(e,["parameters","personGeneration"],y);const m=d(n,["addWatermark"]);e!==void 0&&m!=null&&p(e,["parameters","addWatermark"],m);const v=d(n,["outputMimeType"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","mimeType"],v);const b=d(n,["outputCompressionQuality"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","compressionQuality"],b);const S=d(n,["enhancePrompt"]);e!==void 0&&S!=null&&p(e,["parameters","enhancePrompt"],S);const w=d(n,["labels"]);return e!==void 0&&w!=null&&p(e,["labels"],w),i}function dT(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["source"]);r!=null&&pT(r,i);const c=d(e,["config"]);return c!=null&&uT(c,i),i}function fT(n){const e={},i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>qr(r))),p(e,["generatedImages"],s)}return e}function pT(n,e){const i={},s=d(n,["prompt"]);e!==void 0&&s!=null&&p(e,["instances[0]","prompt"],s);const r=d(n,["personImage"]);e!==void 0&&r!=null&&p(e,["instances[0]","personImage","image"],xn(r));const c=d(n,["productImages"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(h=>cT(h))),p(e,["instances[0]","productImages"],f)}return i}function mT(n){const e={},i=d(n,["referenceImage"]);i!=null&&p(e,["referenceImage"],xn(i));const s=d(n,["referenceId"]);s!=null&&p(e,["referenceId"],s);const r=d(n,["referenceType"]);r!=null&&p(e,["referenceType"],r);const c=d(n,["maskImageConfig"]);c!=null&&p(e,["maskImageConfig"],rT(c));const f=d(n,["controlImageConfig"]);f!=null&&p(e,["controlImageConfig"],iE(f));const h=d(n,["styleImageConfig"]);h!=null&&p(e,["styleImageConfig"],h);const y=d(n,["subjectImageConfig"]);return y!=null&&p(e,["subjectImageConfig"],y),e}function Mg(n){const e={},i=d(n,["safetyAttributes","categories"]);i!=null&&p(e,["categories"],i);const s=d(n,["safetyAttributes","scores"]);s!=null&&p(e,["scores"],s);const r=d(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function Rg(n){const e={},i=d(n,["safetyAttributes","categories"]);i!=null&&p(e,["categories"],i);const s=d(n,["safetyAttributes","scores"]);s!=null&&p(e,["scores"],s);const r=d(n,["contentType"]);return r!=null&&p(e,["contentType"],r),e}function hT(n){const e={},i=d(n,["category"]);if(i!=null&&p(e,["category"],i),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=d(n,["threshold"]);return s!=null&&p(e,["threshold"],s),e}function gT(n){const e={},i=d(n,["image"]);return i!=null&&p(e,["image"],xn(i)),e}function yT(n,e){const i={},s=d(n,["mode"]);e!==void 0&&s!=null&&p(e,["parameters","mode"],s);const r=d(n,["maxPredictions"]);e!==void 0&&r!=null&&p(e,["parameters","maxPredictions"],r);const c=d(n,["confidenceThreshold"]);e!==void 0&&c!=null&&p(e,["parameters","confidenceThreshold"],c);const f=d(n,["maskDilation"]);e!==void 0&&f!=null&&p(e,["parameters","maskDilation"],f);const h=d(n,["binaryColorThreshold"]);e!==void 0&&h!=null&&p(e,["parameters","binaryColorThreshold"],h);const y=d(n,["labels"]);return e!==void 0&&y!=null&&p(e,["labels"],y),i}function xT(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["source"]);r!=null&&bT(r,i);const c=d(e,["config"]);return c!=null&&yT(c,i),i}function vT(n){const e={},i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>YE(r))),p(e,["generatedMasks"],s)}return e}function bT(n,e){const i={},s=d(n,["prompt"]);e!==void 0&&s!=null&&p(e,["instances[0]","prompt"],s);const r=d(n,["image"]);e!==void 0&&r!=null&&p(e,["instances[0]","image"],xn(r));const c=d(n,["scribbleImage"]);return e!==void 0&&c!=null&&p(e,["instances[0]","scribble"],gT(c)),i}function Ug(n){const e={},i=d(n,["languageCode"]);i!=null&&p(e,["languageCode"],i);const s=d(n,["voiceConfig"]);if(s!=null&&p(e,["voiceConfig"],s),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function ST(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=d(n,["googleSearchRetrieval"]);s!=null&&p(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);r!=null&&p(e,["computerUse"],r);const c=d(n,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const f=d(n,["codeExecution"]);if(f!=null&&p(e,["codeExecution"],f),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const h=d(n,["googleMaps"]);h!=null&&p(e,["googleMaps"],ZE(h));const y=d(n,["googleSearch"]);y!=null&&p(e,["googleSearch"],WE(y));const m=d(n,["urlContext"]);return m!=null&&p(e,["urlContext"],m),e}function Pg(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let b=i;Array.isArray(b)&&(b=b.map(S=>CE(S))),p(e,["functionDeclarations"],b)}const s=d(n,["retrieval"]);s!=null&&p(e,["retrieval"],s);const r=d(n,["googleSearchRetrieval"]);r!=null&&p(e,["googleSearchRetrieval"],r);const c=d(n,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const f=d(n,["codeExecution"]);f!=null&&p(e,["codeExecution"],f);const h=d(n,["enterpriseWebSearch"]);h!=null&&p(e,["enterpriseWebSearch"],h);const y=d(n,["googleMaps"]);y!=null&&p(e,["googleMaps"],y);const m=d(n,["googleSearch"]);m!=null&&p(e,["googleSearch"],m);const v=d(n,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function NT(n){const e={},i=d(n,["baseModel"]);i!=null&&p(e,["baseModel"],i);const s=d(n,["createTime"]);s!=null&&p(e,["createTime"],s);const r=d(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function wT(n){const e={},i=d(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&p(e,["baseModel"],i);const s=d(n,["createTime"]);s!=null&&p(e,["createTime"],s);const r=d(n,["updateTime"]);return r!=null&&p(e,["updateTime"],r),e}function ET(n,e){const i={},s=d(n,["displayName"]);e!==void 0&&s!=null&&p(e,["displayName"],s);const r=d(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);const c=d(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&p(e,["defaultCheckpointId"],c),i}function TT(n,e){const i={},s=d(n,["displayName"]);e!==void 0&&s!=null&&p(e,["displayName"],s);const r=d(n,["description"]);e!==void 0&&r!=null&&p(e,["description"],r);const c=d(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&p(e,["defaultCheckpointId"],c),i}function CT(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","name"],He(n,s));const r=d(e,["config"]);return r!=null&&ET(r,i),i}function _T(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["config"]);return r!=null&&TT(r,i),i}function AT(n,e){const i={},s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&p(e,["parameters","storageUri"],s);const r=d(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&p(e,["parameters","safetySetting"],r);const c=d(n,["personGeneration"]);e!==void 0&&c!=null&&p(e,["parameters","personGeneration"],c);const f=d(n,["includeRaiReason"]);e!==void 0&&f!=null&&p(e,["parameters","includeRaiReason"],f);const h=d(n,["outputMimeType"]);e!==void 0&&h!=null&&p(e,["parameters","outputOptions","mimeType"],h);const y=d(n,["outputCompressionQuality"]);e!==void 0&&y!=null&&p(e,["parameters","outputOptions","compressionQuality"],y);const m=d(n,["enhanceInputImage"]);e!==void 0&&m!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],m);const v=d(n,["imagePreservationFactor"]);e!==void 0&&v!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],v);const b=d(n,["labels"]);e!==void 0&&b!=null&&p(e,["labels"],b);const S=d(n,["numberOfImages"]);e!==void 0&&S!=null&&p(e,["parameters","sampleCount"],S);const w=d(n,["mode"]);return e!==void 0&&w!=null&&p(e,["parameters","mode"],w),i}function IT(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["_url","model"],He(n,s));const r=d(e,["image"]);r!=null&&p(i,["instances[0]","image"],xn(r));const c=d(e,["upscaleFactor"]);c!=null&&p(i,["parameters","upscaleConfig","upscaleFactor"],c);const f=d(e,["config"]);return f!=null&&AT(f,i),i}function DT(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(c=>qr(c))),p(e,["generatedImages"],r)}return e}function MT(n){const e={},i=d(n,["uri"]);i!=null&&p(e,["uri"],i);const s=d(n,["encodedVideo"]);s!=null&&p(e,["videoBytes"],Ca(s));const r=d(n,["encoding"]);return r!=null&&p(e,["mimeType"],r),e}function RT(n){const e={},i=d(n,["gcsUri"]);i!=null&&p(e,["uri"],i);const s=d(n,["bytesBase64Encoded"]);s!=null&&p(e,["videoBytes"],Ca(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}function UT(n){const e={},i=d(n,["image"]);i!=null&&p(e,["_self"],xn(i));const s=d(n,["maskMode"]);return s!=null&&p(e,["maskMode"],s),e}function PT(n){const e={},i=d(n,["image"]);i!=null&&p(e,["image"],kr(i));const s=d(n,["referenceType"]);return s!=null&&p(e,["referenceType"],s),e}function qT(n){const e={},i=d(n,["image"]);i!=null&&p(e,["image"],xn(i));const s=d(n,["referenceType"]);return s!=null&&p(e,["referenceType"],s),e}function qg(n){const e={},i=d(n,["uri"]);i!=null&&p(e,["uri"],i);const s=d(n,["videoBytes"]);s!=null&&p(e,["encodedVideo"],Ca(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["encoding"],r),e}function kg(n){const e={},i=d(n,["uri"]);i!=null&&p(e,["gcsUri"],i);const s=d(n,["videoBytes"]);s!=null&&p(e,["bytesBase64Encoded"],Ca(s));const r=d(n,["mimeType"]);return r!=null&&p(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kT="Content-Type",LT="X-Server-Timeout",jT="User-Agent",Cu="x-goog-api-client",VT="1.29.1",BT=`google-genai-sdk/${VT}`,GT="v1beta1",HT="v1beta",k0=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class zT{constructor(e){var i,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:GT,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:HT,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),i=new URL(e);return i.protocol=i.protocol=="http:"?"ws":"wss",i.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,i,s){const r=[this.getRequestUrlInternal(i)];return s&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let i=this.clientOptions.httpOptions;e.httpOptions&&(i=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,i,s);if(e.queryParams)for(const[f,h]of Object.entries(e.queryParams))r.searchParams.append(f,String(h));let c={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else c.body=e.body;return c=await this.includeExtraHttpOptionsToRequestInit(c,i,r.toString(),e.abortSignal),this.unaryApiCall(r,c,e.httpMethod)}patchHttpOptions(e,i){const s=JSON.parse(JSON.stringify(e));for(const[r,c]of Object.entries(i))typeof c=="object"?s[r]=Object.assign(Object.assign({},s[r]),c):c!==void 0&&(s[r]=c);return s}async requestStream(e){let i=this.clientOptions.httpOptions;e.httpOptions&&(i=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,i,s);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let c={};return c.body=e.body,c=await this.includeExtraHttpOptionsToRequestInit(c,i,r.toString(),e.abortSignal),this.streamApiCall(r,c,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,i,s,r){if(i&&i.timeout||r){const c=new AbortController,f=c.signal;if(i.timeout&&(i==null?void 0:i.timeout)>0){const h=setTimeout(()=>c.abort(),i.timeout);h&&typeof h.unref=="function"&&h.unref()}r&&r.addEventListener("abort",()=>{c.abort()}),e.signal=f}return i&&i.extraBody!==null&&OT(e,i.extraBody),e.headers=await this.getHeadersInternal(i,s),e}async unaryApiCall(e,i,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},i),{method:s})).then(async r=>(await L0(r),new Su(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,i,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},i),{method:s})).then(async r=>(await L0(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var i;return Bi(this,arguments,function*(){const r=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),c=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let f="";for(;;){const{done:h,value:y}=yield tt(r.read());if(h){if(f.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=c.decode(y,{stream:!0});try{const b=JSON.parse(m);if("error"in b){const S=JSON.parse(JSON.stringify(b.error)),w=S.status,C=S.code,I=`got status: ${w}. ${JSON.stringify(b)}`;if(C>=400&&C<600)throw new Ur({message:I,status:C})}}catch(b){if(b.name==="ApiError")throw b}f+=m;let v=f.match(k0);for(;v;){const b=v[1];try{const S=new Response(b,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield tt(new Su(S)),f=f.slice(v[0].length),v=f.match(k0)}catch(S){throw new Error(`exception parsing stream chunk ${b}. ${S}`)}}}}finally{r.releaseLock()}})}async apiCall(e,i){return fetch(e,i).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},i=BT+" "+this.clientOptions.userAgentExtra;return e[jT]=i,e[Cu]=i,e[kT]="application/json",e}async getHeadersInternal(e,i){const s=new Headers;if(e&&e.headers){for(const[r,c]of Object.entries(e.headers))s.append(r,c);e.timeout&&e.timeout>0&&s.append(LT,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s,i),s}getFileName(e){var i;let s="";return typeof e=="string"&&(s=e.replace(/[/\\]+$/,""),s=(i=s.split(/[/\\]/).pop())!==null&&i!==void 0?i:""),s}async uploadFile(e,i){var s;const r={};i!=null&&(r.mimeType=i.mimeType,r.name=i.name,r.displayName=i.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const c=this.clientOptions.uploader,f=await c.stat(e);r.sizeBytes=String(f.size);const h=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:f.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=h;const y={file:r},m=this.getFileName(e),v=pe("upload/v1beta/files",y._url),b=await this.fetchUploadUrl(v,r.sizeBytes,r.mimeType,m,y,i==null?void 0:i.httpOptions);return c.upload(e,b,this)}async uploadFileToFileSearchStore(e,i,s){var r;const c=this.clientOptions.uploader,f=await c.stat(i),h=String(f.size),y=(r=s==null?void 0:s.mimeType)!==null&&r!==void 0?r:f.type;if(y===void 0||y==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const m=`upload/v1beta/${e}:uploadToFileSearchStore`,v=this.getFileName(i),b={};s!=null&&s.customMetadata&&(b.customMetadata=s.customMetadata),s!=null&&s.chunkingConfig&&(b.chunkingConfig=s.chunkingConfig);const S=await this.fetchUploadUrl(m,h,y,v,b,s==null?void 0:s.httpOptions);return c.uploadToFileSearchStore(i,S,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,i,s,r,c,f){var h;let y={};f?y=f:y={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i}`,"X-Goog-Upload-Header-Content-Type":`${s}`},r?{"X-Goog-Upload-File-Name":r}:{})};const m=await this.request({path:e,body:JSON.stringify(c),httpMethod:"POST",httpOptions:y});if(!m||!(m!=null&&m.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const v=(h=m==null?void 0:m.headers)===null||h===void 0?void 0:h["x-goog-upload-url"];if(v===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return v}}async function L0(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const i=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(s);throw i>=400&&i<600?new Ur({message:r,status:i}):new Error(r)}}function OT(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let i={};if(typeof n.body=="string"&&n.body.length>0)try{const c=JSON.parse(n.body);if(typeof c=="object"&&c!==null&&!Array.isArray(c))i=c;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(c,f){const h=Object.assign({},c);for(const y in f)if(Object.prototype.hasOwnProperty.call(f,y)){const m=f[y],v=h[y];m&&typeof m=="object"&&!Array.isArray(m)&&v&&typeof v=="object"&&!Array.isArray(v)?h[y]=s(v,m):(v&&m&&typeof v!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${y}". Original type: ${typeof v}, New type: ${typeof m}. Overwriting.`),h[y]=m)}return h}const r=s(i,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const FT="mcp_used/unknown";let YT=!1;function Lg(n){for(const e of n)if(JT(e)||typeof e=="object"&&"inputSchema"in e)return!0;return YT}function jg(n){var e;const i=(e=n[Cu])!==null&&e!==void 0?e:"";n[Cu]=(i+` ${FT}`).trimStart()}function JT(n){return n!==null&&typeof n=="object"&&n instanceof Yu}function QT(n,e=100){return Bi(this,arguments,function*(){let s,r=0;for(;r<e;){const c=yield tt(n.listTools({cursor:s}));for(const f of c.tools)yield yield tt(f),r++;if(!c.nextCursor)break;s=c.nextCursor}})}class Yu{constructor(e=[],i){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=i}static create(e,i){return new Yu(e,i)}async initialize(){var e,i,s,r;if(this.mcpTools.length>0)return;const c={},f=[];for(const v of this.mcpClients)try{for(var h=!0,y=(i=void 0,Ys(QT(v))),m;m=await y.next(),e=m.done,!e;h=!0){r=m.value,h=!1;const b=r;f.push(b);const S=b.name;if(c[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);c[S]=v}}catch(b){i={error:b}}finally{try{!h&&!e&&(s=y.return)&&await s.call(y)}finally{if(i)throw i.error}}this.mcpTools=f,this.functionNameToMcpClient=c}async tool(){return await this.initialize(),WS(this.mcpTools,this.config)}async callTool(e){await this.initialize();const i=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[s.name];let c;this.config.timeout&&(c={timeout:this.config.timeout});const f=await r.callTool({name:s.name,arguments:s.args},void 0,c);i.push({functionResponse:{name:s.name,response:f.isError?{error:f}:f}})}return i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function $T(n,e,i){const s=new FS;let r;i.data instanceof Blob?r=JSON.parse(await i.data.text()):r=JSON.parse(i.data),Object.assign(s,r),e(s)}class KT{constructor(e,i,s){this.apiClient=e,this.auth=i,this.webSocketFactory=s}async connect(e){var i,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),f=WT(this.apiClient.getDefaultHeaders()),h=this.apiClient.getApiKey(),y=`${r}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateMusic?key=${h}`;let m=()=>{};const v=new Promise(q=>{m=q}),b=e.callbacks,S=function(){m({})},w=this.apiClient,C={onopen:S,onmessage:q=>{$T(w,b.onmessage,q)},onerror:(i=b==null?void 0:b.onerror)!==null&&i!==void 0?i:function(q){},onclose:(s=b==null?void 0:b.onclose)!==null&&s!==void 0?s:function(q){}},I=this.webSocketFactory.create(y,ZT(f),C);I.connect(),await v;const V={setup:{model:He(this.apiClient,e.model)}};return I.send(JSON.stringify(V)),new XT(I,this.apiClient)}}class XT{constructor(e,i){this.conn=e,this.apiClient=i}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const i=Hw(e);this.conn.send(JSON.stringify({clientContent:i}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const i=Gw(e);this.conn.send(JSON.stringify(i))}sendPlaybackControl(e){const i={playbackControl:e};this.conn.send(JSON.stringify(i))}play(){this.sendPlaybackControl(ji.PLAY)}pause(){this.sendPlaybackControl(ji.PAUSE)}stop(){this.sendPlaybackControl(ji.STOP)}resetContext(){this.sendPlaybackControl(ji.RESET_CONTEXT)}close(){this.conn.close()}}function ZT(n){const e={};return n.forEach((i,s)=>{e[s]=i}),e}function WT(n){const e=new Headers;for(const[i,s]of Object.entries(n))e.append(i,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eC="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tC(n,e,i){const s=new OS;let r;i.data instanceof Blob?r=await i.data.text():i.data instanceof ArrayBuffer?r=new TextDecoder().decode(i.data):r=i.data;const c=JSON.parse(r);if(n.isVertexAI()){const f=Fw(c);Object.assign(s,f)}else Object.assign(s,c);e(s)}class nC{constructor(e,i,s){this.apiClient=e,this.auth=i,this.webSocketFactory=s,this.music=new KT(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var i,s,r,c,f,h;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const y=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let v;const b=this.apiClient.getHeaders();e.config&&e.config.tools&&Lg(e.config.tools)&&jg(b);const S=oC(b);if(this.apiClient.isVertexAI())v=`${y}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S,v);else{const K=this.apiClient.getApiKey();let Y="BidiGenerateContent",fe="key";K!=null&&K.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Y="BidiGenerateContentConstrained",fe="access_token"),v=`${y}/ws/google.ai.generativelanguage.${m}.GenerativeService.${Y}?${fe}=${K}`}let w=()=>{};const C=new Promise(K=>{w=K}),I=e.callbacks,P=function(){var K;(K=I==null?void 0:I.onopen)===null||K===void 0||K.call(I),w({})},k=this.apiClient,V={onopen:P,onmessage:K=>{tC(k,I.onmessage,K)},onerror:(i=I==null?void 0:I.onerror)!==null&&i!==void 0?i:function(K){},onclose:(s=I==null?void 0:I.onclose)!==null&&s!==void 0?s:function(K){}},q=this.webSocketFactory.create(v,sC(S),V);q.connect(),await C;let D=He(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const K=this.apiClient.getProject(),Y=this.apiClient.getLocation();D=`projects/${K}/locations/${Y}/`+D}let R={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Er.AUDIO]}:e.config.responseModalities=[Er.AUDIO]),!((c=e.config)===null||c===void 0)&&c.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(h=(f=e.config)===null||f===void 0?void 0:f.tools)!==null&&h!==void 0?h:[],F=[];for(const K of z)if(this.isCallableTool(K)){const Y=K;F.push(await Y.tool())}else F.push(K);F.length>0&&(e.config.tools=F);const ie={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?R=Bw(this.apiClient,ie):R=Vw(this.apiClient,ie),delete R.config,q.send(JSON.stringify(R)),new iC(q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const aC={turnComplete:!0};class iC{constructor(e,i){this.conn=e,this.apiClient=i}tLiveClientContent(e,i){if(i.turns!==null&&i.turns!==void 0){let s=[];try{s=un(i.turns),e.isVertexAI()||(s=s.map(r=>Pr(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof i.turns}'`)}return{clientContent:{turns:s,turnComplete:i.turnComplete}}}return{clientContent:{turnComplete:i.turnComplete}}}tLiveClienttToolResponse(e,i){let s=[];if(i.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(i.functionResponses)?s=i.functionResponses:s=[i.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const c of s){if(typeof c!="object"||c===null||!("name"in c)||!("response"in c))throw new Error(`Could not parse function response, type '${typeof c}'.`);if(!e.isVertexAI()&&!("id"in c))throw new Error(eC)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},aC),e);const i=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(i))}sendRealtimeInput(e){let i={};this.apiClient.isVertexAI()?i={realtimeInput:Ow(e)}:i={realtimeInput:zw(e)},this.conn.send(JSON.stringify(i))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const i=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(i))}close(){this.conn.close()}}function sC(n){const e={};return n.forEach((i,s)=>{e[s]=i}),e}function oC(n){const e=new Headers;for(const[i,s]of Object.entries(n))e.append(i,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j0=10;function V0(n){var e,i,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const f of(i=n==null?void 0:n.tools)!==null&&i!==void 0?i:[])if(Gi(f)){r=!0;break}if(!r)return!0;const c=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return c&&(c<0||!Number.isInteger(c))||c==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",c),!0):!1}function Gi(n){return"callTool"in n&&typeof n.callTool=="function"}function rC(n){var e,i,s;return(s=(i=(e=n.config)===null||e===void 0?void 0:e.tools)===null||i===void 0?void 0:i.some(r=>Gi(r)))!==null&&s!==void 0?s:!1}function B0(n){var e;const i=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((s,r)=>{if(Gi(s))return;const c=s;c.functionDeclarations&&c.functionDeclarations.length>0&&i.push(r)}),i}function G0(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lC extends Kn{constructor(e){super(),this.apiClient=e,this.generateContent=async i=>{var s,r,c,f,h;const y=await this.processParamsMaybeAddMcpUsage(i);if(this.maybeMoveToResponseJsonSchem(i),!rC(i)||V0(i.config))return await this.generateContentInternal(y);const m=B0(i);if(m.length>0){const I=m.map(P=>`tools[${P}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let v,b;const S=un(y.contents),w=(c=(r=(s=y.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&c!==void 0?c:j0;let C=0;for(;C<w&&(v=await this.generateContentInternal(y),!(!v.functionCalls||v.functionCalls.length===0));){const I=v.candidates[0].content,P=[];for(const k of(h=(f=i.config)===null||f===void 0?void 0:f.tools)!==null&&h!==void 0?h:[])if(Gi(k)){const q=await k.callTool(v.functionCalls);P.push(...q)}C++,b={role:"user",parts:P},y.contents=un(y.contents),y.contents.push(I),y.contents.push(b),G0(y.config)&&(S.push(I),S.push(b))}return G0(y.config)&&(v.automaticFunctionCallingHistory=S),v},this.generateContentStream=async i=>{if(this.maybeMoveToResponseJsonSchem(i),V0(i.config)){const r=await this.processParamsMaybeAddMcpUsage(i);return await this.generateContentStreamInternal(r)}const s=B0(i);if(s.length>0){const r=s.map(c=>`tools[${c}]`).join(", ");throw new Error(`Incompatible tools found at ${r}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}return await this.processAfcStream(i)},this.generateImages=async i=>await this.generateImagesInternal(i).then(s=>{var r;let c;const f=[];if(s!=null&&s.generatedImages)for(const y of s.generatedImages)y&&(y!=null&&y.safetyAttributes)&&((r=y==null?void 0:y.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?c=y==null?void 0:y.safetyAttributes:f.push(y);let h;return c?h={generatedImages:f,positivePromptSafetyAttributes:c,sdkHttpResponse:s.sdkHttpResponse}:h={generatedImages:f,sdkHttpResponse:s.sdkHttpResponse},h}),this.list=async i=>{var s;const f={config:Object.assign(Object.assign({},{queryBase:!0}),i==null?void 0:i.config)};if(this.apiClient.isVertexAI()&&!f.config.queryBase){if(!((s=f.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");f.config.filter="labels.tune-type:*"}return new Ka($n.PAGED_ITEM_MODELS,h=>this.listInternal(h),await this.listInternal(f),f)},this.editImage=async i=>{const s={model:i.model,prompt:i.prompt,referenceImages:[],config:i.config};return i.referenceImages&&i.referenceImages&&(s.referenceImages=i.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async i=>{let s={numberOfImages:1,mode:"upscale"};i.config&&(s=Object.assign(Object.assign({},s),i.config));const r={model:i.model,image:i.image,upscaleFactor:i.upscaleFactor,config:s};return await this.upscaleImageInternal(r)},this.generateVideos=async i=>{var s,r,c,f,h,y;if((i.prompt||i.image||i.video)&&i.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=i.video)===null||s===void 0)&&s.uri&&(!((r=i.video)===null||r===void 0)&&r.videoBytes)?i.video={uri:i.video.uri,mimeType:i.video.mimeType}:!((f=(c=i.source)===null||c===void 0?void 0:c.video)===null||f===void 0)&&f.uri&&(!((y=(h=i.source)===null||h===void 0?void 0:h.video)===null||y===void 0)&&y.videoBytes)&&(i.source.video={uri:i.source.video.uri,mimeType:i.source.video.mimeType})),await this.generateVideosInternal(i)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var i,s,r;const c=(i=e.config)===null||i===void 0?void 0:i.tools;if(!c)return e;const f=await Promise.all(c.map(async y=>Gi(y)?await y.tool():y)),h={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:f})};if(h.config.tools=f,e.config&&e.config.tools&&Lg(e.config.tools)){const y=(r=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&r!==void 0?r:{};let m=Object.assign({},y);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),jg(m),h.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return h}async initAfcToolsMap(e){var i,s,r;const c=new Map;for(const f of(s=(i=e.config)===null||i===void 0?void 0:i.tools)!==null&&s!==void 0?s:[])if(Gi(f)){const h=f,y=await h.tool();for(const m of(r=y.functionDeclarations)!==null&&r!==void 0?r:[]){if(!m.name)throw new Error("Function declaration name is required.");if(c.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);c.set(m.name,h)}}return c}async processAfcStream(e){var i,s,r;const c=(r=(s=(i=e.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:j0;let f=!1,h=0;const y=await this.initAfcToolsMap(e);return(function(m,v,b){var S,w;return Bi(this,arguments,function*(){for(var C,I,P,k;h<c;){f&&(h++,f=!1);const R=yield tt(m.processParamsMaybeAddMcpUsage(b)),z=yield tt(m.generateContentStreamInternal(R)),F=[],ie=[];try{for(var V=!0,q=(I=void 0,Ys(z)),D;D=yield tt(q.next()),C=D.done,!C;V=!0){k=D.value,V=!1;const K=k;if(yield yield tt(K),K.candidates&&(!((S=K.candidates[0])===null||S===void 0)&&S.content)){ie.push(K.candidates[0].content);for(const Y of(w=K.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(h<c&&Y.functionCall){if(!Y.functionCall.name)throw new Error("Function call name was not returned by the model.");if(v.has(Y.functionCall.name)){const fe=yield tt(v.get(Y.functionCall.name).callTool([Y.functionCall]));F.push(...fe)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${v.keys()}, mising tool: ${Y.functionCall.name}`)}}}}catch(K){I={error:K}}finally{try{!V&&!C&&(P=q.return)&&(yield tt(P.call(q)))}finally{if(I)throw I.error}}if(F.length>0){f=!0;const K=new Fs;K.candidates=[{content:{role:"user",parts:F}}],yield yield tt(K);const Y=[];Y.push(...ie),Y.push({role:"user",parts:F});const fe=un(b.contents).concat(Y);b.contents=fe}else break}})})(this,y,e)}async generateContentInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=U0(this.apiClient,e);return h=pe("{model}:generateContent",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=q0(v),S=new Fs;return Object.assign(S,b),S})}else{const m=R0(this.apiClient,e);return h=pe("{model}:generateContent",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=P0(v),S=new Fs;return Object.assign(S,b),S})}}async generateContentStreamInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=U0(this.apiClient,e);return h=pe("{model}:streamGenerateContent?alt=sse",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.requestStream({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),f.then(function(b){return Bi(this,arguments,function*(){var S,w,C,I;try{for(var P=!0,k=Ys(b),V;V=yield tt(k.next()),S=V.done,!S;P=!0){I=V.value,P=!1;const q=I,D=q0(yield tt(q.json()));D.sdkHttpResponse={headers:q.headers};const R=new Fs;Object.assign(R,D),yield yield tt(R)}}catch(q){w={error:q}}finally{try{!P&&!S&&(C=k.return)&&(yield tt(C.call(k)))}finally{if(w)throw w.error}}})})}else{const m=R0(this.apiClient,e);return h=pe("{model}:streamGenerateContent?alt=sse",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.requestStream({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}),f.then(function(b){return Bi(this,arguments,function*(){var S,w,C,I;try{for(var P=!0,k=Ys(b),V;V=yield tt(k.next()),S=V.done,!S;P=!0){I=V.value,P=!1;const q=I,D=P0(yield tt(q.json()));D.sdkHttpResponse={headers:q.headers};const R=new Fs;Object.assign(R,D),yield yield tt(R)}}catch(q){w={error:q}}finally{try{!P&&!S&&(C=k.return)&&(yield tt(C.call(k)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=SE(this.apiClient,e);return h=pe("{model}:predict",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=wE(v),S=new g0;return Object.assign(S,b),S})}else{const m=bE(this.apiClient,e);return h=pe("{model}:batchEmbedContents",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=NE(v),S=new g0;return Object.assign(S,b),S})}}async generateImagesInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=RE(this.apiClient,e);return h=pe("{model}:predict",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=PE(v),S=new y0;return Object.assign(S,b),S})}else{const m=ME(this.apiClient,e);return h=pe("{model}:predict",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=UE(v),S=new y0;return Object.assign(S,b),S})}}async editImageInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=gE(this.apiClient,e);return c=pe("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>{const m=yE(y),v=new US;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=IT(this.apiClient,e);return c=pe("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>{const m=DT(y),v=new PS;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=dT(this.apiClient,e);return c=pe("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=fT(y),v=new qS;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=xT(this.apiClient,e);return c=pe("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=vT(y),v=new kS;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=XE(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>Tu(v))}else{const m=KE(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>Eu(v))}}async listInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=iT(this.apiClient,e);return h=pe("{models_url}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=oT(v),S=new x0;return Object.assign(S,b),S})}else{const m=aT(this.apiClient,e);return h=pe("{models_url}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=sT(v),S=new x0;return Object.assign(S,b),S})}}async update(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=_T(this.apiClient,e);return h=pe("{model}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>Tu(v))}else{const m=CT(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>Eu(v))}}async delete(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=fE(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=mE(v),S=new v0;return Object.assign(S,b),S})}else{const m=dE(this.apiClient,e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=pE(v),S=new v0;return Object.assign(S,b),S})}}async countTokens(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=lE(this.apiClient,e);return h=pe("{model}:countTokens",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=uE(v),S=new b0;return Object.assign(S,b),S})}else{const m=rE(this.apiClient,e);return h=pe("{model}:countTokens",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=cE(v),S=new b0;return Object.assign(S,b),S})}}async computeTokens(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=eE(this.apiClient,e);return c=pe("{model}:computeTokens",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>{const m=tE(y),v=new LS;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=BE(this.apiClient,e);return h=pe("{model}:predictLongRunning",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f.then(v=>{const b=jE(v),S=new Tr;return Object.assign(S,b),S})}else{const m=VE(this.apiClient,e);return h=pe("{model}:predictLongRunning",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f.then(v=>{const b=LE(v),S=new Tr;return Object.assign(S,b),S})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cC extends Kn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const i=e.operation,s=e.config;if(i.name===void 0||i.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=i.name.split("/operations/")[0];let c;s&&"httpOptions"in s&&(c=s.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:i.name,resourceName:r,config:{httpOptions:c}});return i._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:i.name,config:s});return i._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const i=e.operation,s=e.config;if(i.name===void 0||i.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=i.name.split("/operations/")[0];let c;s&&"httpOptions"in s&&(c=s.httpOptions);const f=await this.fetchPredictVideosOperationInternal({operationName:i.name,resourceName:r,config:{httpOptions:c}});return i._fromAPIResponse({apiResponse:f,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:i.name,config:s});return i._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=_S(e);return h=pe("{operationName}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json()),f}else{const m=CS(e);return h=pe("{operationName}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),f}}async fetchPredictVideosOperationInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=vS(e);return c=pe("{resourceName}:fetchPredictOperation",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uC(n){const e={},i=d(n,["data"]);if(i!=null&&p(e,["data"],i),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function dC(n){const e={},i=d(n,["parts"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(c=>vC(c))),p(e,["parts"],r)}const s=d(n,["role"]);return s!=null&&p(e,["role"],s),e}function fC(n,e,i){const s={},r=d(e,["expireTime"]);i!==void 0&&r!=null&&p(i,["expireTime"],r);const c=d(e,["newSessionExpireTime"]);i!==void 0&&c!=null&&p(i,["newSessionExpireTime"],c);const f=d(e,["uses"]);i!==void 0&&f!=null&&p(i,["uses"],f);const h=d(e,["liveConnectConstraints"]);i!==void 0&&h!=null&&p(i,["bidiGenerateContentSetup"],xC(n,h));const y=d(e,["lockAdditionalFields"]);return i!==void 0&&y!=null&&p(i,["fieldMask"],y),s}function pC(n,e){const i={},s=d(e,["config"]);return s!=null&&p(i,["config"],fC(n,s,i)),i}function mC(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["fileUri"]);i!=null&&p(e,["fileUri"],i);const s=d(n,["mimeType"]);return s!=null&&p(e,["mimeType"],s),e}function hC(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=d(n,["enableWidget"]);return i!=null&&p(e,["enableWidget"],i),e}function gC(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=d(n,["timeRangeFilter"]);return i!=null&&p(e,["timeRangeFilter"],i),e}function yC(n,e){const i={},s=d(n,["generationConfig"]);e!==void 0&&s!=null&&p(e,["setup","generationConfig"],s);const r=d(n,["responseModalities"]);e!==void 0&&r!=null&&p(e,["setup","generationConfig","responseModalities"],r);const c=d(n,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const f=d(n,["topP"]);e!==void 0&&f!=null&&p(e,["setup","generationConfig","topP"],f);const h=d(n,["topK"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","topK"],h);const y=d(n,["maxOutputTokens"]);e!==void 0&&y!=null&&p(e,["setup","generationConfig","maxOutputTokens"],y);const m=d(n,["mediaResolution"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","mediaResolution"],m);const v=d(n,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=d(n,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],Fu(b));const S=d(n,["thinkingConfig"]);e!==void 0&&S!=null&&p(e,["setup","generationConfig","thinkingConfig"],S);const w=d(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],w);const C=d(n,["systemInstruction"]);e!==void 0&&C!=null&&p(e,["setup","systemInstruction"],dC(Ct(C)));const I=d(n,["tools"]);if(e!==void 0&&I!=null){let z=Yi(I);Array.isArray(z)&&(z=z.map(F=>SC(Fi(F)))),p(e,["setup","tools"],z)}const P=d(n,["sessionResumption"]);e!==void 0&&P!=null&&p(e,["setup","sessionResumption"],bC(P));const k=d(n,["inputAudioTranscription"]);e!==void 0&&k!=null&&p(e,["setup","inputAudioTranscription"],k);const V=d(n,["outputAudioTranscription"]);e!==void 0&&V!=null&&p(e,["setup","outputAudioTranscription"],V);const q=d(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&p(e,["setup","realtimeInputConfig"],q);const D=d(n,["contextWindowCompression"]);e!==void 0&&D!=null&&p(e,["setup","contextWindowCompression"],D);const R=d(n,["proactivity"]);return e!==void 0&&R!=null&&p(e,["setup","proactivity"],R),i}function xC(n,e){const i={},s=d(e,["model"]);s!=null&&p(i,["setup","model"],He(n,s));const r=d(e,["config"]);return r!=null&&p(i,["config"],yC(r,i)),i}function vC(n){const e={},i=d(n,["functionCall"]);i!=null&&p(e,["functionCall"],i);const s=d(n,["codeExecutionResult"]);s!=null&&p(e,["codeExecutionResult"],s);const r=d(n,["executableCode"]);r!=null&&p(e,["executableCode"],r);const c=d(n,["fileData"]);c!=null&&p(e,["fileData"],mC(c));const f=d(n,["functionResponse"]);f!=null&&p(e,["functionResponse"],f);const h=d(n,["inlineData"]);h!=null&&p(e,["inlineData"],uC(h));const y=d(n,["text"]);y!=null&&p(e,["text"],y);const m=d(n,["thought"]);m!=null&&p(e,["thought"],m);const v=d(n,["thoughtSignature"]);v!=null&&p(e,["thoughtSignature"],v);const b=d(n,["videoMetadata"]);return b!=null&&p(e,["videoMetadata"],b),e}function bC(n){const e={},i=d(n,["handle"]);if(i!=null&&p(e,["handle"],i),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function SC(n){const e={},i=d(n,["functionDeclarations"]);if(i!=null){let v=i;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=d(n,["googleSearchRetrieval"]);s!=null&&p(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);r!=null&&p(e,["computerUse"],r);const c=d(n,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const f=d(n,["codeExecution"]);if(f!=null&&p(e,["codeExecution"],f),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const h=d(n,["googleMaps"]);h!=null&&p(e,["googleMaps"],hC(h));const y=d(n,["googleSearch"]);y!=null&&p(e,["googleSearch"],gC(y));const m=d(n,["urlContext"]);return m!=null&&p(e,["urlContext"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NC(n){const e=[];for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const s=n[i];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const r=Object.keys(s).map(c=>`${i}.${c}`);e.push(...r)}else e.push(i)}return e.join(",")}function wC(n,e){let i=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const c=s.setup;typeof c=="object"&&c!==null?(n.bidiGenerateContentSetup=c,i=c):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(i){const c=NC(i);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)c?n.fieldMask=c:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const f=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let h=[];r.length>0&&(h=r.map(m=>f.includes(m)?`generationConfig.${m}`:m));const y=[];c&&y.push(c),h.length>0&&y.push(...h),y.length>0?n.fieldMask=y.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class EC extends Kn{constructor(e){super(),this.apiClient=e}async create(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const h=pC(this.apiClient,e);c=pe("auth_tokens",h._url),f=h._query,delete h.config,delete h._url,delete h._query;const y=wC(h,e.config);return r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),r.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TC(n,e){const i={},s=d(n,["displayName"]);return e!==void 0&&s!=null&&p(e,["displayName"],s),i}function CC(n){const e={},i=d(n,["config"]);return i!=null&&TC(i,e),e}function _C(n,e){const i={},s=d(n,["force"]);return e!==void 0&&s!=null&&p(e,["_query","force"],s),i}function AC(n){const e={},i=d(n,["name"]);i!=null&&p(e,["_url","name"],i);const s=d(n,["config"]);return s!=null&&_C(s,e),e}function IC(n){const e={},i=d(n,["name"]);return i!=null&&p(e,["_url","name"],i),e}function DC(n,e){const i={},s=d(n,["customMetadata"]);if(e!==void 0&&s!=null){let c=s;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["customMetadata"],c)}const r=d(n,["chunkingConfig"]);return e!==void 0&&r!=null&&p(e,["chunkingConfig"],r),i}function MC(n){const e={},i=d(n,["name"]);i!=null&&p(e,["name"],i);const s=d(n,["metadata"]);s!=null&&p(e,["metadata"],s);const r=d(n,["done"]);r!=null&&p(e,["done"],r);const c=d(n,["error"]);c!=null&&p(e,["error"],c);const f=d(n,["response"]);return f!=null&&p(e,["response"],UC(f)),e}function RC(n){const e={},i=d(n,["fileSearchStoreName"]);i!=null&&p(e,["_url","file_search_store_name"],i);const s=d(n,["fileName"]);s!=null&&p(e,["fileName"],s);const r=d(n,["config"]);return r!=null&&DC(r,e),e}function UC(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["parent"]);s!=null&&p(e,["parent"],s);const r=d(n,["documentName"]);return r!=null&&p(e,["documentName"],r),e}function PC(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),i}function qC(n){const e={},i=d(n,["config"]);return i!=null&&PC(i,e),e}function kC(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["fileSearchStores"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["fileSearchStores"],c)}return e}function LC(n,e){const i={},s=d(n,["mimeType"]);e!==void 0&&s!=null&&p(e,["mimeType"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&p(e,["displayName"],r);const c=d(n,["customMetadata"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(y=>y)),p(e,["customMetadata"],h)}const f=d(n,["chunkingConfig"]);return e!==void 0&&f!=null&&p(e,["chunkingConfig"],f),i}function jC(n){const e={},i=d(n,["fileSearchStoreName"]);i!=null&&p(e,["_url","file_search_store_name"],i);const s=d(n,["config"]);return s!=null&&LC(s,e),e}function VC(n){const e={},i=d(n,["sdkHttpResponse"]);return i!=null&&p(e,["sdkHttpResponse"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BC(n,e){const i={},s=d(n,["force"]);return e!==void 0&&s!=null&&p(e,["_query","force"],s),i}function GC(n){const e={},i=d(n,["name"]);i!=null&&p(e,["_url","name"],i);const s=d(n,["config"]);return s!=null&&BC(s,e),e}function HC(n){const e={},i=d(n,["name"]);return i!=null&&p(e,["_url","name"],i),e}function zC(n,e){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&p(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);return e!==void 0&&r!=null&&p(e,["_query","pageToken"],r),i}function OC(n){const e={},i=d(n,["parent"]);i!=null&&p(e,["_url","parent"],i);const s=d(n,["config"]);return s!=null&&zC(s,e),e}function FC(n){const e={},i=d(n,["sdkHttpResponse"]);i!=null&&p(e,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&p(e,["nextPageToken"],s);const r=d(n,["documents"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),p(e,["documents"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YC extends Kn{constructor(e){super(),this.apiClient=e,this.list=async i=>new Ka($n.PAGED_ITEM_DOCUMENTS,s=>this.listInternal({parent:i.parent,config:s.config}),await this.listInternal(i),i)}async get(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=HC(e);return c=pe("{name}",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>y)}}async delete(e){var i,s;let r="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=GC(e);r=pe("{name}",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:r,queryParams:c,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=OC(e);return c=pe("{parent}/documents",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=FC(y),v=new jS;return Object.assign(v,m),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JC extends Kn{constructor(e,i=new YC(e)){super(),this.apiClient=e,this.documents=i,this.list=async(s={})=>new Ka($n.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(s),s)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=CC(e);return c=pe("fileSearchStores",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>y)}}async get(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=IC(e);return c=pe("{name}",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>y)}}async delete(e){var i,s;let r="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=AC(e);r=pe("{name}",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:r,queryParams:c,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=qC(e);return c=pe("fileSearchStores",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=kC(y),v=new VS;return Object.assign(v,m),v})}}async uploadToFileSearchStoreInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=jC(e);return c=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=VC(y),v=new BS;return Object.assign(v,m),v})}}async importFile(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=RC(e);return c=pe("{file_search_store_name}:importFile",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json()),r.then(y=>{const m=MC(y),v=new Bu;return Object.assign(v,m),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QC(n,e){const i={},s=d(n,["name"]);return s!=null&&p(i,["_url","name"],s),i}function $C(n,e){const i={},s=d(n,["name"]);return s!=null&&p(i,["_url","name"],s),i}function KC(n,e,i){const s={};if(d(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=d(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&p(e,["displayName"],r),d(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const c=d(n,["epochCount"]);e!==void 0&&c!=null&&p(e,["tuningTask","hyperparameters","epochCount"],c);const f=d(n,["learningRateMultiplier"]);if(f!=null&&p(s,["tuningTask","hyperparameters","learningRateMultiplier"],f),d(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const h=d(n,["batchSize"]);e!==void 0&&h!=null&&p(e,["tuningTask","hyperparameters","batchSize"],h);const y=d(n,["learningRate"]);if(e!==void 0&&y!=null&&p(e,["tuningTask","hyperparameters","learningRate"],y),d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return s}function XC(n,e,i){const s={};let r=d(i,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const w=d(n,["validationDataset"]);e!==void 0&&w!=null&&p(e,["supervisedTuningSpec"],H0(w))}else if(r==="PREFERENCE_TUNING"){const w=d(n,["validationDataset"]);e!==void 0&&w!=null&&p(e,["preferenceOptimizationSpec"],H0(w))}const c=d(n,["tunedModelDisplayName"]);e!==void 0&&c!=null&&p(e,["tunedModelDisplayName"],c);const f=d(n,["description"]);e!==void 0&&f!=null&&p(e,["description"],f);let h=d(i,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const w=d(n,["epochCount"]);e!==void 0&&w!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],w)}else if(h==="PREFERENCE_TUNING"){const w=d(n,["epochCount"]);e!==void 0&&w!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],w)}let y=d(i,["config","method"]);if(y===void 0&&(y="SUPERVISED_FINE_TUNING"),y==="SUPERVISED_FINE_TUNING"){const w=d(n,["learningRateMultiplier"]);e!==void 0&&w!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],w)}else if(y==="PREFERENCE_TUNING"){const w=d(n,["learningRateMultiplier"]);e!==void 0&&w!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],w)}let m=d(i,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const w=d(n,["exportLastCheckpointOnly"]);e!==void 0&&w!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],w)}else if(m==="PREFERENCE_TUNING"){const w=d(n,["exportLastCheckpointOnly"]);e!==void 0&&w!=null&&p(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],w)}let v=d(i,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const w=d(n,["adapterSize"]);e!==void 0&&w!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],w)}else if(v==="PREFERENCE_TUNING"){const w=d(n,["adapterSize"]);e!==void 0&&w!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],w)}if(d(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const b=d(n,["labels"]);e!==void 0&&b!=null&&p(e,["labels"],b);const S=d(n,["beta"]);return e!==void 0&&S!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","beta"],S),s}function ZC(n,e){const i={},s=d(n,["baseModel"]);s!=null&&p(i,["baseModel"],s);const r=d(n,["preTunedModel"]);r!=null&&p(i,["preTunedModel"],r);const c=d(n,["trainingDataset"]);c!=null&&c1(c);const f=d(n,["config"]);return f!=null&&KC(f,i),i}function WC(n,e){const i={},s=d(n,["baseModel"]);s!=null&&p(i,["baseModel"],s);const r=d(n,["preTunedModel"]);r!=null&&p(i,["preTunedModel"],r);const c=d(n,["trainingDataset"]);c!=null&&u1(c,i,e);const f=d(n,["config"]);return f!=null&&XC(f,i,e),i}function e1(n,e){const i={},s=d(n,["name"]);return s!=null&&p(i,["_url","name"],s),i}function t1(n,e){const i={},s=d(n,["name"]);return s!=null&&p(i,["_url","name"],s),i}function n1(n,e,i){const s={},r=d(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const c=d(n,["pageToken"]);e!==void 0&&c!=null&&p(e,["_query","pageToken"],c);const f=d(n,["filter"]);return e!==void 0&&f!=null&&p(e,["_query","filter"],f),s}function a1(n,e,i){const s={},r=d(n,["pageSize"]);e!==void 0&&r!=null&&p(e,["_query","pageSize"],r);const c=d(n,["pageToken"]);e!==void 0&&c!=null&&p(e,["_query","pageToken"],c);const f=d(n,["filter"]);return e!==void 0&&f!=null&&p(e,["_query","filter"],f),s}function i1(n,e){const i={},s=d(n,["config"]);return s!=null&&n1(s,i),i}function s1(n,e){const i={},s=d(n,["config"]);return s!=null&&a1(s,i),i}function o1(n,e){const i={},s=d(n,["sdkHttpResponse"]);s!=null&&p(i,["sdkHttpResponse"],s);const r=d(n,["nextPageToken"]);r!=null&&p(i,["nextPageToken"],r);const c=d(n,["tunedModels"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(h=>Vg(h))),p(i,["tuningJobs"],f)}return i}function r1(n,e){const i={},s=d(n,["sdkHttpResponse"]);s!=null&&p(i,["sdkHttpResponse"],s);const r=d(n,["nextPageToken"]);r!=null&&p(i,["nextPageToken"],r);const c=d(n,["tuningJobs"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(h=>_u(h))),p(i,["tuningJobs"],f)}return i}function l1(n,e){const i={},s=d(n,["name"]);s!=null&&p(i,["model"],s);const r=d(n,["name"]);return r!=null&&p(i,["endpoint"],r),i}function c1(n,e){const i={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=d(n,["examples"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(c=>c)),p(i,["examples","examples"],r)}return i}function u1(n,e,i){const s={};let r=d(i,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const f=d(n,["gcsUri"]);e!==void 0&&f!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(r==="PREFERENCE_TUNING"){const f=d(n,["gcsUri"]);e!==void 0&&f!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}let c=d(i,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const f=d(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],f)}else if(c==="PREFERENCE_TUNING"){const f=d(n,["vertexDatasetResource"]);e!==void 0&&f!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],f)}if(d(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function Vg(n,e){const i={},s=d(n,["sdkHttpResponse"]);s!=null&&p(i,["sdkHttpResponse"],s);const r=d(n,["name"]);r!=null&&p(i,["name"],r);const c=d(n,["state"]);c!=null&&p(i,["state"],bg(c));const f=d(n,["createTime"]);f!=null&&p(i,["createTime"],f);const h=d(n,["tuningTask","startTime"]);h!=null&&p(i,["startTime"],h);const y=d(n,["tuningTask","completeTime"]);y!=null&&p(i,["endTime"],y);const m=d(n,["updateTime"]);m!=null&&p(i,["updateTime"],m);const v=d(n,["description"]);v!=null&&p(i,["description"],v);const b=d(n,["baseModel"]);b!=null&&p(i,["baseModel"],b);const S=d(n,["_self"]);return S!=null&&p(i,["tunedModel"],l1(S)),i}function _u(n,e){const i={},s=d(n,["sdkHttpResponse"]);s!=null&&p(i,["sdkHttpResponse"],s);const r=d(n,["name"]);r!=null&&p(i,["name"],r);const c=d(n,["state"]);c!=null&&p(i,["state"],bg(c));const f=d(n,["createTime"]);f!=null&&p(i,["createTime"],f);const h=d(n,["startTime"]);h!=null&&p(i,["startTime"],h);const y=d(n,["endTime"]);y!=null&&p(i,["endTime"],y);const m=d(n,["updateTime"]);m!=null&&p(i,["updateTime"],m);const v=d(n,["error"]);v!=null&&p(i,["error"],v);const b=d(n,["description"]);b!=null&&p(i,["description"],b);const S=d(n,["baseModel"]);S!=null&&p(i,["baseModel"],S);const w=d(n,["tunedModel"]);w!=null&&p(i,["tunedModel"],w);const C=d(n,["preTunedModel"]);C!=null&&p(i,["preTunedModel"],C);const I=d(n,["supervisedTuningSpec"]);I!=null&&p(i,["supervisedTuningSpec"],I);const P=d(n,["preferenceOptimizationSpec"]);P!=null&&p(i,["preferenceOptimizationSpec"],P);const k=d(n,["tuningDataStats"]);k!=null&&p(i,["tuningDataStats"],k);const V=d(n,["encryptionSpec"]);V!=null&&p(i,["encryptionSpec"],V);const q=d(n,["partnerModelTuningSpec"]);q!=null&&p(i,["partnerModelTuningSpec"],q);const D=d(n,["customBaseModel"]);D!=null&&p(i,["customBaseModel"],D);const R=d(n,["experiment"]);R!=null&&p(i,["experiment"],R);const z=d(n,["labels"]);z!=null&&p(i,["labels"],z);const F=d(n,["outputUri"]);F!=null&&p(i,["outputUri"],F);const ie=d(n,["pipelineJob"]);ie!=null&&p(i,["pipelineJob"],ie);const K=d(n,["serviceAccount"]);K!=null&&p(i,["serviceAccount"],K);const Y=d(n,["tunedModelDisplayName"]);Y!=null&&p(i,["tunedModelDisplayName"],Y);const fe=d(n,["veoTuningSpec"]);return fe!=null&&p(i,["veoTuningSpec"],fe),i}function d1(n,e){const i={},s=d(n,["sdkHttpResponse"]);s!=null&&p(i,["sdkHttpResponse"],s);const r=d(n,["name"]);r!=null&&p(i,["name"],r);const c=d(n,["metadata"]);c!=null&&p(i,["metadata"],c);const f=d(n,["done"]);f!=null&&p(i,["done"],f);const h=d(n,["error"]);return h!=null&&p(i,["error"],h),i}function H0(n,e){const i={},s=d(n,["gcsUri"]);s!=null&&p(i,["validationDatasetUri"],s);const r=d(n,["vertexDatasetResource"]);return r!=null&&p(i,["validationDatasetUri"],r),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f1 extends Kn{constructor(e){super(),this.apiClient=e,this.get=async i=>await this.getInternal(i),this.list=async(i={})=>new Ka($n.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(i),i),this.tune=async i=>{var s;if(this.apiClient.isVertexAI())if(i.baseModel.startsWith("projects/")){const r={tunedModelName:i.baseModel};!((s=i.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(r.checkpointId=i.config.preTunedModelCheckpointId);const c=Object.assign(Object.assign({},i),{preTunedModel:r});return c.baseModel=void 0,await this.tuneInternal(c)}else{const r=Object.assign({},i);return await this.tuneInternal(r)}else{const r=Object.assign({},i),c=await this.tuneMldevInternal(r);let f="";return c.metadata!==void 0&&c.metadata.tunedModel!==void 0?f=c.metadata.tunedModel:c.name!==void 0&&c.name.includes("/operations/")&&(f=c.name.split("/operations/")[0]),{name:f,state:bu.JOB_STATE_QUEUED}}}}async getInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=t1(e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>_u(v))}else{const m=e1(e);return h=pe("{name}",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>Vg(v))}}async listInternal(e){var i,s,r,c;let f,h="",y={};if(this.apiClient.isVertexAI()){const m=s1(e);return h=pe("tuningJobs",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=r1(v),S=new S0;return Object.assign(S,b),S})}else{const m=i1(e);return h=pe("tunedModels",m._url),y=m._query,delete m._url,delete m._query,f=this.apiClient.request({path:h,queryParams:y,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),f.then(v=>{const b=o1(v),S=new S0;return Object.assign(S,b),S})}}async cancel(e){var i,s,r,c;let f="",h={};if(this.apiClient.isVertexAI()){const y=$C(e);f=pe("{name}:cancel",y._url),h=y._query,delete y._url,delete y._query,await this.apiClient.request({path:f,queryParams:h,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const y=QC(e);f=pe("{name}:cancel",y._url),h=y._query,delete y._url,delete y._query,await this.apiClient.request({path:f,queryParams:h,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal})}}async tuneInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI()){const h=WC(e,e);return c=pe("tuningJobs",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>_u(y))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var i,s;let r,c="",f={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const h=ZC(e);return c=pe("tunedModels",h._url),f=h._query,delete h._url,delete h._query,r=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(y=>y.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:y.headers},v})),r.then(y=>d1(y))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p1{async download(e,i){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const m1=1024*1024*8,h1=3,g1=1e3,y1=2,_r="x-goog-upload-status";async function x1(n,e,i){var s;const r=await Bg(n,e,i),c=await(r==null?void 0:r.json());if(((s=r==null?void 0:r.headers)===null||s===void 0?void 0:s[_r])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function v1(n,e,i){var s;const r=await Bg(n,e,i),c=await(r==null?void 0:r.json());if(((s=r==null?void 0:r.headers)===null||s===void 0?void 0:s[_r])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const f=mg(c),h=new Gu;return Object.assign(h,f),h}async function Bg(n,e,i){var s,r;let c=0,f=0,h=new Su(new Response),y="upload";for(c=n.size;f<c;){const m=Math.min(m1,c-f),v=n.slice(f,f+m);f+m>=c&&(y+=", finalize");let b=0,S=g1;for(;b<h1&&(h=await i.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":String(f),"Content-Length":String(m)}}}),!(!((s=h==null?void 0:h.headers)===null||s===void 0)&&s[_r]));)b++,await S1(S),S=S*y1;if(f+=m,((r=h==null?void 0:h.headers)===null||r===void 0?void 0:r[_r])!=="active")break;if(c<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return h}async function b1(n){return{size:n.size,type:n.type}}function S1(n){return new Promise(e=>setTimeout(e,n))}class N1{async upload(e,i,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await x1(e,i,s)}async uploadToFileSearchStore(e,i,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await v1(e,i,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await b1(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w1{create(e,i,s){return new E1(e,i,s)}}class E1{constructor(e,i,s){this.url=e,this.headers=i,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z0="x-goog-api-key";class T1{constructor(e){this.apiKey=e}async addAuthHeaders(e,i){if(e.get(z0)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(z0,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C1="gl-node/";class Kt{constructor(e){var i;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(i=e.vertexai)!==null&&i!==void 0?i:!1,this.apiKey=e.apiKey;const s=yS(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const r=new T1(this.apiKey);this.apiClient=new zT({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:C1+"web",uploader:new N1,downloader:new p1}),this.models=new lC(this.apiClient),this.live=new nC(this.apiClient,r,new w1),this.batches=new HN(this.apiClient),this.chats=new bw(this.models,this.apiClient),this.caches=new yw(this.apiClient),this.files=new Dw(this.apiClient),this.operations=new cC(this.apiClient),this.authTokens=new EC(this.apiClient),this.tunings=new f1(this.apiClient),this.fileSearchStores=new JC(this.apiClient)}}const Gg="text-embedding-004",Ta=768,_1=n=>new Promise((e,i)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>{const c=s.result.split(",")[1];e({inlineData:{data:c,mimeType:n.type}})},s.onerror=r=>i(r)}),vn=async n=>{var e,i;if(!n||n.trim()==="")return new Array(Ta).fill(0);try{const r=await new Kt({apiKey:void 0}).models.embedContent({model:Gg,contents:[{parts:[{text:n}]}]});if((i=(e=r.embeddings)==null?void 0:e[0])!=null&&i.values)return r.embeddings[0].values;throw new Error("No embedding values returned from embedding service.")}catch(s){return console.error("Error generating embedding:",s),new Array(Ta).fill(0)}},A1=async n=>{var e,i;try{const s=new Kt({apiKey:void 0}),r=await _1(n),c=await s.models.embedContent({model:Gg,contents:[{parts:[r]}]});if((i=(e=c.embeddings)==null?void 0:e[0])!=null&&i.values)return c.embeddings[0].values;throw new Error("No embedding values returned from image embedding service.")}catch(s){return console.error("Error generating image embedding:",s),new Array(Ta).fill(0)}},I1=async(n,e,i=.7,s=.3)=>{const r=await vn(n);if(!e)return r;const c=await A1(e);return r.map((f,h)=>f*i+c[h]*s)},fu=["users","shops","customers","suppliers","products","items","inventory","batches","sales","drivers","visual","marketplace","dan_inventory"],D1="58fc3ff2-2f13-11ef-b75e-0242ac110002",Ar={size:Ta,distance:"Cosine"},M1=n=>{let e=n.trim();for(;e.endsWith("/");)e=e.slice(0,-1);return e},O0=M1("/qdrant"),he=O0?new pS({url:O0}):null;let de=null,Qi=null,Lr=null;const F0=n=>{const e=de;de=(n==null?void 0:n.id)||null,Qi=(n==null?void 0:n.name)||null,n!=null&&n.contactEmail,n!=null&&n.location,Lr=(n==null?void 0:n.qdrantNamespace)||null,e!==de&&console.log(`[Core] setActiveShopContext: ${e||"null"} -> ${de||"null"}`)},R1={users:{userId:{type:"keyword"},displayName:{type:"keyword"},contactEmail:{type:"keyword"},email:{type:"keyword"},shopId:{type:"keyword"},isVerified:{type:"bool"},isDriverVerified:{type:"bool"}},shops:{shopId:{type:"keyword"},userId:{type:"keyword"},name:{type:"keyword"}},suppliers:{supplierId:{type:"keyword"},shopId:{type:"keyword"},linkedUserId:{type:"keyword"},name:{type:"keyword"}},products:{productId:{type:"keyword"},category:{type:"keyword"},manufacturer:{type:"keyword"},defaultSupplierId:{type:"keyword"}},items:{inventoryUuid:{type:"keyword"},shopId:{type:"keyword"},productId:{type:"keyword"},batchId:{type:"keyword"},supplierId:{type:"keyword"},status:{type:"keyword"},quantity:{type:"integer"},expiration:{type:"keyword"}},batches:{batchId:{type:"keyword"},shopId:{type:"keyword"},supplierId:{type:"keyword"},deliveryDate:{type:"keyword"},inventoryDate:{type:"keyword"}},sales:{saleId:{type:"keyword"},shopId:{type:"keyword"},timestamp:{type:"keyword"}},customers:{customerId:{type:"keyword"},userId:{type:"keyword"},name:{type:"keyword"}},drivers:{driverId:{type:"keyword"},userId:{type:"keyword"},status:{type:"keyword"}},visual:{shopId:{type:"keyword"},productId:{type:"keyword"},fieldName:{type:"keyword"}},marketplace:{listingId:{type:"keyword"},shopId:{type:"keyword"},productId:{type:"keyword"}},dan_inventory:{inventoryUuid:{type:"keyword"},shopId:{type:"keyword"},productId:{type:"keyword"},productName:{type:"keyword"},locationBucket:{type:"keyword"},shareScope:{type:"keyword"},expirationDate:{type:"keyword"}}},hn=new Map,Hi=n=>n?typeof n=="string"?n:n.message||n.statusText||JSON.stringify(n):"Unknown error",It=(n,e)=>{new Date().toISOString();const i=`[Qdrant] ${e}`;n==="error"?console.error(i):n==="warn"?console.warn(i):console.info(i)},U1=n=>{if(!n)return{params:null,named:!1,vectorName:null};if(typeof n.size=="number")return{params:n,named:!1,vectorName:null};const e=Object.keys(n||{});if("default"in n&&n.default&&typeof n.default.size=="number"){const i=e.some(s=>s!=="default");return{params:n.default,named:i,vectorName:i?"default":null}}if(e.length>=1){const i=e.find(s=>n[s]&&typeof n[s].size=="number");if(i)return{params:n[i],named:i!=="default",vectorName:i}}return{params:null,named:!0,vectorName:null}},P1=async n=>{if(!he)return!1;const e=R1[n];if(!e)return!0;try{const i=await he.getCollection(n),s=(i==null?void 0:i.payload_schema)||{};for(const[r,c]of Object.entries(e)){const f=s==null?void 0:s[r],h=f==null?void 0:f.data_type;if(h!==c.type){if(f&&h!==c.type)try{await he.deletePayloadIndex(n,r),It("info",`Deleted existing index '${n}.${r}' (wrong type)`)}catch(y){It("warn",`Failed to delete index '${n}.${r}': ${Hi(y)}`)}try{await he.createPayloadIndex(n,{field_name:r,field_schema:c}),It("info",`Created index '${n}.${r}' (${c.type})`)}catch(y){It("error",`Failed to create index '${n}.${r}': ${Hi(y)}`)}}}return!0}catch(i){return It("error",`Failed to ensure indexes for '${n}': ${Hi(i)}`),!1}},q1=async n=>{var e,i;if(!he)return{exists:!1,valid:!1,vectorConfig:null};try{const s=await he.getCollection(n),{params:r,named:c,vectorName:f}=U1((i=(e=s==null?void 0:s.config)==null?void 0:e.params)==null?void 0:i.vectors),h=(r==null?void 0:r.size)===Ar.size&&(r==null?void 0:r.distance)===Ar.distance;return{exists:!0,valid:h,vectorConfig:h?{named:c,vectorName:c?f||"default":null}:null}}catch(s){return s.status===404?{exists:!1,valid:!1,vectorConfig:null}:(It("error",`Error verifying collection '${n}': ${Hi(s)}`),{exists:!1,valid:!1,vectorConfig:null})}},Hg=async n=>{if(!he)return!1;const e=hn.get(n);if(e!=null&&e.ready)return!0;if(e!=null&&e.promise)return e.promise;e||hn.set(n,{ready:!1,promise:null,vectorConfig:null});const i=(async()=>{try{const{exists:s,valid:r,vectorConfig:c}=await q1(n);return s?r?(hn.set(n,{ready:!1,promise:null,vectorConfig:c}),await P1(n)?(hn.set(n,{ready:!0,promise:null,vectorConfig:c}),It("info",`Collection '${n}' is ready`),!0):(hn.set(n,{ready:!1,promise:null,vectorConfig:c}),!1)):(It("error",`Collection '${n}' has invalid configuration. Expected: size=${Ar.size}, distance=${Ar.distance}`),hn.set(n,{ready:!1,promise:null,vectorConfig:null}),!1):(It("error",`Collection '${n}' does not exist. Please run setup script first.`),hn.set(n,{ready:!1,promise:null,vectorConfig:null}),!1)}catch(s){return It("error",`Failed to ensure collection '${n}': ${Hi(s)}`),hn.set(n,{ready:!1,promise:null,vectorConfig:null}),!1}finally{const s=hn.get(n);s&&(s.promise=null)}})();return hn.set(n,{ready:!1,promise:i,vectorConfig:null}),i},zg=async()=>{if(!he){It("warn","Qdrant client not available");return}It("info","Ensuring all base collections are ready...");const n=await Promise.allSettled(fu.map(s=>Hg(s))),e=[],i=[];n.forEach((s,r)=>{const c=fu[r];if(s.status==="fulfilled"&&s.value)e.push(c);else{i.push(c);const f=s.status==="rejected"?Hi(s.reason):"Not ready";It("warn",`Collection '${c}' failed: ${f}`)}}),It("info",`Collections ready: ${e.length}/${fu.length}. Ready: ${e.join(", ")}${i.length>0?` | Failed: ${i.join(", ")}`:""}`)},Og=n=>{var e;return((e=hn.get(n))==null?void 0:e.vectorConfig)||null},Ke=async n=>{const e=await Hg(n);return e||It("warn",`Collection '${n}' is not ready  operation will be skipped`),e},k1=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function L1(n){return typeof n=="string"&&k1.test(n)}function Y0(n){if(!L1(n))throw TypeError("Invalid UUID");let e;return Uint8Array.of((e=parseInt(n.slice(0,8),16))>>>24,e>>>16&255,e>>>8&255,e&255,(e=parseInt(n.slice(9,13),16))>>>8,e&255,(e=parseInt(n.slice(14,18),16))>>>8,e&255,(e=parseInt(n.slice(19,23),16))>>>8,e&255,(e=parseInt(n.slice(24,36),16))/1099511627776&255,e/4294967296&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255)}const Et=[];for(let n=0;n<256;++n)Et.push((n+256).toString(16).slice(1));function Fg(n,e=0){return(Et[n[e+0]]+Et[n[e+1]]+Et[n[e+2]]+Et[n[e+3]]+"-"+Et[n[e+4]]+Et[n[e+5]]+"-"+Et[n[e+6]]+Et[n[e+7]]+"-"+Et[n[e+8]]+Et[n[e+9]]+"-"+Et[n[e+10]]+Et[n[e+11]]+Et[n[e+12]]+Et[n[e+13]]+Et[n[e+14]]+Et[n[e+15]]).toLowerCase()}let pu;const j1=new Uint8Array(16);function V1(){if(!pu){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");pu=crypto.getRandomValues.bind(crypto)}return pu(j1)}function B1(n){n=unescape(encodeURIComponent(n));const e=new Uint8Array(n.length);for(let i=0;i<n.length;++i)e[i]=n.charCodeAt(i);return e}const G1="6ba7b810-9dad-11d1-80b4-00c04fd430c8",H1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function z1(n,e,i,s,r,c){const f=typeof i=="string"?B1(i):i,h=typeof s=="string"?Y0(s):s;if(typeof s=="string"&&(s=Y0(s)),(s==null?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+f.length);if(y.set(h),y.set(f,h.length),y=e(y),y[6]=y[6]&15|n,y[8]=y[8]&63|128,r){c=c||0;for(let m=0;m<16;++m)r[c+m]=y[m];return r}return Fg(y)}const O1=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),J0={randomUUID:O1};function F1(n,e,i){var r;n=n||{};const s=n.random??((r=n.rng)==null?void 0:r.call(n))??V1();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Fg(s)}function xt(n,e,i){return J0.randomUUID&&!n?J0.randomUUID():F1(n)}function Y1(n,e,i,s){switch(n){case 0:return e&i^~e&s;case 1:return e^i^s;case 2:return e&i^e&s^i&s;case 3:return e^i^s}}function mu(n,e){return n<<e|n>>>32-e}function J1(n){const e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520],s=new Uint8Array(n.length+1);s.set(n),s[n.length]=128,n=s;const r=n.length/4+2,c=Math.ceil(r/16),f=new Array(c);for(let h=0;h<c;++h){const y=new Uint32Array(16);for(let m=0;m<16;++m)y[m]=n[h*64+m*4]<<24|n[h*64+m*4+1]<<16|n[h*64+m*4+2]<<8|n[h*64+m*4+3];f[h]=y}f[c-1][14]=(n.length-1)*8/Math.pow(2,32),f[c-1][14]=Math.floor(f[c-1][14]),f[c-1][15]=(n.length-1)*8&4294967295;for(let h=0;h<c;++h){const y=new Uint32Array(80);for(let C=0;C<16;++C)y[C]=f[h][C];for(let C=16;C<80;++C)y[C]=mu(y[C-3]^y[C-8]^y[C-14]^y[C-16],1);let m=i[0],v=i[1],b=i[2],S=i[3],w=i[4];for(let C=0;C<80;++C){const I=Math.floor(C/20),P=mu(m,5)+Y1(I,v,b,S)+w+e[I]+y[C]>>>0;w=S,S=b,b=mu(v,30)>>>0,v=m,m=P}i[0]=i[0]+m>>>0,i[1]=i[1]+v>>>0,i[2]=i[2]+b>>>0,i[3]=i[3]+S>>>0,i[4]=i[4]+w>>>0}return Uint8Array.of(i[0]>>24,i[0]>>16,i[0]>>8,i[0],i[1]>>24,i[1]>>16,i[1]>>8,i[1],i[2]>>24,i[2]>>16,i[2]>>8,i[2],i[3]>>24,i[3]>>16,i[3]>>8,i[3],i[4]>>24,i[4]>>16,i[4]>>8,i[4])}function Ju(n,e,i,s){return z1(80,J1,n,e,i,s)}Ju.DNS=G1;Ju.URL=H1;const Dt=(n,e)=>Ju(`${n}:${e}`,D1),Cn=n=>{const e=String(n||"default"),i=new Array(Ta).fill(0);for(let s=0;s<Ta;s++)i[s]=(e.charCodeAt(s%e.length)||0)%100/1e3;return i},Mt=(n,e,i)=>{const s=()=>Cn(e);if(!Array.isArray(n))return s();if(n.length!==Ta)return console.warn(`[Qdrant] ${i}: Vector length ${n.length} != ${Ta}. Using placeholder.`),s();for(let r=0;r<n.length;r++){const c=n[r];if(typeof c!="number"||!Number.isFinite(c))return console.warn(`[Qdrant] ${i}: Invalid vector value at index ${r}: ${c}. Using placeholder.`),s()}return n},Xt=(n,e)=>{const i=Og(n);return i!=null&&i.named?{vectors:{[i.vectorName||"default"]:e}}:{vector:e}},Q1=(n,e)=>{const i=Og(n);return i!=null&&i.named?{name:i.vectorName||"default",vector:e}:e},Yg=(n,e)=>!e||n==="items"?null:{key:"shopId",match:{value:e}},lt=async(n,e)=>{if(!he)return[];if(!await Ke(n))return[];const i=[];let s,r=3,c=null;if(e&&(typeof e=="string"?c=e:typeof e=="object"&&e!==null&&"id"in e?(c=e.id||null,console.warn(`[Qdrant] fetchAllPoints received shopFilter as object instead of string. Extracted id: ${c}`)):console.warn(`[Qdrant] fetchAllPoints received invalid shopFilter type: ${typeof e}`)),c&&n==="items"){const y=[];let m;do try{const b=await he.scroll(n,{with_payload:!0,limit:100,offset:m??void 0});y.push(...(b==null?void 0:b.points)??[]),m=(b==null?void 0:b.next_page_offset)??void 0}catch(b){console.error("[Qdrant] Error fetching items for JavaScript filter:",b);break}while(m);return y.filter(b=>{var w;const S=(w=b.payload)==null?void 0:w.shopId;return typeof S=="string"?S===c:S&&typeof S=="object"&&"id"in S?S.id===c:!1})}const f=Yg(n,c),h=f?{must:[f]}:void 0;do{try{const y=await he.scroll(n,{with_payload:!0,limit:100,offset:s??void 0,filter:h}),m=(y==null?void 0:y.points)??[];i.push(...m),s=(y==null?void 0:y.next_page_offset)??void 0}catch(y){if(console.error(`[Qdrant] Scroll error in '${n}' (Retry ${r}, Filter: ${JSON.stringify(h)}):`,y),(y==null?void 0:y.status)===400&&r>0){console.info(`[Qdrant] Retrying scroll in '${n}'...`),r--,await new Promise(m=>setTimeout(m,1e3));continue}s=void 0}if(!s||i.length>1e5)break}while(s);return i},$1=async(n,e,i,s=10)=>{if(!he)return[];if(!await Ke(n))return[];const r=[];if(i.shopId){const c=typeof i.shopId=="string"?i.shopId:i.shopId&&typeof i.shopId=="object"&&i.shopId!==null&&"id"in i.shopId?i.shopId.id:null;if(c){const f=Yg(n,c);f&&r.push(f)}}i.status&&r.push({key:"status",match:{value:i.status}}),i.quantityMin!==void 0&&r.push({key:"quantity",range:{gt:i.quantityMin}}),Object.entries(i).forEach(([c,f])=>{!["shopId","status","quantityMin"].includes(c)&&f!==void 0&&r.push({key:c,match:{value:f}})});try{const c=await he.search(n,{vector:e,limit:s,with_payload:!0,filter:r.length>0?{must:r}:void 0});return Array.isArray(c)?c:(c==null?void 0:c.points)??[]}catch(c){return console.error(`[Qdrant] Search failed in '${n}':`,c),[]}},Jg=n=>{const e=n.payload;return{id:(e==null?void 0:e.productId)||String(n.id),name:(e==null?void 0:e.name)||"Unnamed Product",manufacturer:(e==null?void 0:e.manufacturer)||"",category:(e==null?void 0:e.category)||"",description:(e==null?void 0:e.description)||"",defaultSupplierId:(e==null?void 0:e.defaultSupplierId)||null,images:(e==null?void 0:e.images)||[],audit:(e==null?void 0:e.audit)||[],embeddings:(e==null?void 0:e.embeddings)||void 0}},Ws=async()=>he?(await lt("products",null)).map(Jg):[],Qu=async(n,e)=>{if(!he||!await Ke("products"))return;const i=Array.isArray(n.embeddings)&&n.embeddings.length>0,s=Mt(i?n.embeddings:null,n.id,`products:${n.id}`),r=i&&s===n.embeddings?s:void 0,c=Dt("products",n.id),f={productId:n.id,name:n.name,manufacturer:n.manufacturer,category:n.category,description:n.description||"",defaultSupplierId:n.defaultSupplierId||null,images:n.images||[],audit:e?[...n.audit||[],e]:n.audit||[],embeddings:r};await he.upsert("products",{wait:!0,points:[{id:c,...Xt("products",s),payload:f}]})},$i=async n=>{var s;const e={id:xt(),name:n.name.trim(),manufacturer:n.manufacturer.trim(),category:n.category.trim(),description:((s=n.description)==null?void 0:s.trim())||"",defaultSupplierId:n.defaultSupplierId||null,images:n.images||[],audit:[],embeddings:n.embeddings||(n.name?await vn(n.name):Cn(xt()))},i=de?{userId:de,shopId:de,action:"create",timestamp:new Date().toISOString()}:void 0;return await Qu(e,i),e},Qg=async(n,e)=>{var h,y,m;const s=(await Ws()).find(v=>v.id===n);if(!s)throw new Error(`Product with ID ${n} not found`);const r=e.embeddings||(e.name&&e.name!==s.name?await vn(e.name):s.embeddings),c={...s,name:((h=e.name)==null?void 0:h.trim())||s.name,manufacturer:((y=e.manufacturer)==null?void 0:y.trim())||s.manufacturer,category:((m=e.category)==null?void 0:m.trim())||s.category,description:e.description!==void 0?e.description.trim():s.description,defaultSupplierId:e.defaultSupplierId!==void 0?e.defaultSupplierId:s.defaultSupplierId,images:e.images!==void 0?e.images:s.images,embeddings:r},f=de?{userId:de,shopId:de,action:"update",timestamp:new Date().toISOString()}:void 0;return await Qu(c,f),c},$g=async n=>{he&&await Ke("products")&&await he.delete("products",{wait:!0,points:[Dt("products",n)]})},Kg=async(n,e=24)=>{if(!he)return[];const i=n.trim();if(!i)return(await Ws()).slice(0,e);if(!await Ke("products"))return[];const s=await vn(i),r=Mt(s,`products:search:${i}`,`products-search:${Date.now()}`);return(await he.search("products",{vector:r,limit:e,with_payload:!0})).map(Jg).filter(f=>!!f.name)},Xg=async n=>he?(await lt("batches",n)).map(i=>{const s=i.payload;return{id:(s==null?void 0:s.batchId)||String(i.id),shopId:s==null?void 0:s.shopId,supplierId:s==null?void 0:s.supplierId,deliveryDate:s==null?void 0:s.deliveryDate,inventoryDate:s==null?void 0:s.inventoryDate,invoiceNumber:s==null?void 0:s.invoiceNumber,documents:(s==null?void 0:s.documents)||[],lineItems:(s==null?void 0:s.lineItems)||[],createdAt:s==null?void 0:s.createdAt,createdByUserId:s==null?void 0:s.createdByUserId}}):[],Zg=async()=>de?Xg(de):[],$u=async n=>{if(!he||!await Ke("batches"))return;const e=Mt(Cn(n.id),n.id,`batches:${n.id}`),i=Dt("batches",n.id),s={batchId:n.id,shopId:n.shopId,supplierId:n.supplierId||null,deliveryDate:n.deliveryDate,inventoryDate:n.inventoryDate||null,invoiceNumber:n.invoiceNumber||null,documents:n.documents||[],lineItems:n.lineItems||[],createdAt:n.createdAt,createdByUserId:n.createdByUserId};await he.upsert("batches",{wait:!0,points:[{id:i,...Xt("batches",e),payload:s}]})},Xa=async n=>{if(!he||!await Ke("users"))return;const e=n.qdrantUserId||n.userId,i=Dt("users",e);let s={};try{const f=await he.retrieve("users",{ids:[i],with_payload:!0});if(f.points&&f.points.length>0){const h=f.points[0].payload;s={isVerified:h.isVerified,isDriverVerified:h.isDriverVerified}}}catch{}const r={userId:n.userId,displayName:n.displayName||n.email||n.userId,contactEmail:n.contactEmail||n.email||"",email:n.email||n.contactEmail||"",shopId:n.shopId||de||null,isVerified:n.isVerified!==void 0?n.isVerified:s.isVerified,isDriverVerified:n.isDriverVerified!==void 0?n.isDriverVerified:s.isDriverVerified},c=Mt(Cn(e),e,`users:${e}`);await he.upsert("users",{wait:!0,points:[{id:i,payload:r,...Xt("users",c)}]})},Wg=async()=>{},ey=async n=>{if(!he||!await Ke("shops"))return;const e=Mt(Cn(n.id),n.id,`shops:${n.id}`),i=Dt("shops",n.id),s={shopId:n.id,userId:n.userId||"",name:n.name,contact:n.contactEmail||"",contactEmail:n.contactEmail||"",qdrantNamespace:n.qdrantNamespace||null,metadata:n.location?{location:n.location}:{}};await he.upsert("shops",{wait:!0,points:[{id:i,...Xt("shops",e),payload:s}]})},ty=async n=>{if(!he||!await Ke("customers"))return;const e=Mt(Cn(n.id),n.id,`customers:${n.id}`),i=Dt("customers",n.id);await he.upsert("customers",{wait:!0,points:[{id:i,...Xt("customers",e),payload:{customerId:n.id,userId:n.userId||null,name:n.fullName,contact:n.contactEmail||""}}]})},jr=async n=>{if(!he||!await Ke("drivers"))return;const e=Mt(Cn(n.id),n.id,`drivers:${n.id}`),i=Dt("drivers",n.id);await he.upsert("drivers",{wait:!0,points:[{id:i,...Xt("drivers",e),payload:{driverId:n.id,userId:n.userId||null,name:n.fullName,contact:n.contactEmail||"",status:n.status||"pending"}}]})},Ku=async n=>{if(!he||!await Ke("suppliers"))return;const e=n.name?await vn(n.name):null,i=Mt(e,n.id,`suppliers:${n.id}`),s=Dt("suppliers",n.id),r={supplierId:n.id,name:n.name,contact:n.contactEmail||"",contactEmail:n.contactEmail||"",shopId:n.shopId||null,linkedUserId:n.linkedUserId||n.userId||null,metadata:n.metadata||{},embeddings:i};await he.upsert("suppliers",{wait:!0,points:[{id:s,...Xt("suppliers",i),payload:r}]})},_a=async()=>!he||!de?[]:(await lt("suppliers",null)).map(e=>{const i=e.payload;return{id:(i==null?void 0:i.supplierId)||String(e.id),shopId:(i==null?void 0:i.shopId)||null,linkedUserId:(i==null?void 0:i.linkedUserId)||(i==null?void 0:i.userId)||null,name:(i==null?void 0:i.name)||"Supplier",contact:(i==null?void 0:i.contact)||"",contactEmail:(i==null?void 0:i.contact)||(i==null?void 0:i.contactEmail)||"",metadata:(i==null?void 0:i.metadata)||{}}}).filter(e=>e.shopId===de||e.linkedUserId!==null),Ki=async n=>{if(!de)throw new Error("No shop selected.");const e=xt();return await Ku({id:e,name:n.name,contactEmail:n.contactEmail,shopId:de,linkedUserId:null}),{id:e,shopId:de,linkedUserId:null,name:n.name,contact:n.contactEmail,contactEmail:n.contactEmail,metadata:{}}},ny=async()=>he?await Ke("shops")?(await lt("shops",null)).map(e=>{const i=e.payload;return{id:i.shopId,name:i.name,contactEmail:i.contactEmail||i.contact}}):[]:[],ay=async n=>{if(!he||!await Ke("shops"))return null;try{const e=Dt("shops",n),i=await he.retrieve("shops",{ids:[e],with_payload:!0});if(i.points&&i.points.length>0){const s=i.points[0].payload;return{id:s.shopId,name:s.name,contactEmail:s.contactEmail||s.contact}}return null}catch(e){return console.error("[Users] Error validating shop:",e),null}},hu=new Map,iy=async n=>{if(hu.has(n))return hu.get(n).name;const i=(await lt("products",null)).find(s=>{var r;return((r=s.payload)==null?void 0:r.productId)===n});if(i){const s=i.payload;return hu.set(n,{name:s.name||"unknown product",manufacturer:s.manufacturer||"",category:s.category||""}),s.name||"unknown product"}return"unknown product"},Vr=async(n,e)=>{if(!he||!de||!await Ke("items"))return;const i=n.inventoryUuid||n.qdrantId||xt();n.inventoryUuid||(n.inventoryUuid=i),n.qdrantId||(n.qdrantId=i);const s=new Date().toISOString(),r=n.status||(n.quantity>0?"ACTIVE":"EMPTY"),c=await iy(n.productId),f=await vn(c),h=Mt(f,i,`items:${i}`),y=e||n.scanMetadata||null,m=n.buyPrice??n.costPerUnit??null,v=n.sellPrice??(m?m*1.4:null),b=n.shareScope||["local"],S={inventoryUuid:i,shopId:de,productId:n.productId,batchId:n.batchId||"",supplierId:n.supplierId||void 0,buyPrice:m??void 0,sellPrice:v??void 0,quantity:n.quantity||0,expiration:n.expirationDate||s,location:n.location||void 0,status:r,images:n.images||[],scanMetadata:y,createdByUserId:de,createdAt:n.createdAt||s,updatedAt:n.updatedAt||s,embeddings:h,shareScope:b,shareProofHash:n.shareProofHash};await he.upsert("items",{wait:!0,points:[{id:i,...Xt("items",h),payload:S}]})},sy=async n=>{if(!he)return;const e=n.inventoryUuid||n.qdrantId;if(e){await he.delete("items",{wait:!0,points:[e]});return}de&&await he.delete("items",{wait:!0,filter:{must:[{key:"shopId",match:{value:de}},{key:"productId",match:{value:n.productId}}]}})},K1=async(n,e,i)=>{if(!he||!de||!await Ke("items"))return;const s=new Date().toISOString(),r=new Date(n.deliveryDate),c=new Date(r.setFullYear(r.getFullYear()+1)).toISOString().split("T")[0],f=await Promise.all(e.filter(h=>h.productId&&h.quantity>0).map(async h=>{const y=xt(),m=h.cost||0,v=m*1.4,b=await iy(h.productId),S=await vn(b),w=Mt(S,y,`items:${y}`),C=i==null?void 0:i.get(h.productId),I={inventoryUuid:y,shopId:de,productId:h.productId,batchId:n.id,supplierId:n.supplierId||void 0,buyPrice:m,sellPrice:v,quantity:h.quantity,expiration:c,location:void 0,status:"ACTIVE",images:(C==null?void 0:C.images)||[],scanMetadata:(C==null?void 0:C.scanMetadata)||null,createdByUserId:de,createdAt:s,updatedAt:s,embeddings:w,shareScope:["local"]};return{id:y,...Xt("items",w),payload:I}}));f.length>0&&(await he.upsert("items",{wait:!0,points:f}),console.log(`[Inventory] Added ${f.length} inventory items from batch ${n.id}`))},Xu=async(n,e,i=10)=>{if(!he||!e)return[];if(!await Ke("items"))return[];const s=Mt(n,`${e}-query`,`search:${e}`),r=Q1("items",s);return(await $1("items",r,{shopId:e,quantityMin:0,status:"ACTIVE"},i)).map(f=>{const h=f.payload,y=h==null?void 0:h.shopId,m=typeof y=="string"?y:y&&typeof y=="object"&&y!==null&&"id"in y?y.id:e;return{id:Date.now()+Math.random(),inventoryUuid:h.inventoryUuid||String(f.id),shopId:m,productId:h.productId,batchId:h.batchId,expirationDate:h.expiration,quantity:h.quantity,costPerUnit:h.buyPrice||0,location:h.location||void 0,supplierId:h.supplierId||void 0,buyPrice:h.buyPrice,sellPrice:h.sellPrice,images:h.images||[],scanMetadata:h.scanMetadata,qdrantId:h.inventoryUuid||String(f.id),status:h.status,createdByUserId:h.createdByUserId,createdAt:h.createdAt,updatedAt:h.updatedAt,shareScope:h.shareScope||["local"],shareProofHash:h.shareProofHash}})},oy=async n=>(await lt("items",n)).map(i=>{const s=i.payload,r=s==null?void 0:s.shopId,c=typeof r=="string"?r:r&&typeof r=="object"&&r!==null&&"id"in r?r.id:n;return{id:Date.now()+Math.random(),inventoryUuid:s.inventoryUuid||String(i.id),shopId:c,productId:s.productId,batchId:s.batchId,expirationDate:s.expiration,quantity:s.quantity,costPerUnit:s.buyPrice||0,location:s.location||void 0,supplierId:s.supplierId||void 0,buyPrice:s.buyPrice,sellPrice:s.sellPrice,images:s.images||[],scanMetadata:s.scanMetadata,qdrantId:s.inventoryUuid||String(i.id),status:s.status,createdByUserId:s.createdByUserId,createdAt:s.createdAt,updatedAt:s.updatedAt,shareScope:s.shareScope||["local"],shareProofHash:s.shareProofHash}}).filter(i=>i.quantity>0&&i.status!=="EMPTY"&&i.status!=="EXPIRED"),Zu=async n=>{if(!he||!de||!await Ke("sales"))return;const e=Mt(Cn(n.id),n.id,`sales:${n.id}`),i=Dt("sales",n.id),s=Xt("sales",e);await he.upsert("sales",{wait:!0,points:[{id:i,...s,payload:{saleId:n.id,shopId:de,timestamp:n.timestamp,lineItems:n.items,totalAmount:n.totalAmount}}]})},X1=async(n,e)=>{if(!de)throw new Error("No shop selected.");const i=[];let s=0;const r=1.4,c=[],f=[],h=await oy(de);for(const m of n){let v=m.quantity;const b=e.get(m.productName);if(!b)continue;const S=h.filter(w=>w.productId===b.id&&w.quantity>0).sort((w,C)=>new Date(w.expirationDate).getTime()-new Date(C.expirationDate).getTime());for(const w of S){if(v<=0)break;const C=Math.min(w.quantity,v);w.quantity-=C,v-=C;const I=w.costPerUnit*r;i.push({productId:b.id,quantity:C,priceAtSale:I}),s+=C*I,w.quantity===0?f.push(w):c.push(w)}}const y={id:Date.now(),timestamp:new Date().toISOString(),items:i,totalAmount:s};for(const m of c)await Vr(m);return await Promise.all(f.map(sy)),await Zu(y),console.log(`[Sales] Recorded sale ${y.id} with total $${s.toFixed(2)}.`),y},ry=async n=>(await lt("sales",n)).map(i=>{const s=i.payload;return{id:s.saleId,timestamp:s.timestamp,items:s.lineItems||[],totalAmount:s.totalAmount||0}}),Au=new Map,Z1=async n=>{if(!he||!de||!await Ke("marketplace"))return;const e=Mt(Cn(n.id),n.id,`marketplace:${n.id}`),i=Dt("marketplace",n.id);await he.upsert("marketplace",{wait:!0,points:[{id:i,...Xt("marketplace",e),payload:{shopId:de,listingId:n.id,productId:n.productId,productName:n.productName,quantity:n.quantity,price:n.price}}]})},ly=async n=>{if(!de)throw new Error("No shop selected.");const e={...n,id:Date.now()};Au.set(e.id,e),await Z1(e),console.info(`[Marketplace] Listed ${e.quantity} of ${e.productName}.`)},cy=async()=>Au.size>0?Array.from(Au.values()):de?(await lt("marketplace",de)).map(e=>{const i=e.payload;return{id:i.listingId||Date.now(),productId:i.productId,productName:i.productName,quantity:i.quantity,price:i.price}}):[],W1=async(n,e,i,s)=>{if(!de)throw new Error("No shop selected.");const r=new Date().toISOString().split("T")[0],c={supplier:n.seller.name,deliveryDate:r,inventoryDate:r},f={productName:n.productName,manufacturer:n.manufacturer,category:n.category,expirationDate:"2025-12-31",quantity:e,quantityType:n.quantityType,costPerUnit:n.price,location:"Marketplace Intake"};await i(c,[f]);const h={id:Date.now(),timestamp:new Date().toISOString(),items:[{productId:n.productName.toLowerCase().trim().replace(/\s+/g,"-"),quantity:e,priceAtSale:n.price}],totalAmount:n.price*e,source:{type:"marketplace",supplierName:n.seller.name,listingId:n.listingId}};await s(h),console.info(`[Marketplace] Purchased ${e} of ${n.productName} from ${n.seller.name}.`)},e2=new Map,uy=n=>n.toLowerCase().trim().replace(/\s+/g,"-"),t2=n=>`${de||"global"}:${n}`,n2=n=>new Promise((e,i)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>e(s.result.split(",")[1]),s.onerror=r=>i(r)}),a2=(n,e)=>n&&n.trim().length>0?n.trim():e?uy(e):"unlabeled-product",Wu=async(n,e,i,s)=>{const r=a2(s==null?void 0:s.productId,n),c=t2(r),f=await n2(i),h=`${c}-${e}`;if(e2.set(h,{imageBase64:f,mimeType:i.type}),!he||!de||!await Ke("visual"))return h;const y=Mt(Cn(h),h,`visual:${h}`);try{await he.upsert("visual",{wait:!0,points:[{id:Dt("visual",h),...Xt("visual",y),payload:{shopId:de,productId:c,fieldName:e,imageBase64:f,mimeType:i.type,source:(s==null?void 0:s.source)||"manual",batchId:(s==null?void 0:s.batchId)||null,metadata:(s==null?void 0:s.metadata)||null,capturedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}]})}catch(m){console.error("[Qdrant] Failed to upsert visual feature:",m)}return h},Q0=n=>{const e=de||"global";return n.startsWith(`${e}:`)?n:`${e}:${n}`},dy=async n=>{const e=new Map;if(!de||!he)return e;const i=new Set;n.includes(":")?i.add(n):(i.add(Q0(n)),i.add(Q0(uy(n))));const s=async r=>{let c;do{const f=await he.scroll("visual",{filter:{must:[{key:"shopId",match:{value:de}},{key:"productId",match:{value:r}}]},with_payload:!0,limit:50,offset:c??void 0});((f==null?void 0:f.points)??[]).forEach(y=>{const m=y.payload;m!=null&&m.fieldName&&(m!=null&&m.imageBase64)&&(m!=null&&m.mimeType)&&e.set(m.fieldName,{imageBase64:m.imageBase64,mimeType:m.mimeType})}),c=(f==null?void 0:f.next_page_offset)??void 0}while(c)};for(const r of i)if(await s(r),e.size>0)break;return e},Ja="dan_inventory",fy=async n=>{if(!he||!await Ke(Ja))return;const e=n.vector||await vn(`${n.productName} ${n.locationBucket||""} ${n.quantity}`),i=Mt(e,n.inventoryUuid,`${Ja}:${n.inventoryUuid}`),s={inventoryUuid:n.inventoryUuid,productId:n.productId,productName:n.productName,quantity:n.quantity,expirationDate:n.expirationDate,locationBucket:n.locationBucket||null,sellPrice:n.sellPrice??null,shopId:n.shopId,shopName:n.shopName||null,shareScope:n.shareScope,proofHash:n.proofHash,updatedAt:n.updatedAt||new Date().toISOString()};await he.upsert(Ja,{wait:!0,points:[{id:n.inventoryUuid,...Xt(Ja,i),payload:s}]})},i2=async n=>{he&&await Ke(Ja)&&await he.delete(Ja,{wait:!0,points:[n]})},s2=async()=>(await lt(Ja,null)).map(e=>{var s;const i=e.payload;return{inventoryUuid:(i==null?void 0:i.inventoryUuid)||String(e.id),shopId:(i==null?void 0:i.shopId)||"",shopName:(i==null?void 0:i.shopName)||null,productId:(i==null?void 0:i.productId)||"",productName:(i==null?void 0:i.productName)||"",quantity:(i==null?void 0:i.quantity)||0,expirationDate:(i==null?void 0:i.expirationDate)||"",locationBucket:(i==null?void 0:i.locationBucket)||null,sellPrice:(i==null?void 0:i.sellPrice)??null,shareScope:(i==null?void 0:i.shareScope)||["local"],proofHash:i==null?void 0:i.proofHash,updatedAt:(i==null?void 0:i.updatedAt)||((s=e.payload)==null?void 0:s.updatedAt)||""}}).filter(e=>e.quantity>0).sort((e,i)=>{const s=new Date(e.expirationDate).getTime(),r=new Date(i.expirationDate).getTime();return s-r}),qe={products:new Map,batches:new Map,stockItems:new Map,salesTransactions:new Map,productVisualFeatures:new Map,marketplaceListings:new Map};let Iu=!1;const py=n=>{Iu=n},Du=n=>n.toLowerCase().trim().replace(/\s+/g,"-"),o2=async(n,e)=>{const i=new Map,s=await n();for(const h of s){if(h.quantity<=0||h.status==="EMPTY"||h.status==="EXPIRED"||h.status&&h.status!=="ACTIVE")continue;const y=qe.products.get(h.productId);if(!y)continue;const m=i.get(y.id);if(m)m.totalQuantity+=h.quantity,h.expirationDate<m.earliestExpiration&&(m.earliestExpiration=h.expirationDate),h.supplierId&&m.supplierIdsSet.add(h.supplierId),m.batches.push({batchId:String(h.batchId),quantity:h.quantity,expirationDate:h.expirationDate}),m.totalCost+=h.costPerUnit*h.quantity,m.itemCount+=h.quantity;else{const v=new Set;h.supplierId&&v.add(h.supplierId),i.set(y.id,{productId:y.id,productName:y.name,manufacturer:y.manufacturer,category:y.category,totalQuantity:h.quantity,quantityType:"units",earliestExpiration:h.expirationDate,supplierIdsSet:v,batches:[{batchId:String(h.batchId),quantity:h.quantity,expirationDate:h.expirationDate}],totalCost:h.costPerUnit*h.quantity,itemCount:h.quantity,averageCostPerUnit:0})}}const r=await e(),c=new Set(r.map(h=>h.id)),f=[];return i.forEach(h=>{if(!(h.supplierIdsSet.size===0||Array.from(h.supplierIdsSet).some(w=>c.has(w))))return;const{totalCost:m,itemCount:v,supplierIdsSet:b,...S}=h;f.push({...S,supplierIds:Array.from(b).filter(w=>c.has(w)),averageCostPerUnit:v>0?m/v:0})}),f.sort((h,y)=>h.productName.localeCompare(y.productName))},my=()=>{qe.products.clear(),qe.batches.clear(),qe.stockItems.clear(),qe.salesTransactions.clear(),qe.marketplaceListings.clear(),qe.productVisualFeatures.clear()},Ir=async()=>{if(console.log("[DataLoader] loadDataFromQdrant called, activeShopId:",de),!de){console.warn("[DataLoader] activeShopId is not set, cannot load data");return}const n=typeof de=="string"?de:de&&typeof de=="object"&&de!==null&&"id"in de?(()=>{const v=de;return console.warn(`[DataLoader] activeShopId is an object instead of string. Extracting id: ${v.id}`),v.id})():null;if(!n){console.warn("[DataLoader] Could not extract shopIdString from activeShopId");return}console.log(`[DataLoader] Loading data for shopId: ${n}`);const[e,i,s,r,c,f]=await Promise.all([lt("suppliers",n),lt("products",null),lt("batches",n),lt("items",n),lt("sales",n),lt("marketplace",n)]);if(console.log(`[DataLoader] Fetched from Qdrant: ${r.length} items, ${i.length} products, ${s.length} batches`),r.length===0){console.warn(`[DataLoader] No items found for shopId: ${n}. Checking all items in Qdrant...`);try{const v=await lt("items",null),b=new Set;v.forEach(S=>{var I;const w=(I=S.payload)==null?void 0:I.shopId,C=typeof w=="string"?w:w&&typeof w=="object"&&"id"in w?w.id:null;C&&b.add(C)}),console.warn(`[DataLoader] Found ${v.length} total items in Qdrant. ShopIds present:`,Array.from(b)),v.length>0&&!b.has(n)&&(console.error(`[DataLoader] CRITICAL: Items exist but none have shopId "${n}". Items have shopIds:`,Array.from(b)),console.error(`[DataLoader] Expected shopId: ${n}`),console.error("[DataLoader] Found shopIds:",Array.from(b)))}catch(v){console.error("[DataLoader] Error checking all items:",v)}}my(),i.forEach(v=>{const b=v.payload,S=(b==null?void 0:b.productId)||String(v.id);S&&qe.products.set(S,{id:S,name:(b==null?void 0:b.name)||"Unnamed Product",manufacturer:(b==null?void 0:b.manufacturer)||"",category:(b==null?void 0:b.category)||""})}),s.forEach(v=>{const b=v.payload,S=(b==null?void 0:b.batchId)||String(v.id);S&&qe.batches.set(String(S),{id:String(S),supplier:(b==null?void 0:b.supplierId)||"Unknown Supplier",deliveryDate:(b==null?void 0:b.deliveryDate)||"",inventoryDate:(b==null?void 0:b.inventoryDate)||(b==null?void 0:b.deliveryDate)||""})});let h=0,y=0;const m={};r.forEach(v=>{const b=v.payload,S=(b==null?void 0:b.productId)||(b==null?void 0:b.itemId),w=(b==null?void 0:b.inventoryUuid)||String(v.id);if(!w||!S){y++,m.missing_uuid_or_productId=(m.missing_uuid_or_productId||0)+1;return}const C=b.quantity||0,I=b.status||(C>0?"ACTIVE":"EMPTY");if(C<=0||I==="EMPTY"||I==="EXPIRED"){y++;const q=C<=0?"quantity_zero":I.toLowerCase();m[q]=(m[q]||0)+1;return}const P=typeof b.shopId=="string"?b.shopId:b.shopId&&typeof b.shopId=="object"&&"id"in b.shopId?b.shopId.id:null;P&&P!==n&&console.warn(`[DataLoader] Item ${w} has shopId "${P}" but expected "${n}"`);const V={id:b.inventoryId||Date.now()+Math.random(),inventoryUuid:w,shopId:P||n||"",productId:S,batchId:b.batchId,expirationDate:b.expiration||b.expirationDate||"",quantity:C,costPerUnit:b.costPerUnit||b.buyPrice||0,location:b.location||void 0,supplierId:b.supplierId||void 0,buyPrice:b.buyPrice??b.costPerUnit,sellPrice:b.sellPrice??void 0,images:b.images||[],scanMetadata:b.scanMetadata||null,createdByUserId:b.createdByUserId||void 0,createdAt:b.createdAt,updatedAt:b.updatedAt,qdrantId:w,status:I};qe.stockItems.set(V.id,V),h++}),console.log(`[DataLoader] Loaded ${h} items into cache, skipped ${y} items:`,m),c.forEach(v=>{const b=v.payload;b!=null&&b.saleId&&qe.salesTransactions.set(b.saleId,{id:b.saleId,timestamp:b.timestamp,items:b.lineItems||[],totalAmount:b.totalAmount||0})}),f.forEach(v=>{const b=v.payload;b!=null&&b.listingId&&qe.marketplaceListings.set(b.listingId,{id:b.listingId,productId:b.productId,productName:b.productName,quantity:b.quantity,price:b.price})})},$0={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var K0={};const r2="simulated_local",l2=r2==="simulated_local",$a=(n,e)=>{const i=typeof import.meta<"u"&&$0?$0[n]:void 0,s=typeof process<"u"&&K0?K0[n]:void 0;return(i??s??e??"").toString()},Qn=(()=>{const n=$a("VITE_ENABLE_DAN","false").toLowerCase();return n==="1"||n==="true"||n==="yes"})(),c2=$a("VITE_DAN_DERIVATION_SALT","dan-dev-salt");$a("VITE_DAN_REALTIME_CHANNEL","dan_events");const u2=$a("VITE_SUPABASE_URL",$a("SUPABASE_URL","")),d2=$a("VITE_SUPABASE_ANON_KEY",$a("SUPABASE_ANON_KEY",""));Qn&&(!u2||!d2)&&console.warn("[Config] DAN is enabled but Supabase credentials are missing. Set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY (or SUPABASE_URL/SUPABASE_ANON_KEY) in your environment.");const hy="dan:keypairs:v1",X0="dan:event-buffer:v1",gy=()=>typeof window<"u"&&window.localStorage?window.localStorage:typeof globalThis<"u"&&globalThis.localStorage?globalThis.localStorage:null,yy=(n,e)=>{const i=gy();if(!i)return e;try{const s=i.getItem(n);return s?JSON.parse(s):e}catch{return e}},xy=(n,e)=>{const i=gy();if(i)try{i.setItem(n,JSON.stringify(e))}catch{}},f2=n=>Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join(""),p2=()=>{if(typeof globalThis>"u")return null;const n=globalThis.crypto;return n&&n.subtle?n.subtle:null},Dr=async n=>{const e=p2();if(!e){let r=0;for(let c=0;c<n.length;c+=1)r=(r<<5)-r+n.charCodeAt(c),r|=0;return`fallback-${Math.abs(r).toString(16)}`}const i=new TextEncoder().encode(n),s=await e.digest("SHA-256",i);return f2(s)},Br=async n=>{const e=typeof n=="string"?n:JSON.stringify(n??{});return Dr(e)},m2=async n=>{const e=`${n}:${Lr||"global"}:${c2}`,i=await Dr(`${e}:private`),s=await Dr(`${i}:public`),r=s.slice(0,16);return{publicKey:s,fingerprint:r,derivedAt:new Date().toISOString(),privateKey:i}},vy=()=>yy(hy,{}),h2=n=>xy(hy,n),g2=n=>vy()[n]||null,y2=(n,e)=>{const i=vy();i[n]=e,h2(i)},x2=async()=>{const n=de;if(!n||!Qn)return null;let e=g2(n);return e||(e=await m2(n),y2(n,e)),e},v2=async()=>{},ed=n=>{const e=new Set(["local"]);return(n||[]).forEach(i=>{i&&e.add(i)}),Array.from(e)},b2=n=>ed(n).includes("dan"),by=()=>Qn,S2=n=>{const e=yy(X0,[]);e.push(n),xy(X0,e)},td=async n=>{if(!Qn)return null;const e=de;if(!e)return null;const i=await x2();if(!i)return null;const s=ed(n.shareScope),r=JSON.parse(JSON.stringify(n.payload||{})),c=await Br(r),f=await Dr(`${i.privateKey}:${c}`),h={eventId:xt(),eventType:n.eventType,shopId:e,namespace:Lr||null,payload:r,shareScope:s,vectorContext:n.vectorContext||null,proofs:{...n.proofs||{},hash:c},actor:{publicKey:i.publicKey,fingerprint:i.fingerprint,signature:f},createdAt:new Date().toISOString()};return await v2(),S2(h),h},Sy="dan:policies:v1",Ny="dan:policy-runs:v1",wy=()=>typeof window<"u"&&window.localStorage?window.localStorage:typeof globalThis<"u"&&globalThis.localStorage?globalThis.localStorage:null,Ey=(n,e)=>{const i=wy();if(!i)return e;try{const s=i.getItem(n);return s?JSON.parse(s):e}catch{return e}},Ty=(n,e)=>{const i=wy();if(i)try{i.setItem(n,JSON.stringify(e))}catch{}},Cy=()=>Ey(Sy,{}),N2=n=>Ty(Sy,n),w2=()=>Ey(Ny,{}),E2=n=>Ty(Ny,n),_y=async(n,e)=>{var r;const i=Cy();if((r=i[n])!=null&&r.length)return;const s={id:xt(),shopId:n,name:"Auto-flag low inventory offers",description:"Warns when a DAN offer is created with quantity below 10 units so the shop can replenish locally before sharing.",eventType:"inventory.offer.created",scope:"inventory",version:"1.0",enabled:!0,conditions:[{field:"quantity",operator:"lt",value:10},{field:"shareScope",operator:"includes",value:"dan"}],actions:[{type:"notify",params:{message:"DAN offer shared while stock is below 10 units. Confirm replenishment or adjust sharing scope."}},{type:"create_dan_event",params:{trigger:"policy.auto-alert",shopName:e||"unknown shop"}}],author:"system",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};i[n]=[s],N2(i)},Z0=async n=>{const e=n||de;return e?Cy()[e]||[]:[]},T2=n=>{const e=w2(),i=e[n.shopId]||[];i.unshift(n),e[n.shopId]=i.slice(0,50),E2(e)},C2=(n,e)=>e.split(".").reduce((i,s)=>{if(i&&typeof i=="object"&&s in i)return i[s]},n),_2=(n,e)=>{const i=C2(e,n.field),s=n.value;switch(n.operator){case"eq":return i===s;case"neq":return i!==s;case"gt":return typeof i=="number"&&i>Number(s);case"gte":return typeof i=="number"&&i>=Number(s);case"lt":return typeof i=="number"&&i<Number(s);case"lte":return typeof i=="number"&&i<=Number(s);case"includes":case"contains":return Array.isArray(i)?i.includes(s):typeof i=="string"?i.toLowerCase().includes(String(s).toLowerCase()):!1;default:return!1}},A2=async(n,e,i)=>{var s,r,c;switch(n.type){case"notify":{const f=((s=n.params)==null?void 0:s.message)||`Policy "${e.name}" triggered for event ${i.eventType}`;console.info(`[PolicyEngine] ${f}`,{policyId:e.id,payload:i.payload});break}case"create_dan_event":{await td({eventType:"policy.trigger.executed",payload:{policyId:e.id,policyName:e.name,scope:e.scope,trigger:((r=n.params)==null?void 0:r.trigger)||"policy.action",eventPayload:i.payload}});break}case"tag_inventory":{console.debug("[PolicyEngine] tag_inventory action queued",{policyId:e.id,params:n.params});break}case"call_webhook":{const f=(c=n.params)==null?void 0:c.url;if(!f||typeof fetch>"u")break;try{await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({policyId:e.id,policyName:e.name,payload:i.payload})})}catch(h){console.warn("[PolicyEngine] call_webhook failed",h)}break}default:console.warn("[PolicyEngine] Unknown action type",n.type)}},Ay=async n=>{var c,f,h;const e=((c=n.payload)==null?void 0:c.shopId)||de||((h=(f=n.payload)==null?void 0:f.shop)==null?void 0:h.id)||null;if(!e)return;(await Z0(e)).length||await _y(e,Qi);const r=(await Z0(e)).filter(y=>y.enabled&&y.eventType===n.eventType);if(r.length)for(const y of r){const m=y.conditions.every(b=>_2(b,n.payload)),v={id:xt(),policyId:y.id,shopId:e,eventType:n.eventType,eventPayload:n.payload,outcome:m?"triggered":"skipped",notes:m?`Policy ${y.name} triggered`:"Condition check failed",createdAt:new Date().toISOString()};if(m)try{for(const b of y.actions)await A2(b,y,n)}catch(b){v.outcome="error",v.notes=`Action error: ${(b==null?void 0:b.message)||"unknown"}`}T2(v)}},Iy=()=>de||null,I2=n=>{const e=Iy();return e?n.filter(i=>i.shopId===e):n},D2=n=>n.quantity>0&&n.status!=="EMPTY"&&n.status!=="EXPIRED"&&(!n.status||n.status==="ACTIVE"),Dy=()=>{const n=Array.from(qe.stockItems.values()).filter(D2);return I2(n)},nd=n=>ed(n),Gr=n=>by()&&b2(n),M2=n=>n?n.split("T")[0]:new Date().toISOString().split("T")[0],My=n=>{if(!n)return null;const e=n.trim();if(!e)return null;const i=e.split(/[\s-]/)[0];return i?i.toUpperCase():null},R2=(n,e)=>{const i=qe.products.get(n);return e||(i==null?void 0:i.name)||n},Ry=n=>{for(const e of qe.stockItems.values())if(e.inventoryUuid===n||e.qdrantId===n||String(e.id)===n)return e},U2=async(n,e,i)=>{if(Gr(e.shareScope||n.shareScope))try{const s=nd(e.shareScope||n.shareScope),r={inventoryUuid:n.inventoryUuid,productId:n.productId,productName:R2(n.productId,e.productName),quantity:n.quantity,expirationDate:M2(n.expirationDate),locationBucket:My(n.location),sellPrice:n.sellPrice??e.sellPrice??null,batchId:i.batchId,supplierId:n.supplierId||i.supplierId||null,supplierName:i.supplierName||null,shopId:n.shopId,shareScope:s},c=await Br(r),f=await vn(`${r.productName} ${r.quantity} ${r.locationBucket||""}`);await td({eventType:"inventory.offer.created",payload:{...r,proofHash:c},shareScope:s,vectorContext:f,proofs:{hash:c,link:`qdrant://items/${n.inventoryUuid}`}}),await Ay({eventType:"inventory.offer.created",payload:{...r},proofs:{hash:c}}),await fy({inventoryUuid:n.inventoryUuid,productId:n.productId,productName:r.productName,quantity:n.quantity,expirationDate:r.expirationDate,locationBucket:r.locationBucket,sellPrice:r.sellPrice??null,shopId:n.shopId,shopName:Qi,shareScope:s,proofHash:c,vector:f})}catch(s){console.warn("[DAN] Failed to publish inventory.offer.created",s)}},P2=async(n,e,i)=>{if(Gr(n.shareScope))try{const s=nd(n.shareScope),r=Math.max((n.quantity||0)-i,0),c={inventoryUuid:n.inventoryUuid,productId:n.productId,productName:e,fulfilledQuantity:i,remainingQuantity:r,saleTimestamp:new Date().toISOString(),batchId:n.batchId,shopId:n.shopId,shareScope:s},f=await Br(c),h=await vn(`${c.productName} fulfilled ${i}`);await td({eventType:"inventory.offer.fulfilled",payload:{...c,proofHash:f},shareScope:s,vectorContext:h,proofs:{hash:f,link:`qdrant://items/${n.inventoryUuid}`}}),await Ay({eventType:"inventory.offer.fulfilled",payload:c,proofs:{hash:f}}),r<=0?await i2(n.inventoryUuid):await fy({inventoryUuid:n.inventoryUuid,productId:n.productId,productName:e,quantity:r,expirationDate:n.expirationDate,locationBucket:My(n.location),sellPrice:n.sellPrice,shopId:n.shopId,shopName:Qi,shareScope:s,proofHash:f})}catch(s){console.warn("[DAN] Failed to publish inventory.offer.fulfilled",s)}},q2=async n=>{if(!by())return;const e=Array.from(qe.stockItems.values()).filter(i=>Gr(i.shareScope));if(e.length)for(const i of n){const s=Array.from(qe.products.values()).find(c=>c.name.toLowerCase()===i.productName.toLowerCase());if(!s)continue;const r=e.find(c=>c.productId===s.id);r&&await P2(r,i.productName,i.quantity)}},Hr=Ws,Mu=Kg,Uy=()=>s2(),$s=n=>{const e=de,i=(n==null?void 0:n.id)||null;F0(i?{...n,id:i}:null),e!==i&&(my(),py(!1),console.log(`[VectorDB] Shop context changed: ${e||"null"} -> ${i||"null"}, resetting initialization`))},ad=()=>Iy(),Py=async()=>{if(console.log(`[VectorDB] initializeAndSeedDatabase called, _activeShopId: ${de}, _initialized: ${Iu}`),!de){console.warn("[VectorDB] initializeAndSeedDatabase: _activeShopId is not set, cannot initialize");return}if(Iu){console.log("[VectorDB] initializeAndSeedDatabase: Already initialized, skipping");return}console.log(`[VectorDB] Initializing database for shopId: ${de}`),await zg(),await Ir(),console.log(`[VectorDB] After loadDataFromQdrant: ${qe.products.size} products, ${qe.stockItems.size} stock items`),qe.products.size===0&&qe.stockItems.size===0&&(console.log("[VectorDB] No data found, seeding local store..."),await k2(de),await Ir(),console.log(`[VectorDB] After seeding: ${qe.products.size} products, ${qe.stockItems.size} stock items`)),await _y(de,Qi),py(!0),console.log("[VectorDB] Database initialization complete")},k2=async n=>{const i=(await Ki({name:"Organic Foods Dist."})).id,s=[{supplier:"Organic Foods Dist.",deliveryDate:"2024-06-05",inventoryDate:"2024-06-05"}],r=[{batchIndex:0,productName:"Organic Oat Milk",manufacturer:"Oatly",category:"Beverages",expirationDate:"2024-12-15",quantity:50,quantityType:"cartons",costPerUnit:2.5,location:"Shelf A"}],c=[];s.forEach(f=>{const h=xt(),y={...f,id:h};qe.batches.set(h,y),c.push(y)});for(const f of r){const h=c[f.batchIndex],y=Du(f.productName),m={id:y,name:f.productName,manufacturer:f.manufacturer,category:f.category};qe.products.set(y,m),await $i({name:f.productName,manufacturer:f.manufacturer,category:f.category});const v=xt(),b={id:Date.now()+Math.random(),inventoryUuid:v,shopId:n,productId:y,batchId:h.id,expirationDate:f.expirationDate,quantity:f.quantity,costPerUnit:f.costPerUnit,location:f.location,supplierId:i||void 0,buyPrice:f.costPerUnit,sellPrice:f.costPerUnit*1.4,images:f.images,scanMetadata:f.scanMetadata||null,createdByUserId:n,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),qdrantId:v,status:"ACTIVE",shareScope:["local"]};qe.stockItems.set(b.id,b),await Vr(b)}console.info(`[Data Service] Seeded starter data for shop ${n}`)},zi=async(n,e)=>{if(!de)throw new Error("No shop selected. Shop role/ID required.");await zg();let s=(await _a()).find(b=>{var S;return b.name.toLowerCase()===((S=n.supplier)==null?void 0:S.toLowerCase())});!s&&n.supplier&&(s=await Ki({name:n.supplier}));const r=s==null?void 0:s.id;(await Ws()).forEach(b=>{qe.products.has(b.id)||qe.products.set(b.id,{id:b.id,name:b.name,manufacturer:b.manufacturer,category:b.category})});const f=new Map;for(const b of e){let S=Array.from(qe.products.values()).find(w=>w.name.toLowerCase()===b.productName.toLowerCase());if(S)f.set(b.productName,S.id);else{const w=await $i({name:b.productName,manufacturer:b.manufacturer,category:b.category});qe.products.set(w.id,{id:w.id,name:w.name,manufacturer:w.manufacturer,category:w.category}),f.set(b.productName,w.id)}}const h=xt(),y={...n,id:h};qe.batches.set(h,y);const m=new Date().toISOString(),v={id:h,shopId:de||"",supplierId:r||null,deliveryDate:n.deliveryDate||m.split("T")[0],inventoryDate:n.inventoryDate||n.deliveryDate||m.split("T")[0],invoiceNumber:void 0,documents:[],lineItems:e.map(b=>({productId:f.get(b.productName)||Du(b.productName),productName:b.productName,quantity:b.quantity||0,cost:b.buyPrice??b.costPerUnit??0})),createdAt:m,createdByUserId:de||""};await $u(v);for(const b of e){const S=f.get(b.productName)||Du(b.productName),w=xt(),C=nd(b.shareScope),I=Gr(C),P={id:Date.now()+Math.random(),inventoryUuid:w,shopId:de||"",productId:S,batchId:h,expirationDate:b.expirationDate,quantity:b.quantity,costPerUnit:b.costPerUnit,location:b.location,supplierId:b.supplierId||r||void 0,buyPrice:b.buyPrice??b.costPerUnit,sellPrice:b.sellPrice??void 0,images:b.images,scanMetadata:b.scanMetadata||null,createdByUserId:de||void 0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),qdrantId:w,status:"ACTIVE",shareScope:C};I&&(P.shareProofHash=await Br({inventoryUuid:w,productId:S,batchId:h,quantity:P.quantity})),qe.stockItems.set(P.id,P),await Vr(P,P.scanMetadata||void 0),I&&await U2(P,b,{batchId:h,supplierId:P.supplierId,supplierName:n.supplier})}console.log(`[Data Service] Added batch ${y.id} with ${e.length} item types.`)},qy=async(n,e)=>{if(!de)throw new Error("No shop selected. Shop role/ID required.");const i=Ry(n);if(!i)throw new Error(`Inventory item ${n} not found`);const s=e.quantity??i.quantity,r={...i,quantity:s,expirationDate:e.expirationDate??i.expirationDate,costPerUnit:e.costPerUnit??i.costPerUnit,buyPrice:e.buyPrice??e.costPerUnit??i.buyPrice??i.costPerUnit,sellPrice:e.sellPrice??i.sellPrice,location:e.location??i.location,updatedAt:new Date().toISOString(),status:s>0?"ACTIVE":"EMPTY"};return qe.stockItems.set(r.id,r),await Vr(r),r},ky=async n=>{if(!de)throw new Error("No shop selected. Shop role/ID required.");const e=Ry(n);if(!e)throw new Error(`Inventory item ${n} not found`);qe.stockItems.delete(e.id),await sy(e)},id=async n=>{if(!de)throw new Error("No shop selected.");const e=new Map;for(const i of qe.products.values())e.set(i.name,{id:i.id,name:i.name});await X1(n,e),await Ir(),await q2(n)},zr=async()=>o2(()=>Promise.resolve(Dy()),_a),Ly=async()=>Array.from(qe.batches.values()),sd=async()=>Dy(),Js=async n=>{if(!de)throw new Error("No shop selected.");const e=new Date().toISOString(),i={id:xt(),shopId:de,supplierId:n.supplierId,deliveryDate:n.deliveryDate,inventoryDate:n.inventoryDate,invoiceNumber:n.invoiceNumber,documents:n.documents||[],lineItems:n.lineItems||[],createdAt:e,createdByUserId:de};return await $u(i),n.lineItems&&n.lineItems.length>0&&await K1(i,n.lineItems),i},jy=async(n,e)=>{await W1(n,e,async(i,s)=>{await zi(i,s)},async i=>{await Zu(i)}),await Ir()},L2=Object.freeze(Object.defineProperty({__proto__:null,get activeNamespace(){return Lr},get activeShopId(){return de},get activeShopName(){return Qi},addImageForField:Wu,addInventoryBatch:zi,createBatchForShop:Js,createCanonicalProduct:$i,createShopNamespace:Wg,deleteCanonicalProduct:$g,fetchBatchRecords:Zg,fetchCanonicalProducts:Hr,fetchSuppliersForActiveShop:_a,getActiveShopId:ad,getAllBatches:Ly,getAllSales:ry,getAllShops:ny,getAllStockItems:sd,getBatchRecords:Xg,getCanonicalProducts:Ws,getDanInventoryOffers:Uy,getLearnedFieldsForProduct:dy,getMyMarketplaceListings:cy,getProductSummaries:zr,initializeAndSeedDatabase:Py,listProductOnMarketplace:ly,persistSale:Zu,purchaseFromMarketplace:jy,recordSale:id,registerLocalSupplier:Ki,removeInventoryItem:ky,searchCanonicalProducts:Kg,searchCatalogProducts:Mu,searchRelevantInventoryItems:Xu,setActiveShopContext:$s,updateCanonicalProduct:Qg,updateInventoryItem:qy,upsertBatchRecord:$u,upsertCustomerRecord:ty,upsertDriverRecord:jr,upsertProductDefinition:Qu,upsertShopRecord:ey,upsertSupplierProfile:Ku,upsertUserProfile:Xa,validateShopExists:ay},Symbol.toStringTag,{value:"Module"})),j2=async n=>{var e;(e=n.roles)!=null&&e.shop&&await Xa({userId:n.clientId,displayName:n.companyName,email:n.email,contactEmail:n.email,shopId:n.shopId||null,isVerified:!1})},V2=async n=>{var e;(e=n.roles)!=null&&e.driver&&(await Xa({userId:n.clientId,displayName:n.companyName,email:n.email,contactEmail:n.email,isDriverVerified:!1}),n.driverId&&await jr({id:n.driverId,fullName:n.companyName,contactEmail:n.email,status:"pending",userId:n.clientId}))},B2=async(n,e)=>{if(!he||!await Ke("users"))return{isVerified:!0,isDriverVerified:!0};try{const i=Dt("users",n),s=await he.retrieve("users",{ids:[i],with_payload:!0});if(s.points&&s.points.length>0){const r=s.points[0].payload;return{isVerified:e!=null&&e.requiresShopVerification?r.isVerified??!1:!0,isDriverVerified:e!=null&&e.requiresDriverVerification?r.isDriverVerified??!1:!0}}}catch(i){console.error("[Backend] Error fetching verification status:",i)}return{isVerified:!(e!=null&&e.requiresShopVerification),isDriverVerified:!(e!=null&&e.requiresDriverVerification)}},G2=async()=>{if(!he||!await Ke("users"))return[];try{return(await lt("users",null)).map(e=>{const i=e.payload;return i.shopId&&(i.isVerified===!1||i.isVerified===void 0)?{clientId:i.userId,companyName:i.displayName,contactPerson:i.displayName,address:"",email:i.email,role:"shop",isVerified:!1,isDriverVerified:i.isDriverVerified??!1,shopId:i.shopId,roles:{shop:!0,customer:!1,driver:!1,supplier:!1}}:null}).filter(e=>e!==null)}catch(n){return console.error("[Backend] Error fetching pending clients:",n),[]}},H2=async()=>{if(!he||!await Ke("users"))return[];try{return(await lt("users",null)).map(e=>{const i=e.payload;return i.shopId&&i.isVerified===!0?{clientId:i.userId,companyName:i.displayName,contactPerson:i.displayName,address:"",email:i.email,role:"shop",isVerified:!0,isDriverVerified:i.isDriverVerified??!1,shopId:i.shopId,roles:{shop:!0,customer:!1,driver:!1,supplier:!1}}:null}).filter(e=>e!==null)}catch(n){return console.error("[Backend] Error fetching verified clients:",n),[]}},z2=async()=>{if(!he||!await Ke("drivers"))return[];try{return(await lt("drivers",null)).map(e=>{const i=e.payload;return i.status==="pending"&&i.userId?{clientId:i.userId,companyName:i.name||"Driver",contactPerson:i.name||"Driver",address:"",email:i.contact||i.contactEmail||"",role:"driver",isVerified:!0,isDriverVerified:!1,driverId:i.driverId,roles:{shop:!1,customer:!1,driver:!0,supplier:!1}}:null}).filter(e=>e!==null)}catch(n){return console.error("[Backend] Error fetching pending drivers:",n),[]}},O2=async()=>{if(!he||!await Ke("drivers"))return[];try{return(await lt("drivers",null)).map(e=>{const i=e.payload;return i.status==="verified"&&i.userId?{clientId:i.userId,companyName:i.name||"Driver",contactPerson:i.name||"Driver",address:"",email:i.contact||i.contactEmail||"",role:"driver",isVerified:!0,isDriverVerified:!0,driverId:i.driverId,roles:{shop:!1,customer:!1,driver:!0,supplier:!1}}:null}).filter(e=>e!==null)}catch(n){return console.error("[Backend] Error fetching verified drivers:",n),[]}},F2=async n=>{if(!he||!await Ke("users")){console.warn("[Backend] Qdrant not available for verification");return}try{const e=Dt("users",n),i=await he.retrieve("users",{ids:[e],with_payload:!0});if(i.points&&i.points.length>0){const s=i.points[0].payload;await Xa({userId:n,displayName:s.displayName,email:s.email,contactEmail:s.contactEmail,shopId:s.shopId,isVerified:!0,isDriverVerified:s.isDriverVerified}),console.log(`[Backend] Verified shop client: ${s.displayName}`)}else console.warn(`[Backend] User not found for verification: ${n}`)}catch(e){console.error("[Backend] Error verifying client:",e)}},Y2=async n=>{if(!he||!await Ke("users")){console.warn("[Backend] Qdrant not available for driver verification");return}try{const e=Dt("users",n),i=await he.retrieve("users",{ids:[e],with_payload:!0});if(i.points&&i.points.length>0){const s=i.points[0].payload;await Xa({userId:n,displayName:s.displayName,email:s.email,contactEmail:s.contactEmail,shopId:s.shopId,isVerified:s.isVerified,isDriverVerified:!0});const c=(await lt("drivers",null)).find(f=>f.payload.userId===n);if(c){const f=c.payload;await jr({id:f.driverId,fullName:f.name||s.displayName,contactEmail:f.contact||f.contactEmail||s.email,status:"verified",userId:n})}console.log(`[Backend] Verified driver: ${s.displayName}`)}else console.warn(`[Backend] User not found for driver verification: ${n}`)}catch(e){console.error("[Backend] Error verifying driver:",e)}},J2=[{id:"peer_1",name:"Gourmet Goods",listings:[{listingId:"gg_1",productName:"Artisanal Cheese",manufacturer:"Cheese Masters",category:"Dairy",quantity:20,quantityType:"kg",price:25.5,seller:{id:"peer_1",name:"Gourmet Goods"}},{listingId:"gg_2",productName:"Truffle Oil",manufacturer:"Italian Imports",category:"Pantry",quantity:50,quantityType:"bottles",price:15,seller:{id:"peer_1",name:"Gourmet Goods"}}]},{id:"peer_2",name:"The Fresh Market",listings:[{listingId:"tfm_1",productName:"Organic Avocados",manufacturer:"Fresh Farms",category:"Produce",quantity:100,quantityType:"units",price:1.5,seller:{id:"peer_2",name:"The Fresh Market"}}]}],Q2=async n=>{if(!n.isVerified)throw new Error("User is not verified.");return Promise.resolve(J2.filter(e=>e.id!==n.clientId))},$2=async(n,e)=>{console.log(`[Backend] Consuming listing ${n}, quantity: ${e}`)},K2={};var Ru=null;function X2(n){try{return crypto.getRandomValues(new Uint8Array(n))}catch{}try{return K2.randomBytes(n)}catch{}if(!Ru)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return Ru(n)}function Z2(n){Ru=n}function od(n,e){if(n=n||rd,typeof n!="number")throw Error("Illegal arguments: "+typeof n+", "+typeof e);n<4?n=4:n>31&&(n=31);var i=[];return i.push("$2b$"),n<10&&i.push("0"),i.push(n.toString()),i.push("$"),i.push(Mr(X2(Ks),Ks)),i.join("")}function Vy(n,e,i){if(typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=void 0),typeof n>"u")n=rd;else if(typeof n!="number")throw Error("illegal arguments: "+typeof n);function s(r){gn(function(){try{r(null,od(n))}catch(c){r(c)}})}if(i){if(typeof i!="function")throw Error("Illegal callback: "+typeof i);s(i)}else return new Promise(function(r,c){s(function(f,h){if(f){c(f);return}r(h)})})}function By(n,e){if(typeof e>"u"&&(e=rd),typeof e=="number"&&(e=od(e)),typeof n!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof n+", "+typeof e);return Uu(n,e)}function Gy(n,e,i,s){function r(c){typeof n=="string"&&typeof e=="number"?Vy(e,function(f,h){Uu(n,h,c,s)}):typeof n=="string"&&typeof e=="string"?Uu(n,e,c,s):gn(c.bind(this,Error("Illegal arguments: "+typeof n+", "+typeof e)))}if(i){if(typeof i!="function")throw Error("Illegal callback: "+typeof i);r(i)}else return new Promise(function(c,f){r(function(h,y){if(h){f(h);return}c(y)})})}function Hy(n,e){for(var i=n.length^e.length,s=0;s<n.length;++s)i|=n.charCodeAt(s)^e.charCodeAt(s);return i===0}function W2(n,e){if(typeof n!="string"||typeof e!="string")throw Error("Illegal arguments: "+typeof n+", "+typeof e);return e.length!==60?!1:Hy(By(n,e.substring(0,e.length-31)),e)}function e_(n,e,i,s){function r(c){if(typeof n!="string"||typeof e!="string"){gn(c.bind(this,Error("Illegal arguments: "+typeof n+", "+typeof e)));return}if(e.length!==60){gn(c.bind(this,null,!1));return}Gy(n,e.substring(0,29),function(f,h){f?c(f):c(null,Hy(h,e))},s)}if(i){if(typeof i!="function")throw Error("Illegal callback: "+typeof i);r(i)}else return new Promise(function(c,f){r(function(h,y){if(h){f(h);return}c(y)})})}function t_(n){if(typeof n!="string")throw Error("Illegal arguments: "+typeof n);return parseInt(n.split("$")[2],10)}function n_(n){if(typeof n!="string")throw Error("Illegal arguments: "+typeof n);if(n.length!==60)throw Error("Illegal hash length: "+n.length+" != 60");return n.substring(0,29)}function a_(n){if(typeof n!="string")throw Error("Illegal arguments: "+typeof n);return zy(n)>72}var gn=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;function zy(n){for(var e=0,i=0,s=0;s<n.length;++s)i=n.charCodeAt(s),i<128?e+=1:i<2048?e+=2:(i&64512)===55296&&(n.charCodeAt(s+1)&64512)===56320?(++s,e+=4):e+=3;return e}function i_(n){for(var e=0,i,s,r=new Array(zy(n)),c=0,f=n.length;c<f;++c)i=n.charCodeAt(c),i<128?r[e++]=i:i<2048?(r[e++]=i>>6|192,r[e++]=i&63|128):(i&64512)===55296&&((s=n.charCodeAt(c+1))&64512)===56320?(i=65536+((i&1023)<<10)+(s&1023),++c,r[e++]=i>>18|240,r[e++]=i>>12&63|128,r[e++]=i>>6&63|128,r[e++]=i&63|128):(r[e++]=i>>12|224,r[e++]=i>>6&63|128,r[e++]=i&63|128);return r}var ki="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),Ea=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function Mr(n,e){var i=0,s=[],r,c;if(e<=0||e>n.length)throw Error("Illegal len: "+e);for(;i<e;){if(r=n[i++]&255,s.push(ki[r>>2&63]),r=(r&3)<<4,i>=e){s.push(ki[r&63]);break}if(c=n[i++]&255,r|=c>>4&15,s.push(ki[r&63]),r=(c&15)<<2,i>=e){s.push(ki[r&63]);break}c=n[i++]&255,r|=c>>6&3,s.push(ki[r&63]),s.push(ki[c&63])}return s.join("")}function Oy(n,e){var i=0,s=n.length,r=0,c=[],f,h,y,m,v,b;if(e<=0)throw Error("Illegal len: "+e);for(;i<s-1&&r<e&&(b=n.charCodeAt(i++),f=b<Ea.length?Ea[b]:-1,b=n.charCodeAt(i++),h=b<Ea.length?Ea[b]:-1,!(f==-1||h==-1||(v=f<<2>>>0,v|=(h&48)>>4,c.push(String.fromCharCode(v)),++r>=e||i>=s)||(b=n.charCodeAt(i++),y=b<Ea.length?Ea[b]:-1,y==-1)||(v=(h&15)<<4>>>0,v|=(y&60)>>2,c.push(String.fromCharCode(v)),++r>=e||i>=s)));)b=n.charCodeAt(i++),m=b<Ea.length?Ea[b]:-1,v=(y&3)<<6>>>0,v|=m,c.push(String.fromCharCode(v)),++r;var S=[];for(i=0;i<r;i++)S.push(c[i].charCodeAt(0));return S}var Ks=16,rd=10,s_=16,o_=100,W0=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],eg=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],Fy=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function Xs(n,e,i,s){var r,c=n[e],f=n[e+1];return c^=i[0],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[1],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[2],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[3],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[4],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[5],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[6],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[7],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[8],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[9],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[10],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[11],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[12],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[13],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[14],r=s[c>>>24],r+=s[256|c>>16&255],r^=s[512|c>>8&255],r+=s[768|c&255],f^=r^i[15],r=s[f>>>24],r+=s[256|f>>16&255],r^=s[512|f>>8&255],r+=s[768|f&255],c^=r^i[16],n[e]=f^i[s_+1],n[e+1]=c,n}function Li(n,e){for(var i=0,s=0;i<4;++i)s=s<<8|n[e]&255,e=(e+1)%n.length;return{key:s,offp:e}}function tg(n,e,i){for(var s=0,r=[0,0],c=e.length,f=i.length,h,y=0;y<c;y++)h=Li(n,s),s=h.offp,e[y]=e[y]^h.key;for(y=0;y<c;y+=2)r=Xs(r,0,e,i),e[y]=r[0],e[y+1]=r[1];for(y=0;y<f;y+=2)r=Xs(r,0,e,i),i[y]=r[0],i[y+1]=r[1]}function r_(n,e,i,s){for(var r=0,c=[0,0],f=i.length,h=s.length,y,m=0;m<f;m++)y=Li(e,r),r=y.offp,i[m]=i[m]^y.key;for(r=0,m=0;m<f;m+=2)y=Li(n,r),r=y.offp,c[0]^=y.key,y=Li(n,r),r=y.offp,c[1]^=y.key,c=Xs(c,0,i,s),i[m]=c[0],i[m+1]=c[1];for(m=0;m<h;m+=2)y=Li(n,r),r=y.offp,c[0]^=y.key,y=Li(n,r),r=y.offp,c[1]^=y.key,c=Xs(c,0,i,s),s[m]=c[0],s[m+1]=c[1]}function ng(n,e,i,s,r){var c=Fy.slice(),f=c.length,h;if(i<4||i>31)if(h=Error("Illegal number of rounds (4-31): "+i),s){gn(s.bind(this,h));return}else throw h;if(e.length!==Ks)if(h=Error("Illegal salt length: "+e.length+" != "+Ks),s){gn(s.bind(this,h));return}else throw h;i=1<<i>>>0;var y,m,v=0,b;typeof Int32Array=="function"?(y=new Int32Array(W0),m=new Int32Array(eg)):(y=W0.slice(),m=eg.slice()),r_(e,n,y,m);function S(){if(r&&r(v/i),v<i)for(var C=Date.now();v<i&&(v=v+1,tg(n,y,m),tg(e,y,m),!(Date.now()-C>o_)););else{for(v=0;v<64;v++)for(b=0;b<f>>1;b++)Xs(c,b<<1,y,m);var I=[];for(v=0;v<f;v++)I.push((c[v]>>24&255)>>>0),I.push((c[v]>>16&255)>>>0),I.push((c[v]>>8&255)>>>0),I.push((c[v]&255)>>>0);if(s){s(null,I);return}else return I}s&&gn(S)}if(typeof s<"u")S();else for(var w;;)if(typeof(w=S())<"u")return w||[]}function Uu(n,e,i,s){var r;if(typeof n!="string"||typeof e!="string")if(r=Error("Invalid string / salt: Not a string"),i){gn(i.bind(this,r));return}else throw r;var c,f;if(e.charAt(0)!=="$"||e.charAt(1)!=="2")if(r=Error("Invalid salt version: "+e.substring(0,2)),i){gn(i.bind(this,r));return}else throw r;if(e.charAt(2)==="$")c="\0",f=3;else{if(c=e.charAt(2),c!=="a"&&c!=="b"&&c!=="y"||e.charAt(3)!=="$")if(r=Error("Invalid salt revision: "+e.substring(2,4)),i){gn(i.bind(this,r));return}else throw r;f=4}if(e.charAt(f+2)>"$")if(r=Error("Missing salt rounds"),i){gn(i.bind(this,r));return}else throw r;var h=parseInt(e.substring(f,f+1),10)*10,y=parseInt(e.substring(f+1,f+2),10),m=h+y,v=e.substring(f+3,f+25);n+=c>="a"?"\0":"";var b=i_(n),S=Oy(v,Ks);function w(C){var I=[];return I.push("$2"),c>="a"&&I.push(c),I.push("$"),m<10&&I.push("0"),I.push(m.toString()),I.push("$"),I.push(Mr(S,S.length)),I.push(Mr(C,Fy.length*4-1)),I.join("")}if(typeof i>"u")return w(ng(b,S,m));ng(b,S,m,function(C,I){C?i(C,null):i(null,w(I))},s)}function l_(n,e){return Mr(n,e)}function c_(n,e){return Oy(n,e)}const Yy={setRandomFallback:Z2,genSaltSync:od,genSalt:Vy,hashSync:By,hash:Gy,compareSync:W2,compare:e_,getRounds:t_,getSalt:n_,truncates:a_,encodeBase64:l_,decodeBase64:c_},ld=()=>{throw new Error("Supabase is not configured.")},Jy=n=>n.shop?"shop":n.customer?"customer":n.driver?"driver":"supplier",Qy=async n=>{const e={shop:n.is_shop,customer:n.is_customer,driver:n.is_driver,supplier:n.is_supplier},i=await B2(n.id,{requiresShopVerification:n.is_shop,requiresDriverVerification:n.is_driver}),s={clientId:n.id,companyName:n.display_name,contactPerson:n.display_name,address:"",email:n.email,role:Jy(e),isVerified:i.isVerified,isDriverVerified:i.isDriverVerified,shopId:n.shop_qdrant_id||void 0,customerId:n.customer_qdrant_id||void 0,driverId:n.driver_qdrant_id||void 0,supplierId:n.supplier_qdrant_id||void 0,roles:e};let r=null;return n.is_shop&&n.shop_qdrant_id&&(r={id:n.shop_qdrant_id,name:n.display_name,contactEmail:n.contact_email,qdrantNamespace:n.qdrant_namespace||void 0}),$s(r),Xa({userId:n.id,qdrantUserId:n.qdrant_user_id||n.id,displayName:n.display_name,email:n.contact_email||n.email,contactEmail:n.contact_email||n.email,shopId:n.shop_qdrant_id||null}).catch(c=>console.error("[Auth] Failed to sync user to Qdrant:",c)),{user:s,shopContext:r}},u_=async n=>{const e=ld(),{error:i}=await e.from("users").insert([n]);if(i)throw i},d_=async n=>{ld();const e=n.roles;if(!e.shop&&!e.customer&&!e.driver&&!e.supplier)throw new Error("Please select at least one role.");const i=await Yy.hash(n.password,10),s=xt(),r=e.shop?xt():null,c=e.customer?xt():null,f=e.driver?xt():null,h=e.supplier?xt():null;await u_({id:s,username:n.username.trim(),email:n.email.trim(),contact_email:n.email.trim(),display_name:n.displayName.trim(),password_hash:i,is_shop:e.shop,is_customer:e.customer,is_driver:e.driver,is_supplier:e.supplier,qdrant_user_id:s,shop_qdrant_id:r,qdrant_namespace:r?`shop-${r}`:null,customer_qdrant_id:c,driver_qdrant_id:f,supplier_qdrant_id:h,metadata:e.driver&&n.licenseId?{licenseId:n.licenseId}:{}}),await Xa({userId:s,qdrantUserId:s,displayName:n.displayName.trim(),email:n.email.trim(),contactEmail:n.email.trim(),shopId:r}),e.shop&&r&&(await Wg(),await ey({id:r,name:n.displayName.trim(),contactEmail:n.email.trim(),userId:s,qdrantNamespace:`shop-${r}`})),e.customer&&c&&await ty({id:c,fullName:n.displayName.trim(),contactEmail:n.email.trim()}),e.driver&&f&&await jr({id:f,fullName:n.displayName.trim(),contactEmail:n.email.trim(),status:"pending"}),e.supplier&&h&&await Ku({id:h,name:n.displayName.trim(),contactEmail:n.email.trim(),shopId:n.supplierShopId||null,linkedUserId:n.supplierShopId?null:s});const y={id:s,username:n.username.trim(),email:n.email.trim(),display_name:n.displayName.trim(),contact_email:n.email.trim(),is_shop:e.shop,is_customer:e.customer,is_driver:e.driver,is_supplier:e.supplier,qdrant_user_id:s,shop_qdrant_id:r,qdrant_namespace:r?`shop-${r}`:null,customer_qdrant_id:c,driver_qdrant_id:f,supplier_qdrant_id:h,metadata:{...e.driver&&n.licenseId?{licenseId:n.licenseId}:{},...e.supplier&&n.supplierShopId?{linkedShop:n.supplierShopId}:{}}},m={clientId:s,companyName:n.displayName.trim(),contactPerson:n.displayName.trim(),email:n.email.trim(),role:Jy(e),isVerified:!e.shop,isDriverVerified:!e.driver,shopId:r||void 0,driverId:f||void 0,roles:e};return e.shop&&await j2(m),e.driver&&await V2(m),await Qy(y)},f_=async n=>{const e=ld(),{data:i,error:s}=await e.from("users").select("*").eq("username",n.username.trim()).single();if(s||!i)throw new Error("Invalid username or password.");if(!await Yy.compare(n.password,i.password_hash??""))throw new Error("Invalid username or password.");return await Qy(i)},p_=({onSuccess:n})=>{const[e,i]=T.useState(""),[s,r]=T.useState(""),[c,f]=T.useState(null),[h,y]=T.useState(!1),m=async v=>{v.preventDefault(),y(!0),f(null);try{const b=await f_({username:e.trim(),password:s});n(b)}catch(b){f(b instanceof Error?b.message:"Login failed")}finally{y(!1)}};return u.jsxs("form",{onSubmit:m,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Username"}),u.jsx("input",{type:"text",value:e,onChange:v=>i(v.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",autoComplete:"username",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Password"}),u.jsx("input",{type:"password",value:s,onChange:v=>r(v.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",autoComplete:"current-password",required:!0})]}),c&&u.jsx("div",{className:"text-sm text-red-400 bg-red-900/30 border border-red-700 rounded-md px-3 py-2",children:c}),u.jsx("button",{type:"submit",disabled:h,className:"w-full py-2.5 rounded-md bg-cyan-600 hover:bg-cyan-700 text-white font-semibold transition disabled:opacity-60",children:h?"Signing in...":"Sign In"})]})},m_=({onSuccess:n})=>{const[e,i]=T.useState(""),[s,r]=T.useState(""),[c,f]=T.useState(""),[h,y]=T.useState(""),[m,v]=T.useState(""),[b,S]=T.useState({shop:!1,customer:!1,driver:!1,supplier:!1}),[w,C]=T.useState(""),[I,P]=T.useState(null),[k,V]=T.useState(!1),q=R=>{S(z=>({...z,[R]:!z[R]}))},D=async R=>{R.preventDefault(),V(!0),P(null);try{if(!(b.shop||b.customer||b.driver||b.supplier))throw new Error("Please select at least one role.");if(b.shop&&!e.trim())throw new Error("Shop owners must provide a shop name.");if(!b.shop&&!e.trim())throw new Error("Please provide your display name.");const F=await d_({username:s.trim(),email:c.trim(),password:h,displayName:e.trim(),roles:b,licenseId:b.driver?m.trim():void 0,supplierShopId:b.supplier&&w.trim()||void 0});n(F)}catch(z){P(z instanceof Error?z.message:"Registration failed")}finally{V(!1)}};return u.jsxs("form",{onSubmit:D,className:"space-y-4",children:[u.jsx("div",{className:"flex space-x-2",children:["shop","customer","driver","supplier"].map(R=>u.jsx("button",{type:"button",onClick:()=>q(R),className:`flex-1 py-2 rounded-md text-sm font-semibold capitalize ${b[R]?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:R},R))}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:b.shop?"Shop Name":"Display Name"}),u.jsx("input",{type:"text",value:e,onChange:R=>i(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),u.jsx("input",{type:"email",value:c,onChange:R=>f(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Username"}),u.jsx("input",{type:"text",value:s,onChange:R=>r(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Password"}),u.jsx("input",{type:"password",value:h,onChange:R=>y(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",required:!0})]}),b.driver&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"License ID (optional)"}),u.jsx("input",{type:"text",value:m,onChange:R=>v(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500"})]}),b.supplier&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Associated Shop ID (optional)"}),u.jsx("input",{type:"text",value:w,onChange:R=>C(R.target.value),className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"Link yourself to a shop UUID if applicable"})]}),I&&u.jsx("div",{className:"text-sm text-red-400 bg-red-900/30 border border-red-700 rounded-md px-3 py-2",children:I}),u.jsx("button",{type:"submit",disabled:k,className:"w-full py-2.5 rounded-md bg-cyan-600 hover:bg-cyan-700 text-white font-semibold transition disabled:opacity-60",children:k?"Creating...":"Create Account"})]})},$y=({onAuthenticated:n})=>{const[e,i]=T.useState("login");return u.jsx("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center p-6",children:u.jsxs("div",{className:"w-full max-w-lg bg-gray-800 border border-gray-700 rounded-xl p-6 shadow-2xl",children:[u.jsxs("div",{className:"flex space-x-2 mb-6",children:[u.jsx("button",{onClick:()=>i("login"),className:`flex-1 py-2 rounded-md font-semibold ${e==="login"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Login"}),u.jsx("button",{onClick:()=>i("register"),className:`flex-1 py-2 rounded-md font-semibold ${e==="register"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Create Account"})]}),e==="login"?u.jsx(p_,{onSuccess:n}):u.jsx(m_,{onSuccess:s=>{n(s),i("login")}})]})})},cd=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M12 2L9 9l-7 3 7 3 3 7 3-7 7-3-7-3-3-7z"}),u.jsx("path",{d:"M22 12l-3-1-1-3-1 3-3 1 3 1 1 3 1-3 3-1z"}),u.jsx("path",{d:"M5 3l1 2 2 1-2 1-1 2-1-2-2-1 2-1 1-2z"})]}),h_=({activeTab:n,onTabChange:e,user:i,onLogout:s,isBackendAvailable:r})=>{var w,C,I,P;const[c,f]=T.useState(!1),h=!!((w=i.roles)!=null&&w.shop||i.shopId),y=!!((C=i.roles)!=null&&C.customer||i.customerId),m=!!((I=i.roles)!=null&&I.driver||i.driverId),v=!!((P=i.roles)!=null&&P.supplier||i.supplierId),b=(k,V=!1)=>{let q="px-3 py-2 rounded-md text-sm font-medium transition-colors";return V?`${q} text-gray-500 cursor-not-allowed`:(q+=" cursor-pointer",n===k?`${q} bg-cyan-600 text-white`:`${q} text-gray-300 hover:bg-gray-700 hover:text-white`)},S=!i.isVerified;return u.jsx("header",{className:"bg-gray-800/50 backdrop-blur-sm sticky top-0 z-10",children:u.jsx("div",{className:"container mx-auto px-4 md:px-8",children:u.jsxs("div",{className:"flex items-center justify-between h-20 border-b border-gray-700",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(cd,{className:"w-8 h-8 text-cyan-400"}),u.jsx("h1",{className:"text-2xl font-bold tracking-tight text-white",children:"Autonomous Shop AI"})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("nav",{className:"hidden md:flex items-center space-x-2 p-1 bg-gray-900/50 rounded-lg border border-gray-700",children:[u.jsx("a",{onClick:()=>e("dashboard"),className:b("dashboard"),children:"Dashboard"}),h&&u.jsxs(u.Fragment,{children:[u.jsx("a",{onClick:()=>e("inventory"),className:b("inventory"),children:"Inventory"}),u.jsx("a",{onClick:()=>e("catalog"),className:b("catalog"),children:"Products"}),u.jsx("a",{onClick:()=>e("batches"),className:b("batches"),children:"Batches"}),u.jsx("a",{onClick:()=>!S&&e("marketplace"),className:b("marketplace",S),title:S?"Verification Pending":"Marketplace",children:"Marketplace"}),u.jsx("a",{onClick:()=>e("kiosk"),className:b("kiosk"),children:"Kiosk"})]}),y&&u.jsx("a",{onClick:()=>e("customer"),className:b("customer"),children:"Customer"}),v&&u.jsx("a",{onClick:()=>e("supplier"),className:b("supplier"),children:"Supplier"}),r&&u.jsx("a",{onClick:()=>e("backend"),className:b("backend"),children:"Backend"})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>f(!c),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-700",children:[u.jsx("div",{className:"w-8 h-8 bg-cyan-800 rounded-full flex items-center justify-center text-cyan-300 font-bold",children:i.companyName.charAt(0)}),u.jsx("span",{className:"hidden lg:inline text-sm font-medium text-white",children:i.companyName})]}),c&&u.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-gray-800 border border-gray-700 rounded-md shadow-lg z-20",children:[u.jsxs("div",{className:"px-4 py-3 border-b border-gray-700",children:[u.jsx("p",{className:"text-sm font-semibold text-white truncate",children:i.companyName}),u.jsx("p",{className:"text-xs text-gray-400 capitalize",children:i.role})]}),u.jsxs("div",{className:"px-4 py-2 text-xs text-gray-400",children:["Shop: ",h?u.jsx("span",{className:"text-green-400",children:"Enabled"}):u.jsx("span",{className:"text-gray-500",children:"Off"}),i.shopId&&u.jsxs("span",{className:"text-gray-500 ml-2",children:["(ID: ",i.shopId.slice(0,8),"...)"]})]}),u.jsxs("div",{className:"px-4 py-2 text-xs text-gray-400",children:["Customer: ",y?u.jsx("span",{className:"text-green-400",children:"Enabled"}):u.jsx("span",{className:"text-gray-500",children:"Off"}),i.customerId&&u.jsxs("span",{className:"text-gray-500 ml-2",children:["(ID: ",i.customerId.slice(0,8),"...)"]})]}),u.jsxs("div",{className:"px-4 py-2 text-xs text-gray-400",children:["Driver: ",m?u.jsx("span",{className:"text-green-400",children:"Enabled"}):u.jsx("span",{className:"text-gray-500",children:"Off"}),i.driverId&&u.jsxs("span",{className:"text-gray-500 ml-2",children:["(ID: ",i.driverId.slice(0,8),"...)"]})]}),u.jsxs("div",{className:"px-4 py-2 text-xs text-gray-400 border-b border-gray-700",children:["Supplier: ",v?u.jsx("span",{className:"text-green-400",children:"Enabled"}):u.jsx("span",{className:"text-gray-500",children:"Off"}),i.supplierId&&u.jsxs("span",{className:"text-gray-500 ml-2",children:["(ID: ",i.supplierId.slice(0,8),"...)"]})]}),u.jsx("a",{onClick:s,className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 cursor-pointer",children:"Logout"})]})]})]}),u.jsx("button",{className:"md:hidden text-gray-300",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})})]})})})},g_="modulepreload",y_=function(n){return"/"+n},ag={},Ky=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){let f=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),y=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=f(i.map(m=>{if(m=y_(m),m in ag)return;ag[m]=!0;const v=m.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${b}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":g_,v||(S.as="script"),S.crossOrigin="",S.href=m,y&&S.setAttribute("nonce",y),document.head.appendChild(S),v)return new Promise((w,C)=>{S.addEventListener("load",w),S.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return r.then(f=>{for(const h of f||[])h.status==="rejected"&&c(h.reason);return e().catch(c)})},x_=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),u.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Xy=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),u.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),u.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),Pu=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),u.jsx("polyline",{points:"12 6 12 12 16 14"})]}),v_=({toast:n,onRemove:e})=>{const[i,s]=T.useState(!1);T.useEffect(()=>{setTimeout(()=>s(!0),10);const f=n.duration??5e3,h=setTimeout(()=>{s(!1),setTimeout(()=>e(n.id),300)},f);return()=>clearTimeout(h)},[n.id,n.duration,e]);const r=()=>{switch(n.type){case"success":return"bg-green-900/90 border-green-700 text-green-100";case"error":return"bg-red-900/90 border-red-700 text-red-100";case"warning":return"bg-yellow-900/90 border-yellow-700 text-yellow-100";case"info":return"bg-cyan-900/90 border-cyan-700 text-cyan-100";default:return"bg-gray-900/90 border-gray-700 text-gray-100"}},c=()=>{switch(n.type){case"success":return u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case"info":return u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}};return u.jsxs("div",{className:`
        ${r()}
        border rounded-lg shadow-lg p-4 flex items-start space-x-3
        transition-all duration-300 ease-in-out
        ${i?"opacity-100 translate-x-0":"opacity-0 translate-x-full"}
      `,children:[u.jsx("div",{className:"flex-shrink-0 mt-0.5",children:c()}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("p",{className:"text-sm font-medium",children:n.message})}),u.jsx("button",{onClick:()=>{s(!1),setTimeout(()=>e(n.id),300)},className:"flex-shrink-0 text-current opacity-70 hover:opacity-100 transition-opacity","aria-label":"Close",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})},b_=({toasts:n,onRemove:e})=>u.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-md",children:n.map(i=>u.jsx(v_,{toast:i,onRemove:e},i.id))});let S_=0;const xr=new Set,Ya=[],Zn=()=>{const[n,e]=T.useState(Ya);return T.useEffect(()=>{const r=c=>e([...c]);return xr.add(r),r(Ya),()=>{xr.delete(r)}},[]),{toasts:n,showToast:(r,c="info",f)=>{const y={id:`toast-${S_++}`,message:r,type:c,duration:f};Ya.push(y),xr.forEach(m=>m([...Ya]))},removeToast:r=>{const c=Ya.findIndex(f=>f.id===r);c!==-1&&(Ya.splice(c,1),xr.forEach(f=>f([...Ya])))}}},bn=void 0;throw new Error("API_KEY environment variable not set");const $t={productId:{displayName:"Product ID",description:"Canonical product identifier",type:"string"},productName:{displayName:"Product Name",description:"Name of the product",type:"string"},manufacturer:{displayName:"Manufacturer",description:"Manufacturer of the product",type:"string"},category:{displayName:"Category",description:"Product category (e.g., Beverages, Snacks, Produce)",type:"string"},productDescription:{displayName:"Product Description",description:"Detailed description of the product",type:"string"},expirationDate:{displayName:"Exp. Date",description:"Expiration date in YYYY-MM-DD format",type:"string"},quantity:{displayName:"Quantity",description:"Quantity of the product",type:"number"},quantityType:{displayName:"Quantity Type",description:"Unit of measurement (e.g., units, kg, lbs, liters)",type:"string"},costPerUnit:{displayName:"Cost/Unit",description:"Cost per single unit of the product",type:"number"},supplier:{displayName:"Supplier",description:"Supplier or distributor name",type:"string"},deliveryDate:{displayName:"Delivery Date",description:"Delivery date in YYYY-MM-DD format",type:"string"},inventoryDate:{displayName:"Inventory Date",description:"Today's date in YYYY-MM-DD format",type:"string"}},N_={type:Te.OBJECT,properties:{productName:{type:Te.STRING,description:"Name of the product"},manufacturer:{type:Te.STRING,description:"Manufacturer of the product"},category:{type:Te.STRING,description:"A suitable category for the product (e.g., Beverages, Snacks, Dairy, Produce)"},expirationDate:{type:Te.STRING,description:"Expiration date in YYYY-MM-DD format"},quantity:{type:Te.NUMBER,description:"Quantity of the product"},quantityType:{type:Te.STRING,description:"Unit of measurement (e.g., units, kg, lbs, liters)"},costPerUnit:{type:Te.NUMBER,description:"Cost per single unit of the product"},supplier:{type:Te.STRING,description:"Supplier or distributor name, if visible"},deliveryDate:{type:Te.STRING,description:"Delivery date in YYYY-MM-DD format, if visible"}},required:["productName","manufacturer","category","expirationDate","quantity","quantityType","costPerUnit"]},w_={type:Te.OBJECT,properties:{supplierName:{type:Te.STRING,description:"The name of the supplier or vendor."},invoiceNumber:{type:Te.STRING,description:"The invoice or reference number for the delivery."},deliveryDate:{type:Te.STRING,description:"The delivery date in YYYY-MM-DD format."},items:{type:Te.ARRAY,description:"A complete list of all line items from the document.",items:{type:Te.OBJECT,properties:{productName:{type:Te.STRING,description:"The full name of the product as written on the document."},quantity:{type:Te.NUMBER,description:"The quantity of the product delivered."},costPerUnit:{type:Te.NUMBER,description:"The cost for a single unit of the product."}},required:["productName","quantity","costPerUnit"]}}}},yn=n=>new Promise((e,i)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>{const c=s.result.split(",")[1];e({inlineData:{data:c,mimeType:n.type}})},s.onerror=r=>i(r)}),Zy=async n=>{if(n.length===0)throw new Error("No documents provided for analysis.");try{const e=new Kt({apiKey:bn}),i=await Promise.all(n.map(h=>yn(h))),c=(await e.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[...i,{text:"Analyze these images of shipping documents (e.g., invoice, packing slip). Extract the supplier name, invoice number, delivery date, and a complete list of all line items. For each line item, provide the product name, quantity, and cost per unit. If a value isn't clearly present, omit it. Consolidate information if multiple documents are provided."}]},config:{responseMimeType:"application/json",responseSchema:w_}})).text.trim(),f=JSON.parse(c);if(typeof f!="object"||f===null)throw new Error("Invalid JSON structure received from API");return{supplierName:f.supplierName,invoiceNumber:f.invoiceNumber,deliveryDate:f.deliveryDate,items:f.items||[]}}catch(e){throw console.error("Error analyzing batch documents with Gemini:",e),new Error("Failed to extract batch data from the documents.")}},Or=async n=>{try{const e=new Kt({apiKey:bn}),i=await yn(n),r=(await e.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[i,{text:"Analyze this image of a product or delivery note. Extract inventory details. If a value isn't present, make a reasonable guess or use 'N/A' for strings and 0 for numbers. For dates, use YYYY-MM-DD format."}]},config:{responseMimeType:"application/json",responseSchema:N_}})).text.trim(),c=JSON.parse(r);if(typeof c!="object"||c===null)throw new Error("Invalid JSON structure received from API");return{productName:c.productName||"N/A",manufacturer:c.manufacturer||"N/A",category:c.category||"General",expirationDate:c.expirationDate||"N/A",quantity:Number(c.quantity)||0,quantityType:c.quantityType||"units",costPerUnit:Number(c.costPerUnit)||0,supplier:c.supplier,deliveryDate:c.deliveryDate}}catch(e){throw console.error("Error analyzing image with Gemini:",e),new Error("Failed to extract inventory data from the image.")}},ud=async(n,e)=>{try{const i=new Kt({apiKey:bn}),s=await yn(n),r=$t[e],c=`This image contains the ${r.displayName}. Extract ONLY the value for this field. Do not add any extra text, labels, or explanations. Return just the raw value. For dates, use YYYY-MM-DD format.`,h=(await i.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[s,{text:c}]}})).text.trim();if(r.type==="number"){const y=parseFloat(h.replace(/[^0-9.-]+/g,""));return isNaN(y)?0:y}return h}catch(i){throw console.error(`Error analyzing cropped image for field ${e}:`,i),new Error(`Failed to extract data for ${e}.`)}},Wy=async(n,e,i)=>{if(n.length===0&&!de)return"The inventory is currently empty. Please add items to generate a report.";const s=new Kt({apiKey:bn});try{let r="",c=[];if(de&&i.trim().length>0){const y=await vn(i);if(c=await Xu(y,de,20),c.length>0){const m=c.map(v=>{const b=e.find(w=>w.id===v.batchId),S=n.find(w=>w.productId===v.productId&&String(w.batchId)===String(v.batchId));return{inventoryUuid:v.inventoryUuid,productName:(S==null?void 0:S.productName)||"N/A",manufacturer:(S==null?void 0:S.manufacturer)||"N/A",category:(S==null?void 0:S.category)||"General",expirationDate:v.expirationDate,quantity:v.quantity,quantityType:(S==null?void 0:S.quantityType)||"units",costPerUnit:v.costPerUnit,supplier:b==null?void 0:b.supplier,deliveryDate:b==null?void 0:b.deliveryDate,inventoryDate:b==null?void 0:b.inventoryDate,location:v.location,buyPrice:v.buyPrice,sellPrice:v.sellPrice}});r=JSON.stringify(m,null,2),console.log("RAG applied: sending relevant inventory data to Gemini.")}else r=JSON.stringify(n.map(m=>{const v=e.find(b=>b.id===m.batchId);return{...m,supplier:v==null?void 0:v.supplier,deliveryDate:v==null?void 0:v.deliveryDate,inventoryDate:v==null?void 0:v.inventoryDate}}),null,2),console.warn("No relevant items found via RAG for the given prompt, falling back to full inventory context.")}else r=JSON.stringify(n.map(y=>{const m=e.find(v=>v.id===y.batchId);return{...y,supplier:m==null?void 0:m.supplier,deliveryDate:m==null?void 0:m.deliveryDate,inventoryDate:m==null?void 0:m.inventoryDate}}),null,2),console.log("RAG skipped: using full inventory context for analysis.");const f=`
      Based on the following inventory data, please provide an analysis for the request: "${i}".
      
      Inventory Data:
      ${r}
      
      Please format your response in clear, easy-to-read markdown.
    `;return(await s.models.generateContent({model:"gemini-2.5-pro",contents:f,config:{thinkingConfig:{thinkingBudget:32768}}})).text}catch(r){throw console.error("Error generating inventory report with Gemini Pro:",r),new Error("Failed to generate the inventory report.")}},dd=async(n,e)=>{if(e.length===0)return null;try{const i=new Kt({apiKey:bn}),s=await yn(n),r=`
      Analyze this image. Identify the main product visible.
      From the following list of known products, which one is it?
      Product list: [${e.join(", ")}]
      Respond with ONLY the name of the product from the list that matches best.
      If no product from the list is clearly identifiable, respond with the exact text "NO_PRODUCT".
    `,f=(await i.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[s,{text:r}]}})).text.trim();return f==="NO_PRODUCT"||!e.includes(f)?null:f}catch(i){return console.error("Error identifying product:",i),null}},ex=n=>{const e=n.split(","),i=e[0].match(/:(.*?);/);if(!i)throw new Error("Invalid data URL");const s=i[1],r=atob(e[1]);let c=r.length;const f=new Uint8Array(c);for(;c--;)f[c]=r.charCodeAt(c);return new Blob([f],{type:s})},tx=async(n,e,i)=>{try{const s=new Kt({apiKey:bn}),r=await yn(n),c=await yn(e),f=$t[i],h=`The first image is a close-up of a '${f.displayName}'. The second image is a wider view of a product. Find the exact feature from the first image within the second image and extract ONLY its value. Do not add any extra text, labels, or explanations. Return just the raw value. If you cannot find the feature, return the text "NOT_FOUND". For dates, use YYYY-MM-DD format.`,m=(await s.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[c,r,{text:h}]}})).text.trim();if(m==="NOT_FOUND")return null;if(f.type==="number"){const v=parseFloat(m.replace(/[^0-9.-]+/g,""));return isNaN(v)?null:v}return m}catch(s){return console.error(`Error finding feature for field ${i}:`,s),null}},E_={type:Te.OBJECT,properties:{estimatedQuantity:{type:Te.NUMBER,description:"Estimated total quantity including hidden units"},confidence:{type:Te.NUMBER,description:"Confidence score from 0 to 1"},reasoning:{type:Te.STRING,description:"Explanation of the estimation"},visualAnalysis:{type:Te.STRING,description:"Detailed visual observations"},shelfFullness:{type:Te.NUMBER,description:"Shelf fullness percentage (0-100)"},visibleUnits:{type:Te.NUMBER,description:"Number of units clearly visible"},hiddenUnits:{type:Te.NUMBER,description:"Estimated units hidden behind others"}},required:["estimatedQuantity","confidence","reasoning","visualAnalysis","shelfFullness","visibleUnits"]},nx=async(n,e,i)=>{try{const s=new Kt({apiKey:bn}),r=await yn(n),c=i?`Expected shelf capacity: ${i} units.`:"No expected capacity provided.",f=`Analyze this shelf photo for ${e}.
        
        Tasks:
        1. Count visible units of the product
        2. Estimate if there are units hidden behind others
        3. Assess shelf fullness (0-100%)
        4. Identify any damage or quality issues
        5. Check expiration dates if visible
        
        ${c}
        
        Provide detailed analysis with confidence score.`,h=await s.models.generateContent({model:"gemini-2.5-pro",contents:{parts:[r,{text:f}]},config:{responseMimeType:"application/json",responseSchema:E_}}),y=JSON.parse(h.text.trim());return{estimatedQuantity:y.estimatedQuantity||0,confidence:Math.max(0,Math.min(1,y.confidence||.5)),reasoning:y.reasoning||"",visualAnalysis:y.visualAnalysis||"",shelfFullness:Math.max(0,Math.min(100,y.shelfFullness||0)),visibleUnits:y.visibleUnits||0,hiddenUnits:y.hiddenUnits}}catch(s){throw console.error("Error estimating stock from shelf photo:",s),new Error("Failed to estimate stock from shelf photo.")}},T_={type:Te.OBJECT,properties:{qualityScore:{type:Te.NUMBER,description:"Overall quality score from 0 to 100"},issues:{type:Te.ARRAY,items:{type:Te.STRING},description:"List of quality issues found"},recommendations:{type:Te.ARRAY,items:{type:Te.STRING},description:"Recommendations for action"},expirationVisible:{type:Te.BOOLEAN,description:"Whether expiration date is visible"},expirationDate:{type:Te.STRING,description:"Detected expiration date in YYYY-MM-DD format if visible"},damageDetected:{type:Te.BOOLEAN,description:"Whether any damage was detected"},damageDescription:{type:Te.STRING,description:"Description of damage if found"},packagingIntegrity:{type:Te.STRING,description:"Packaging condition: good, fair, or poor"}},required:["qualityScore","issues","recommendations","expirationVisible","damageDetected","packagingIntegrity"]},ax=async(n,e,i)=>{try{const s=new Kt({apiKey:bn}),r=await yn(n),c=i?`Expected expiration: ${i}. Compare detected date with expected.`:"",f=`Analyze this image of ${e} for quality assessment.
        
        Check for:
        - Physical damage (dents, tears, broken seals)
        - Expiration date visibility and validity
        - Packaging integrity
        - Signs of spoilage (for perishables)
        - Overall condition
        
        ${c}
        
        Provide detailed quality assessment with actionable recommendations.`,h=await s.models.generateContent({model:"gemini-2.5-pro",contents:{parts:[r,{text:f}]},config:{responseMimeType:"application/json",responseSchema:T_}}),y=JSON.parse(h.text.trim());return{qualityScore:Math.max(0,Math.min(100,y.qualityScore||50)),issues:y.issues||[],recommendations:y.recommendations||[],expirationVisible:y.expirationVisible||!1,expirationDate:y.expirationDate,damageDetected:y.damageDetected||!1,damageDescription:y.damageDescription,packagingIntegrity:y.packagingIntegrity||"fair"}}catch(s){throw console.error("Error assessing product quality:",s),new Error("Failed to assess product quality.")}},fd=async(n,e)=>{try{const i=new Kt({apiKey:bn}),s=await yn(n),f=(await i.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[s,{text:`Describe this product in detail. Include:
        - Product name/brand
        - Category
        - Key visual features
        - Packaging type
        - Any text visible on packaging
        
        Return a concise product description suitable for search.`}]}})).text.trim(),h=await I1(f,n,.5,.5);return await Xu(h,e,10)}catch(i){return console.error("Error searching inventory by image:",i),[]}},ix=async n=>{try{const e=new Kt({apiKey:bn});return await Promise.all(n.map(async({image:s,expectedExpiration:r,productName:c})=>{try{const f=await yn(s),h=`Find and read the expiration date on this ${c}.
                    
                    Expected expiration: ${r}
                    
                    Return ONLY the expiration date in YYYY-MM-DD format if visible, or "NOT_VISIBLE" if not found.
                    Also indicate your confidence (0-1) in the detection.`,m=(await e.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[f,{text:h}]}})).text.trim();if(m.includes("NOT_VISIBLE")||m.includes("not visible"))return{productName:c,expectedExpiration:r,match:!1,confidence:0,discrepancy:"Expiration date not visible in image"};const b=m.match(/\d{4}-\d{2}-\d{2}/),S=b?b[0]:null;if(!S)return{productName:c,expectedExpiration:r,match:!1,confidence:0,discrepancy:"Could not parse date from image"};const w=S===r||S.split("-")[0]===r.split("-")[0];return{productName:c,expectedExpiration:r,detectedExpiration:S,match:w,discrepancy:w?void 0:`Expected ${r}, found ${S}`,confidence:w?.9:.7}}catch(f){return console.error(`Error verifying expiration for ${c}:`,f),{productName:c,expectedExpiration:r,match:!1,confidence:0,discrepancy:"Error processing image"}}}))}catch(e){throw console.error("Error verifying expiration dates:",e),new Error("Failed to verify expiration dates.")}},sx=async(n,e,i)=>{try{if(n.length===0)throw new Error("No shelf images provided.");const s=new Kt({apiKey:bn}),r=await Promise.all(n.map(yn)),f=`Analyze these shelf photos combined with inventory data.
        
        Inventory Data:
        ${JSON.stringify({inventory:e.slice(0,50).map(v=>({productId:v.productId,quantity:v.quantity,expirationDate:v.expirationDate})),recentSales:i.slice(-20).map(v=>({timestamp:v.timestamp,items:v.items,totalAmount:v.totalAmount}))},null,2)}
        
        Tasks:
        1. Compare visual stock levels with recorded inventory
        2. Identify discrepancies (visual vs recorded)
        3. Find products that look expired/damaged
        4. Suggest reordering based on visual stock levels
        5. Identify layout optimization opportunities
        6. Flag high-risk items (expiring soon, low stock, damaged)
        
        Provide actionable insights combining visual and data analysis.
        Format as structured recommendations with severity levels.`;return{insights:(await s.models.generateContent({model:"gemini-2.5-pro",contents:{parts:[...r,{text:f}]},config:{thinkingConfig:{thinkingBudget:32768}}})).text.split(`
`).filter(v=>v.trim().length>0&&(v.includes("insight")||v.includes("finding")||v.match(/^\d+\./))).slice(0,10),visualFindings:[],recommendations:[],riskItems:[],dataDiscrepancies:[]}}catch(s){throw console.error("Error generating visual insights:",s),new Error("Failed to generate visual inventory insights.")}},C_=Object.freeze(Object.defineProperty({__proto__:null,analyzeBatchDocuments:Zy,analyzeCroppedImageForField:ud,analyzeImageForInventory:Or,assessProductQuality:ax,dataUrlToBlob:ex,estimateStockFromShelfPhoto:nx,fieldMetadata:$t,findAndReadFeature:tx,generateInventoryReport:Wy,generateVisualInventoryInsights:sx,identifyProductNameFromImage:dd,searchInventoryByImage:fd,verifyExpirationDates:ix},Symbol.toStringTag,{value:"Module"})),ox=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v1a2.5 2.5 0 0 1-2.5 2.5h-1A2.5 2.5 0 0 1 6 5.5v-1A2.5 2.5 0 0 1 8.5 2h1Z"}),u.jsx("path",{d:"M14.5 2A2.5 2.5 0 0 1 17 4.5v1a2.5 2.5 0 0 1-2.5 2.5h-1a2.5 2.5 0 0 1-2.5-2.5v-1A2.5 2.5 0 0 1 12.5 2h2Z"}),u.jsx("path",{d:"M18 12a4.5 4.5 0 0 1-4.5 4.5h-3A4.5 4.5 0 0 1 6 12v-2a4.5 4.5 0 0 1 4.5-4.5h3A4.5 4.5 0 0 1 18 10v2Z"}),u.jsx("path",{d:"M6 12a2.5 2.5 0 0 0-2.5 2.5v1A2.5 2.5 0 0 0 6 18h1a2.5 2.5 0 0 0 2.5-2.5v-1A2.5 2.5 0 0 0 7 12h-1Z"}),u.jsx("path",{d:"M18 12a2.5 2.5 0 0 1 2.5 2.5v1a2.5 2.5 0 0 1-2.5 2.5h-1a2.5 2.5 0 0 1-2.5-2.5v-1a2.5 2.5 0 0 1 2.5-2.5h1Z"}),u.jsx("path",{d:"M12 11v1"}),u.jsx("path",{d:"M12 18v2"})]}),Oi=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),u.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),rx=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),u.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),lx=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M12 5a3 3 0 1 0-5.993.142"}),u.jsx("path",{d:"M12 5a3 3 0 1 1 5.993.142"}),u.jsx("path",{d:"M15 13a3 3 0 1 0-5.993.142"}),u.jsx("path",{d:"M15 13a3 3 0 1 1 5.993.142"}),u.jsx("path",{d:"M9 13a3 3 0 1 0-5.993.142"}),u.jsx("path",{d:"M9 13a3 3 0 1 1 5.993.142"}),u.jsx("path",{d:"M12 21a3 3 0 1 0-5.993-.142"}),u.jsx("path",{d:"M12 21a3 3 0 1 1 5.993.142"}),u.jsx("path",{d:"M12 13h.01"}),u.jsx("path",{d:"M12 5h.01"}),u.jsx("path",{d:"M12 21h.01"}),u.jsx("path",{d:"M18 13h.01"}),u.jsx("path",{d:"M6 13h.01"}),u.jsx("path",{d:"M18 5h.01"}),u.jsx("path",{d:"M6 5h.01"}),u.jsx("path",{d:"m18 5-3 4"}),u.jsx("path",{d:"m6 5 3 4"}),u.jsx("path",{d:"m18 13-3-4"}),u.jsx("path",{d:"m6 13 3-4"}),u.jsx("path",{d:"m15 21-3-4"}),u.jsx("path",{d:"m9 21 3-4"})]}),Zs=({onDataScanned:n,onClose:e,productOptions:i,mode:s="scan"})=>{const r=T.useRef(null),c=T.useRef(null),f=T.useRef(null),h=T.useRef(null),[y,m]=T.useState(null),[v,b]=T.useState({}),[S,w]=T.useState(new Map),[C,I]=T.useState(new Map),[P,k]=T.useState("auto-scanning"),[V,q]=T.useState(null),[D,R]=T.useState(null),[z,F]=T.useState(null),[ie,K]=T.useState(new Set),[Y,fe]=T.useState(new Map),[ue,Ne]=T.useState(null),[we,Re]=T.useState(new Set),A=T.useMemo(()=>{const W=new Map;return i.forEach(ce=>{W.has(ce.productName)||W.set(ce.productName,ce)}),W},[i]),B=T.useMemo(()=>Array.from(A.keys()),[A]),Z=T.useRef(v),re=T.useRef(C);T.useEffect(()=>{Z.current=v},[v]),T.useEffect(()=>{re.current=C},[C]);const ae=T.useCallback((W,ce,je,Ye)=>{if(ce==null||typeof ce=="string"&&ce.trim()==="")return;const Ze=re.current.get(W)??0;Z.current[W]!==void 0&&Z.current[W]!==null&&String(Z.current[W]).length>0&&Ze>=Ye||(b(ht=>({...ht,[W]:ce})),w(ht=>{const ct=new Map(ht);return ct.set(W,je),ct}),I(ht=>{const ct=new Map(ht);return ct.set(W,Ye),ct}))},[]),_=T.useCallback(()=>{h.current&&(clearInterval(h.current),h.current=null)},[]),L=T.useCallback(()=>{if(r.current&&f.current){const W=r.current,ce=f.current,je=W.getBoundingClientRect();ce.width=je.width,ce.height=je.height}},[]);T.useEffect(()=>{let W=null;return(async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){m("Camera not supported on this browser. Please use a modern browser on a secure (HTTPS) connection.");return}try{W=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}}),r.current&&(r.current.srcObject=W,r.current.onloadedmetadata=()=>L())}catch(je){console.error("Error accessing camera:",je),m("Could not access the camera. Please ensure permissions are granted and you are on a secure (HTTPS) site.")}})(),window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),_(),W&&W.getTracks().forEach(je=>je.stop())}},[L,_]);const $=T.useCallback(async()=>{if(!r.current||!c.current||document.hidden||P!=="auto-scanning")return;const W=r.current,ce=c.current;ce.width=W.videoWidth,ce.height=W.videoHeight;const je=ce.getContext("2d");if(!je)return;je.drawImage(W,0,0,W.videoWidth,W.videoHeight);const Ye=await new Promise(ke=>ce.toBlob(ke,"image/jpeg",.8));if(!Ye||P!=="auto-scanning")return;let Ze=null;try{const ke=await dd(Ye,B);Ze=ke&&A.get(ke)||null,(Ze==null?void 0:Ze.productId)!==(ue==null?void 0:ue.productId)&&Ne(Ze)}catch(ke){console.warn("Product identification failed:",ke)}if(Ze)try{const ke=await dy(Ze.productId);ke.size>0&&await Promise.all(Array.from(ke.entries()).map(async([ht,ct])=>{const nt=ht;if(ie.has(nt)||we.has(nt)||(re.current.get(nt)??0)>=.85)return;const dn=ex(`data:${ct.mimeType};base64,${ct.imageBase64}`),Zt=await tx(Ye,dn,nt);Zt!==null&&(ae(nt,Zt,"learned",.85),Re(Vt=>new Set(Vt).add(nt)))}))}catch(ke){console.warn("Learned field scan failed:",ke)}try{const ke=await Or(Ye);for(const ht in ke){const ct=ht;ie.has(ct)||ae(ct,ke[ct],"auto",.6)}}catch(ke){console.warn("Generic auto-scan analysis failed:",ke)}},[ue,ie,P,A,B,ae,we]);T.useEffect(()=>{P==="auto-scanning"&&!h.current?h.current=window.setInterval($,4e3):P!=="auto-scanning"&&_()},[P,$,_]),T.useEffect(()=>{const W=f.current,ce=W==null?void 0:W.getContext("2d");ce&&W&&(ce.clearRect(0,0,W.width,W.height),D&&(ce.fillStyle="#06b6d4",ce.beginPath(),ce.arc(D.x,D.y,10,0,2*Math.PI),ce.fill(),ce.strokeStyle="white",ce.lineWidth=2,ce.stroke()),z&&(ce.strokeStyle="#06b6d4",ce.lineWidth=3,ce.strokeRect(z.x,z.y,z.width,z.height)))},[D,z]);const se=W=>{q(W),k("manual-capture"),R(null),F(null)},me=W=>{var ce;if(P==="auto-scanning"){k("selecting-field");return}if(P==="manual-capture"&&V){const je=(ce=f.current)==null?void 0:ce.getBoundingClientRect();if(!je)return;const Ye=W.clientX-je.left,Ze=W.clientY-je.top;if(!D)R({x:Ye,y:Ze});else{const ke={x:Math.min(D.x,Ye),y:Math.min(D.y,Ze),width:Math.abs(Ye-D.x),height:Math.abs(Ze-D.y)};ke.width>10&&ke.height>10?(F(ke),ye(ke)):R(null)}}},ye=T.useCallback(async W=>{if(!r.current||!c.current||!V)return;k("analyzing"),R(null);const ce=r.current,je=c.current,Ye=ce.getBoundingClientRect(),Ze=ce.videoWidth/Ye.width,ke=ce.videoHeight/Ye.height,ht=W.x*Ze,ct=W.y*ke,nt=W.width*Ze,_n=W.height*ke;je.width=nt,je.height=_n;const dn=je.getContext("2d");dn&&(dn.drawImage(ce,ht,ct,nt,_n,0,0,nt,_n),je.toBlob(async Zt=>{if(Zt)try{fe(An=>new Map(An).set(V,Zt));const Vt=await ud(Zt,V);ae(V,Vt,"manual",1),K(An=>new Set(An).add(V)),Re(An=>{const oe=new Set(An);return oe.delete(V),oe})}catch(Vt){console.error(Vt),m(Vt instanceof Error?Vt.message:"Analysis failed")}q(null),F(null),k("auto-scanning")},"image/jpeg",.9))},[V,ae]),te=async()=>{if(s==="visual-search"){if(!r.current||!c.current){m("Camera not ready");return}const W=r.current,ce=c.current;ce.width=W.videoWidth,ce.height=W.videoHeight;const je=ce.getContext("2d");if(!je){m("Failed to get canvas context");return}je.drawImage(W,0,0,W.videoWidth,W.videoHeight);const Ye=await new Promise(Ze=>ce.toBlob(Ze,"image/jpeg",.85));Ye?(n({data:{},blobs:new Map([["productName",Ye]]),fieldSources:new Map,fieldConfidences:new Map}),e()):m("Failed to capture image");return}n({data:{...v},blobs:new Map(Y),identifiedProductId:ue==null?void 0:ue.productId,fieldSources:new Map(S),fieldConfidences:new Map(C)}),e()},Q=()=>{switch(P){case"auto-scanning":return ue?`Identified: ${ue.productName}. Using learned fields to scan.`:"Scanning automatically... Tap screen to select a field manually.";case"selecting-field":return"Select a field to capture manually.";case"manual-capture":return V?D?"Tap the opposite corner.":`Tap the first corner for ${$t[V].displayName}.`:"Select a field.";case"analyzing":return`Analyzing ${$t[V].displayName}...`;default:return"Ready to scan."}};return u.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex flex-col items-center justify-center","aria-modal":"true",children:[u.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"}),u.jsx("canvas",{ref:c,className:"hidden"}),u.jsx("canvas",{ref:f,className:"absolute inset-0 w-full h-full object-cover z-10 cursor-pointer",onClick:me}),P==="selecting-field"&&u.jsxs("div",{className:"absolute inset-0 bg-black/80 flex flex-col items-center justify-center z-20 p-4",children:[u.jsx("h3",{className:"text-xl font-bold mb-6 text-white",children:"Select a field to capture"}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 w-full max-w-2xl",children:Object.keys($t).map(W=>u.jsx("button",{onClick:()=>se(W),className:"p-3 bg-gray-700 text-white rounded-lg hover:bg-cyan-600 transition-colors text-sm",children:$t[W].displayName},W))}),u.jsx("button",{onClick:()=>k("auto-scanning"),className:"mt-8 bg-gray-600 px-6 py-2 rounded-lg hover:bg-gray-500 transition-colors",children:"Cancel & Resume Auto-Scan"})]}),y&&u.jsx("div",{className:"absolute top-4 bg-red-800/80 text-white p-3 rounded-lg text-center z-30 max-w-md mx-auto",children:y}),u.jsx("div",{className:"absolute top-4 bg-black/50 text-white px-4 py-2 rounded-full z-20 text-center",children:u.jsx("p",{children:Q()})}),P==="analyzing"&&u.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-20",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400"})}),u.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white bg-black/50 rounded-full p-2 hover:bg-black/80 transition-colors z-30","aria-label":"Close scanner",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),u.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 backdrop-blur-sm p-4 text-white rounded-t-lg shadow-2xl shadow-black z-20",children:[s==="visual-search"?u.jsxs(u.Fragment,{children:[u.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-2",children:"Visual Search"}),u.jsx("p",{className:"text-sm text-gray-300 mb-4",children:`Position the product in view and click "Capture & Search" to check if it's in inventory.`})]}):u.jsxs(u.Fragment,{children:[u.jsx("h3",{className:"text-lg font-bold text-cyan-400 mb-2",children:"Scanned Data"}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-1 text-sm max-h-32 overflow-y-auto",children:Object.keys(v).length>0?Object.entries(v).map(([W,ce])=>{const je=W,Ye=S.get(je);return u.jsxs("div",{className:"truncate flex items-center",children:[u.jsxs("span",{className:"font-semibold capitalize text-gray-400",children:[$t[je].displayName,": "]}),u.jsx("span",{className:"text-gray-100 ml-1",children:String(ce)}),Ye==="manual"&&u.jsx(rx,{className:"w-3 h-3 ml-2 text-cyan-400 flex-shrink-0"}),Ye==="learned"&&u.jsx(lx,{className:"w-4 h-4 ml-2 text-indigo-400 flex-shrink-0"})]},W)}):u.jsx("p",{className:"col-span-full text-gray-500 text-center py-4",children:"Data will appear here as it's scanned..."})})]}),u.jsx("button",{onClick:te,disabled:s==="scan"&&Object.keys(v).length===0||P==="analyzing",className:"mt-4 w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black focus:ring-cyan-500 disabled:bg-gray-600 disabled:cursor-not-allowed transition-all",children:s==="visual-search"?"Capture & Search":"Confirm & Use This Data"})]})]})},__=({inventoryData:n,salesHistory:e,productCatalog:i})=>{const[s,r]=T.useState("insights"),[c,f]=T.useState(!1),[h,y]=T.useState(null),[m,v]=T.useState([]),[b,S]=T.useState(null),[w,C]=T.useState(!1),{showToast:I}=Zn(),P=T.useCallback(q=>{v([q]),C(!1),y(null),I('Image captured! Click "Analyze Images" to process.',"success")},[I]),k=async()=>{if(m.length===0){y("Please capture at least one image.");return}f(!0),y(null),S(null);try{switch(s){case"insights":const q=await sx(m,n,e);S(q),I("Visual insights generated successfully!","success");break;case"stock-estimation":const D=prompt("Enter product name for stock estimation:")||"Unknown Product",R=prompt("Enter expected shelf capacity (optional):"),z=await nx(m[0],D,R?parseInt(R):void 0);S(z),I("Stock estimation completed!","success");break;case"quality-assessment":const F=prompt("Enter product name:")||"Unknown Product",ie=prompt("Enter expected expiration date (YYYY-MM-DD, optional):"),K=await ax(m[0],F,ie||void 0);S(K),I("Quality assessment completed!","success");break;case"visual-search":{const ue=ad();if(!ue){y("No active shop context. Please ensure you are logged in."),f(!1);return}const Ne=await fd(m[0],ue);S({items:Ne,count:Ne.length}),I(`Found ${Ne.length} matching items!`,"success")}break;case"expiration-verify":const Y=await Promise.all(m.map(async(ue,Ne)=>{const we=prompt(`Enter product name for image ${Ne+1}:`)||"Unknown Product",Re=prompt(`Enter expected expiration (YYYY-MM-DD) for image ${Ne+1}:`)||"";return{image:ue,productName:we,expectedExpiration:Re}})),fe=await ix(Y);S({verifications:fe}),I("Expiration verification completed!","success");break}}catch(q){const D=q instanceof Error?q.message:"An unknown error occurred.";y(D),I(`Error: ${D}`,"error")}finally{f(!1)}},V=()=>{if(!b)return null;switch(s){case"insights":const q=b;return u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Visual Insights"}),q.insights.length>0&&u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:"Key Insights"}),u.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:q.insights.map((K,Y)=>u.jsx("li",{children:K},Y))})]}),q.riskItems.length>0&&u.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-700",children:[u.jsx("h4",{className:"text-red-400 font-medium mb-2",children:"Risk Items"}),u.jsx("ul",{className:"space-y-2",children:q.riskItems.map((K,Y)=>u.jsxs("li",{className:"text-sm text-gray-300",children:[u.jsx("span",{className:"font-semibold",children:K.product}),": ",K.issue,u.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs ${K.severity==="high"?"bg-red-600":K.severity==="medium"?"bg-yellow-600":"bg-gray-600"}`,children:K.severity})]},Y))})]})]});case"stock-estimation":const D=b;return u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Stock Estimation Results"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Estimated Quantity"}),u.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:D.estimatedQuantity})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Confidence"}),u.jsxs("p",{className:"text-2xl font-bold text-cyan-400",children:[(D.confidence*100).toFixed(0),"%"]})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Visible Units"}),u.jsx("p",{className:"text-2xl font-bold text-white",children:D.visibleUnits})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Shelf Fullness"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[D.shelfFullness,"%"]})]})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:"Reasoning"}),u.jsx("p",{className:"text-gray-300 text-sm",children:D.reasoning})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:"Visual Analysis"}),u.jsx("p",{className:"text-gray-300 text-sm",children:D.visualAnalysis})]})]});case"quality-assessment":const R=b,z=R.qualityScore>=80?"text-green-400":R.qualityScore>=60?"text-yellow-400":"text-red-400";return u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Quality Assessment"}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Quality Score"}),u.jsxs("p",{className:`text-4xl font-bold ${z}`,children:[R.qualityScore,"/100"]})]}),R.issues.length>0&&u.jsxs("div",{className:"bg-red-900/20 p-4 rounded-lg border border-red-700",children:[u.jsx("h4",{className:"text-red-400 font-medium mb-2",children:"Issues Found"}),u.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:R.issues.map((K,Y)=>u.jsx("li",{children:K},Y))})]}),R.recommendations.length>0&&u.jsxs("div",{className:"bg-cyan-900/20 p-4 rounded-lg border border-cyan-700",children:[u.jsx("h4",{className:"text-cyan-400 font-medium mb-2",children:"Recommendations"}),u.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:R.recommendations.map((K,Y)=>u.jsx("li",{children:K},Y))})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Packaging"}),u.jsx("p",{className:"text-lg font-semibold text-white capitalize",children:R.packagingIntegrity})]}),u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Damage Detected"}),u.jsx("p",{className:`text-lg font-semibold ${R.damageDetected?"text-red-400":"text-green-400"}`,children:R.damageDetected?"Yes":"No"})]})]}),R.expirationDate&&u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Detected Expiration"}),u.jsx("p",{className:"text-lg font-semibold text-white",children:R.expirationDate})]})]});case"visual-search":const F=b;return u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Search Results (",F.count," items found)"]}),F.items.length>0?u.jsx("div",{className:"space-y-2",children:F.items.map((K,Y)=>u.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[u.jsxs("p",{className:"font-semibold text-white",children:["Product ID: ",K.productId]}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Quantity: ",K.quantity," | Expiration: ",K.expirationDate]})]},Y))}):u.jsx("p",{className:"text-gray-400",children:"No matching items found in inventory."})]});case"expiration-verify":const ie=b;return u.jsxs("div",{className:"mt-6 space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Expiration Verification Results"}),u.jsx("div",{className:"space-y-3",children:ie.verifications.map((K,Y)=>u.jsxs("div",{className:`p-4 rounded-lg border ${K.match?"bg-green-900/20 border-green-700":"bg-red-900/20 border-red-700"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"font-semibold text-white",children:K.productName}),u.jsx("span",{className:`px-2 py-1 rounded text-xs ${K.match?"bg-green-600":"bg-red-600"}`,children:K.match?"Match":"Mismatch"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Expected"}),u.jsx("p",{className:"text-white",children:K.expectedExpiration})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Detected"}),u.jsx("p",{className:"text-white",children:K.detectedExpiration||"Not visible"})]})]}),K.discrepancy&&u.jsx("p",{className:"text-red-400 text-sm mt-2",children:K.discrepancy})]},Y))})]});default:return null}};return u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsxs("h2",{className:"text-xl font-semibold mb-4 text-white flex items-center",children:[u.jsx(ox,{className:"w-6 h-6 mr-2 text-cyan-400"}),"Multi-Modal AI Visual Analysis"]}),u.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Use AI-powered visual analysis to gain insights from shelf photos, assess product quality, estimate stock levels, and more."}),u.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:["insights","stock-estimation","quality-assessment","visual-search","expiration-verify"].map(q=>u.jsx("button",{onClick:()=>{r(q),S(null),v([]),y(null),C(!1)},className:`px-3 py-2 rounded-md text-sm font-medium transition ${s===q?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:q.split("-").map(D=>D.charAt(0).toUpperCase()+D.slice(1)).join(" ")},q))}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Capture Image ",s==="insights"||s==="expiration-verify"?"(Can capture multiple)":"(Single capture)"]}),u.jsxs("button",{onClick:()=>C(!0),disabled:w||c,className:"w-full flex items-center justify-center gap-2 py-3 px-4 border border-gray-600 rounded-md text-sm font-medium text-gray-200 bg-gray-700/50 hover:bg-gray-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(Oi,{className:"w-5 h-5"}),m.length>0?`Re-capture Image (${m.length} captured)`:"Capture Image with Camera"]}),m.length>0&&u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[m.length,' image(s) ready for analysis. Click "Analyze Images" to process.']})]}),w&&u.jsx(Zs,{mode:"visual-search",productOptions:[],onDataScanned:q=>{if(q.blobs&&q.blobs.size>0){const D=q.blobs.get("productName")||Array.from(q.blobs.values())[0];D?P(D):(I("Failed to capture image. Please try again.","error"),C(!1))}else I("Failed to capture image. Please try again.","error"),C(!1)},onClose:()=>C(!1)}),u.jsx("button",{onClick:k,disabled:c||m.length===0,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 disabled:bg-gray-600 disabled:cursor-not-allowed transition-all",children:c?"Analyzing...":"Analyze Images"}),h&&u.jsx("div",{className:"mt-4 p-3 bg-red-900/50 border border-red-700 rounded-lg",children:u.jsx("p",{className:"text-red-400 text-sm",children:h})}),c&&u.jsxs("div",{className:"flex items-center justify-center my-4 p-4 bg-gray-900/50 rounded-lg",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-400"}),u.jsx("p",{className:"ml-3 text-cyan-400",children:"AI is analyzing your images..."})]}),V()]})},A_=({summaries:n,onNavigateToInventory:e,onRefreshData:i})=>{const[s,r]=T.useState(!1),[c,f]=T.useState([]),[h,y]=T.useState([]),{showToast:m}=Zn();T.useEffect(()=>{(async()=>{try{const w=await sd();f(w);try{const{getActiveShopId:C}=await Ky(async()=>{const{getActiveShopId:P}=await Promise.resolve().then(()=>L2);return{getActiveShopId:P}},void 0),I=C();if(I){const P=await ry(I);y(P)}}catch(C){console.warn("Could not load sales history:",C)}}catch(w){console.error("Error loading inventory data:",w)}})()},[n]);const v=async()=>{var S,w,C,I,P,k,V,q,D;if(confirm("This will create sample products, suppliers, batches, and inventory items. Continue?")){r(!0);try{const R=[{name:"Organic Milk - Whole",manufacturer:"Fresh Dairy Co.",category:"Dairy",description:"Fresh organic whole milk, 1 gallon",imageUrl:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=200"},{name:"Whole Wheat Bread",manufacturer:"Baker's Delight",category:"Bakery",description:"Fresh baked whole wheat bread, 1 loaf",imageUrl:"https://images.unsplash.com/photo-1509440159596-0249088772ff?w=200"},{name:"Bananas - Organic",manufacturer:"Tropical Farms",category:"Produce",description:"Organic bananas, 1 bunch (~2 lbs)",imageUrl:"https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?w=200"},{name:"Chicken Breast - Free Range",manufacturer:"Farm Fresh Poultry",category:"Meat",description:"Free range chicken breast, 1 lb",imageUrl:"https://images.unsplash.com/photo-1604503468506-a8da13d82791?w=200"},{name:"Organic Eggs - Large",manufacturer:"Happy Hens Farm",category:"Dairy",description:"Organic large eggs, 12 count",imageUrl:"https://images.unsplash.com/photo-1582722872445-44dc5f7e3c8f?w=200"},{name:"Tomatoes - Roma",manufacturer:"Garden Fresh",category:"Produce",description:"Fresh Roma tomatoes, 1 lb",imageUrl:"https://images.unsplash.com/photo-1546470427-e26264be0b01?w=200"}],z=[{name:"Fresh Dairy Co.",contactEmail:"orders@fresherdairy.com"},{name:"Baker's Delight",contactEmail:"supply@bakersdelight.com"},{name:"Tropical Farms",contactEmail:"sales@tropicalfarms.com"},{name:"Farm Fresh Poultry",contactEmail:"info@farmfreshpoultry.com"},{name:"Happy Hens Farm",contactEmail:"orders@happyhens.com"},{name:"Garden Fresh",contactEmail:"wholesale@gardenfresh.com"},{name:"Organic Foods Dist.",contactEmail:"sales@organicfoods.com"},{name:"Premium Meats Co.",contactEmail:"orders@premiummeats.com"}],F=[];for(const _ of z)try{const L=await Ki(_);F.push(L)}catch(L){console.warn("Failed to create supplier:",L)}const ie=[];for(let _=0;_<R.length;_++){const L=R[_],$=F.find(se=>se.name.toLowerCase().includes(L.manufacturer.toLowerCase().split(" ")[0]))||F[_]||F[0];try{const se=L.imageUrl?[{url:L.imageUrl,type:"manual",source:"user",addedAt:new Date().toISOString()}]:[],me=await $i({...L,defaultSupplierId:$==null?void 0:$.id,images:se});ie.push(me)}catch(se){console.warn("Failed to create product:",se)}}const K=new Date,Y=new Date(K);Y.setDate(Y.getDate()-7);const fe=new Date(K);fe.setDate(fe.getDate()-5);const ue=ie.slice(0,3).map(_=>({productId:_.id,productName:_.name,quantity:Math.floor(Math.random()*80)+20,cost:Math.random()*8+2})),Ne=await Js({supplierId:(S=F[0])==null?void 0:S.id,deliveryDate:Y.toISOString().split("T")[0],invoiceNumber:`INV-${Date.now()}-1`,documents:[],lineItems:ue}),we=ie.slice(0,2).map(_=>({productId:_.id,productName:_.name,quantity:Math.floor(Math.random()*60)+15,cost:Math.random()*10+3})),Re=await Js({supplierId:(w=F[1])==null?void 0:w.id,deliveryDate:fe.toISOString().split("T")[0],invoiceNumber:`INV-${Date.now()}-2`,documents:[],lineItems:we}),A=ie.slice(3,6).map(_=>({productId:_.id,productName:_.name,quantity:Math.floor(Math.random()*70)+20,cost:Math.random()*9+2})),B=await Js({supplierId:((C=F[3])==null?void 0:C.id)||((I=F[2])==null?void 0:I.id)||((P=F[0])==null?void 0:P.id),deliveryDate:Y.toISOString().split("T")[0],invoiceNumber:`INV-${Date.now()}-3`,documents:[],lineItems:A}),Z=ue.map((_,L)=>{var Q;const $=ie[L],se=[7,14,21,30][Math.floor(Math.random()*4)],me=new Date(K);me.setDate(me.getDate()+se);const ye=_.cost,te=ye*1.5;return{productName:$.name,manufacturer:$.manufacturer,category:$.category,quantity:_.quantity,quantityType:"units",costPerUnit:ye,buyPrice:ye,sellPrice:te,expirationDate:me.toISOString().split("T")[0],location:["A-1","B-2","C-3"][Math.floor(Math.random()*3)],images:$.images||[],supplierId:(Q=F[0])==null?void 0:Q.id,scanMetadata:null}}),re=we.map((_,L)=>{var Q;const $=ie[L],se=[10,17,24,31][Math.floor(Math.random()*4)],me=new Date(K);me.setDate(me.getDate()+se);const ye=_.cost,te=ye*1.5;return{productName:$.name,manufacturer:$.manufacturer,category:$.category,quantity:_.quantity,quantityType:"units",costPerUnit:ye,buyPrice:ye,sellPrice:te,expirationDate:me.toISOString().split("T")[0],location:["D-1","E-2","F-3"][Math.floor(Math.random()*3)],images:$.images||[],supplierId:(Q=F[1])==null?void 0:Q.id,scanMetadata:null}}),ae=A.map((_,L)=>{var Q,W,ce;const $=ie[3+L],se=[7,14,21,30][Math.floor(Math.random()*4)],me=new Date(K);me.setDate(me.getDate()+se);const ye=_.cost,te=ye*1.5;return{productName:$.name,manufacturer:$.manufacturer,category:$.category,quantity:_.quantity,quantityType:"units",costPerUnit:ye,buyPrice:ye,sellPrice:te,expirationDate:me.toISOString().split("T")[0],location:["G-1","H-2","I-3"][Math.floor(Math.random()*3)],images:$.images||[],supplierId:((Q=F[3])==null?void 0:Q.id)||((W=F[2])==null?void 0:W.id)||((ce=F[0])==null?void 0:ce.id),scanMetadata:null}});await zi({supplier:((k=F[0])==null?void 0:k.name)||"Test Supplier",deliveryDate:Y.toISOString().split("T")[0],inventoryDate:K.toISOString().split("T")[0]},Z),await zi({supplier:((V=F[1])==null?void 0:V.name)||"Test Supplier 2",deliveryDate:fe.toISOString().split("T")[0],inventoryDate:K.toISOString().split("T")[0]},re),await zi({supplier:((q=F[3])==null?void 0:q.name)||((D=F[2])==null?void 0:D.name)||"Test Supplier 3",deliveryDate:Y.toISOString().split("T")[0],inventoryDate:K.toISOString().split("T")[0]},ae),m(`Test data created: ${F.length} suppliers, ${ie.length} products, 3 batches, ${Z.length+re.length+ae.length} inventory items`,"success"),i&&await i()}catch(R){console.error("Error creating test data:",R),m("Failed to create test data: "+(R instanceof Error?R.message:"Unknown error"),"error")}finally{r(!1)}}},b=T.useMemo(()=>{const S=n.reduce((V,q)=>{const D=q.averageCostPerUnit||0;return V+q.totalQuantity*D},0),w=n.length,C=new Date;C.setHours(0,0,0,0);const I=new Date;I.setDate(C.getDate()+30),I.setHours(23,59,59,999);const P=n.filter(V=>{const q=new Date(V.earliestExpiration);return q.setHours(0,0,0,0),q>=C&&q<=I}),k=n.filter(V=>{const q=new Date(V.earliestExpiration);return q.setHours(0,0,0,0),q<C});return{totalValue:S,uniqueProducts:w,expiringSoon:P.length,expired:k.length,expiringSoonList:P,expiredList:k}},[n]);return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-white",children:"Dashboard"}),u.jsx("p",{className:"text-lg text-gray-400",children:"A high-level overview of your inventory status."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 flex items-center space-x-4",children:[u.jsx("div",{className:"p-3 bg-cyan-900/50 rounded-lg",children:u.jsx(x_,{className:"w-8 h-8 text-cyan-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Total Inventory Value"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",b.totalValue.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 flex items-center space-x-4",children:[u.jsx("div",{className:"p-3 bg-cyan-900/50 rounded-lg",children:u.jsx(Xy,{className:"w-8 h-8 text-cyan-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Unique Products"}),u.jsx("p",{className:"text-2xl font-bold text-white",children:b.uniqueProducts})]})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 flex items-center space-x-4",children:[u.jsx("div",{className:"p-3 bg-red-900/50 rounded-lg",children:u.jsx(Pu,{className:"w-8 h-8 text-red-400"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Expiring in 30 Days"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[b.expiringSoon," items"]}),b.expired>0&&u.jsxs("p",{className:"text-xs text-red-400 mt-1",children:[b.expired," expired"]})]})]})]}),(b.expired>0||b.expiringSoon>0)&&u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-red-700",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[u.jsx(Pu,{className:"w-6 h-6 text-red-400"}),"Expiration Alerts"]}),b.expired>0&&u.jsxs("div",{className:"mb-4",children:[u.jsxs("p",{className:"text-red-400 font-semibold mb-2",children:[" Expired Items (",b.expired,")"]}),u.jsx("ul",{className:"space-y-2",children:b.expiredList.slice(0,5).map(S=>u.jsxs("li",{className:"text-sm p-2 bg-red-900/30 rounded-md",children:[u.jsx("span",{className:"text-white font-medium",children:S.productName}),u.jsxs("span",{className:"text-red-300 ml-2",children:["Expired: ",S.earliestExpiration]})]},S.productName))})]}),b.expiringSoon>0&&u.jsxs("div",{children:[u.jsxs("p",{className:"text-yellow-400 font-semibold mb-2",children:[" Expiring Soon (",b.expiringSoon,")"]}),u.jsx("ul",{className:"space-y-2",children:b.expiringSoonList.slice(0,5).map(S=>{const w=new Date(S.earliestExpiration),C=Math.ceil((w.getTime()-new Date().getTime())/(1e3*60*60*24));return u.jsxs("li",{className:"text-sm p-2 bg-yellow-900/30 rounded-md",children:[u.jsx("span",{className:"text-white font-medium",children:S.productName}),u.jsxs("span",{className:"text-yellow-300 ml-2",children:["Expires in ",C," days: ",S.earliestExpiration]})]},S.productName)})})]})]}),u.jsx(__,{inventoryData:c,salesHistory:h,productCatalog:n}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Quick Actions"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{onClick:e,className:"w-full text-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all",children:"Add New Inventory Batch"}),n.length===0&&u.jsx("button",{onClick:v,disabled:s,className:"w-full text-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Creating Test Data...":" Create Test Data"})]})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Recently Added Products"}),n.length>0?u.jsx("ul",{className:"space-y-3",children:n.slice(0,3).map(S=>u.jsxs("li",{className:"flex justify-between items-center text-sm p-3 bg-gray-900/50 rounded-md",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:S.productName}),u.jsx("p",{className:"text-gray-400",children:S.manufacturer})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-bold text-white",children:[S.totalQuantity," ",S.quantityType]}),u.jsxs("p",{className:"text-gray-400",children:["Exp: ",S.earliestExpiration]})]})]},S.productName))}):u.jsx("p",{className:"text-center text-gray-500 py-4",children:"No inventory data available."})]})]})]})},Qa=n=>{if(!n)return"N/A";const e=new Date(n);return Number.isNaN(e.getTime())?n:e.toISOString().split("T")[0]},I_=n=>{const e=n.trim().split(" ");return e.length===1?e[0].slice(0,2).toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()},ig=7,sg=10,D_=({summaries:n,inventoryItems:e,onSelectProduct:i,onEditItem:s,onDeleteItem:r})=>{var q;const[c,f]=T.useState([]),[h,y]=T.useState(""),[m,v]=T.useState("all"),[b,S]=T.useState({});T.useEffect(()=>{(async()=>{try{const R=await _a();f(R)}catch(R){console.error("Failed to load suppliers:",R)}})()},[]);const w=T.useMemo(()=>h?n.filter(D=>D.supplierIds&&D.supplierIds.includes(h)):n,[n,h]),C=T.useMemo(()=>{if(m==="all")return w;const D=new Date,R=1e3*60*60*24;return w.filter(z=>{if(m==="expiringSoon"){const F=new Date(z.earliestExpiration);if(Number.isNaN(F.getTime()))return!1;const ie=Math.ceil((F.getTime()-D.getTime())/R);return ie>=0&&ie<=ig}return m==="lowStock"?z.totalQuantity<=sg:!0})},[w,m]);if(!n.length)return u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 text-center text-gray-400",children:[u.jsx("p",{className:"mb-4",children:"Your inventory is empty. Products need inventory items (stock) to appear here."}),u.jsxs("div",{className:"mt-4 p-4 bg-gray-900/50 rounded-lg text-left text-sm",children:[u.jsx("p",{className:"text-yellow-400 font-semibold mb-2",children:" How to add inventory:"}),u.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-gray-300",children:[u.jsx("li",{children:"Use the form on the left to add inventory items for existing products"}),u.jsx("li",{children:'Or use the "Batches" tab to log a delivery batch with multiple items'}),u.jsx("li",{children:"Products from Product Catalog need inventory items added to show up here"})]})]})]});if(n.length>0&&!C.length)return u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 text-center text-gray-400",children:[u.jsx("p",{className:"mb-2",children:"No products match the current filters."}),u.jsx("p",{className:"text-sm text-gray-400",children:"Try clearing the supplier or inventory filter above to see the full inventory list."})]});const P=D=>!D||D.length===0?[]:D.map(R=>{var z;return(z=c.find(F=>F.id===R))==null?void 0:z.name}).filter(R=>!!R),k=T.useMemo(()=>{const D=new Map;return e.forEach(R=>{const z=D.get(R.productId)||[];z.push(R),D.set(R.productId,z)}),D},[e]),V=D=>{S(R=>({...R,[D]:!R[D]}))};return u.jsxs("div",{children:[u.jsx("div",{className:"flex items-center justify-end mb-4",children:u.jsxs("div",{className:"flex flex-col gap-3 text-sm text-gray-300 md:flex-row md:items-center",children:[c.length>0&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{children:"Supplier:"}),u.jsxs("select",{value:h,onChange:D=>y(D.target.value),className:"px-3 py-1.5 rounded-md bg-gray-900 border border-gray-700 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[u.jsx("option",{value:"",children:"All Suppliers"}),c.map(D=>u.jsx("option",{value:D.id,children:D.name},D.id))]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{children:"Inventory filter:"}),u.jsxs("select",{value:m,onChange:D=>v(D.target.value),className:"px-3 py-1.5 rounded-md bg-gray-900 border border-gray-700 text-white text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[u.jsx("option",{value:"all",children:"All items"}),u.jsxs("option",{value:"expiringSoon",children:["Expiring in  ",ig," days"]}),u.jsxs("option",{value:"lowStock",children:["Low stock ( ",sg,")"]})]})]})]})}),h&&u.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Showing ",C.length," product(s) from ",((q=c.find(D=>D.id===h))==null?void 0:q.name)||"selected supplier"]}),u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-3",children:C.map(D=>{const R=P(D.supplierIds),z=k.get(D.productId)||[],F=b[D.productId];return u.jsxs("div",{onClick:()=>i(D),className:"bg-gray-800/60 border border-gray-700 rounded-xl overflow-hidden text-left hover:border-cyan-500 transition cursor-pointer",children:[u.jsx("div",{className:"h-32 bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center text-3xl font-bold text-gray-300",children:I_(D.productName)}),u.jsxs("div",{className:"p-4 space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-white",children:D.productName}),u.jsx("p",{className:"text-sm text-gray-400",children:D.manufacturer})]}),u.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-300",children:[u.jsxs("span",{className:"font-medium text-white",children:[D.totalQuantity," ",D.quantityType]}),u.jsxs("span",{className:"text-xs uppercase tracking-wide text-gray-400",children:["Exp: ",Qa(D.earliestExpiration)]})]}),R.length>0&&u.jsxs("div",{className:"pt-1 border-t border-gray-700",children:[u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Suppliers:"}),u.jsx("div",{className:"flex flex-wrap gap-1",children:R.map((ie,K)=>u.jsx("span",{className:"px-2 py-0.5 text-xs bg-cyan-900/30 text-cyan-300 rounded border border-cyan-700/50",children:ie},K))})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"Location: Not set"}),z.length>0&&u.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-2",children:[u.jsxs("span",{children:[z.length," inventory item",z.length>1?"s":""]}),u.jsx("button",{onClick:ie=>{ie.stopPropagation(),V(D.productId)},className:"text-cyan-300 hover:text-cyan-200",children:F?"Hide items":"Manage items"})]}),F&&u.jsx("div",{className:"space-y-2",children:z.map(ie=>u.jsxs("div",{className:"p-2 bg-gray-900/60 rounded text-xs text-gray-300 border border-gray-800 flex flex-col gap-1",onClick:K=>K.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("span",{children:["Qty: ",ie.quantity," ",ie.quantityType]}),u.jsxs("span",{children:["Exp: ",Qa(ie.expirationDate)]})]}),u.jsxs("div",{className:"flex justify-between text-gray-400",children:[u.jsx("span",{children:ie.location?`Loc: ${ie.location}`:"Location N/A"}),u.jsxs("span",{children:["$",ie.costPerUnit.toFixed(2),"/unit"]})]}),u.jsxs("div",{className:"flex justify-end gap-2 pt-1",children:[u.jsx("button",{onClick:K=>{K.stopPropagation(),s(ie)},disabled:!ie.inventoryUuid,className:"px-2 py-1 rounded bg-gray-700 text-white disabled:opacity-40 disabled:cursor-not-allowed",children:"Edit"}),u.jsx("button",{onClick:K=>{K.stopPropagation(),r(ie)},disabled:!ie.inventoryUuid,className:"px-2 py-1 rounded bg-red-700/80 text-white disabled:opacity-40 disabled:cursor-not-allowed",children:"Delete"})]})]},ie.inventoryUuid||ie.id))})]})]})]},D.productId)})})]})},M_=({inventory:n,batches:e,onEditRequest:i,onDeleteRequest:s})=>n.length===0?u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 text-center text-gray-400",children:[u.jsx("h2",{className:"text-xl font-semibold mb-2 text-white",children:"Current Inventory"}),u.jsx("p",{children:"Your inventory is empty. Add items using the form to see them here."})]}):u.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:[u.jsx("h2",{className:"text-xl font-semibold text-white p-6",children:"Current Inventory"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[u.jsx("thead",{className:"bg-gray-800",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-300 sm:pl-6",children:"Product Name"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Manufacturer"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Exp. Date"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Quantity"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Supplier"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Cost/Unit"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-300",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-700 bg-gray-900/50",children:n.map(r=>{var c;return u.jsxs("tr",{className:"hover:bg-gray-800 transition-colors",children:[u.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-white sm:pl-6",children:r.productName}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:r.manufacturer}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:Qa(r.expirationDate)}),u.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:[r.quantity," ",r.quantityType]}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:((c=e.find(f=>f.id===r.batchId))==null?void 0:c.supplier)||"N/A"}),u.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:["$",r.costPerUnit.toFixed(2)]}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-right text-gray-400",children:u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>i(r),disabled:!r.inventoryUuid,className:"px-3 py-1 rounded-md bg-gray-700 text-white text-xs hover:bg-gray-600 disabled:opacity-40 disabled:cursor-not-allowed",children:"Edit"}),u.jsx("button",{onClick:()=>s(r),disabled:!r.inventoryUuid,className:"px-3 py-1 rounded-md bg-red-700/70 text-white text-xs hover:bg-red-700 disabled:opacity-40 disabled:cursor-not-allowed",children:"Delete"})]})})]},r.id)})})]})})]}),R_=({items:n,batches:e})=>{const[i,s]=T.useState(""),[r,c]=T.useState(null),[f,h]=T.useState(!1),[y,m]=T.useState(null),v=["Which items expire in the next 30 days?","What is the total value of my current inventory?","Summarize stock levels by supplier.","Identify my most expensive items per unit."],b=async()=>{if(!i){m("Please enter a query for the report.");return}h(!0),m(null),c(null);try{const S=await Wy(n,e,i);c(S)}catch(S){m(S instanceof Error?S.message:"An unknown error occurred.")}finally{h(!1)}};return u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsxs("h2",{className:"text-xl font-semibold mb-4 text-white flex items-center",children:[u.jsx(ox,{className:"w-6 h-6 mr-2 text-cyan-400"}),"Advanced Inventory Analysis (Gemini Pro)"]}),u.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Use our most powerful model to get deep insights into your inventory. Ask complex questions to make better business decisions."}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{htmlFor:"analysis-prompt",className:"block text-sm font-medium text-gray-300 mb-2",children:"Your Analysis Request"}),u.jsx("textarea",{id:"analysis-prompt",rows:3,className:"block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm",placeholder:"e.g., What is the total value of my current stock?",value:i,onChange:S=>s(S.target.value)})]}),u.jsxs("div",{className:"mb-4 flex flex-wrap gap-2",children:[u.jsx("span",{className:"text-sm text-gray-400 self-center",children:"Try:"}),v.map(S=>u.jsx("button",{onClick:()=>s(S),className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded-md hover:bg-cyan-800 hover:text-white transition-colors",children:S},S))]}),u.jsx("button",{onClick:b,disabled:f||n.length===0,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 disabled:bg-gray-600 disabled:cursor-not-allowed transition-all",children:f?"Thinking...":"Generate Report"}),n.length===0&&u.jsx("p",{className:"text-yellow-400 text-sm mt-2 text-center",children:"Add items to inventory to enable analysis."}),y&&u.jsx("p",{className:"text-red-400 text-sm mt-2",children:y}),f&&u.jsxs("div",{className:"flex items-center justify-center my-4 p-4 bg-gray-900/50 rounded-lg",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-400"}),u.jsx("p",{className:"ml-3 text-cyan-400",children:"Gemini Pro is processing your request..."})]}),r&&u.jsxs("div",{className:"mt-6 p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Analysis Report"}),u.jsx("div",{className:"prose prose-invert prose-sm max-w-none text-gray-300",dangerouslySetInnerHTML:{__html:r.replace(/\n/g,"<br />")}})]})]})},U_=({product:n,allItems:e,allBatches:i,onClose:s})=>{const r=m=>typeof m!="number"||Number.isNaN(m)?"N/A":`$${m.toFixed(2)}`,c=e.filter(m=>m.productName===n.productName).map(m=>{const v=i.find(b=>b.id===m.batchId);return{...m,batch:v}}).sort((m,v)=>new Date(m.expirationDate).getTime()-new Date(v.expirationDate).getTime()),f=T.useMemo(()=>c.reduce((m,v)=>{const b=typeof v.costPerUnit=="number"?v.costPerUnit:0;return m+b*v.quantity},0),[c]),h=n.totalQuantity>0?f/n.totalQuantity:0,y=T.useMemo(()=>{const m=new Map;return c.forEach(v=>{var k,V,q;const b=((k=v.batch)==null?void 0:k.id)??v.batchId??`line-${v.id}`,S=String(b),w=((V=v.batch)==null?void 0:V.supplier)??"N/A",C=(q=v.batch)==null?void 0:q.inventoryDate,I=typeof v.costPerUnit=="number"?v.costPerUnit:0,P=m.get(S)??{batchId:S,supplier:w,inventoryDate:C,quantity:0,totalValue:0};P.quantity+=v.quantity,P.totalValue+=I*v.quantity,P.supplier=w,P.inventoryDate=C,m.set(S,P)}),Array.from(m.values()).sort((v,b)=>v.batchId.localeCompare(b.batchId))},[c]);return u.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 flex items-center justify-center p-4",onClick:s,children:u.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[u.jsxs("div",{className:"p-6 border-b border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:n.productName}),u.jsx("p",{className:"text-sm text-gray-400",children:n.manufacturer})]}),u.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"mt-4 flex space-x-8 text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Total Quantity"}),u.jsxs("p",{className:"text-white font-semibold text-lg",children:[n.totalQuantity," ",n.quantityType]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Earliest Expiration"}),u.jsx("p",{className:"text-yellow-400 font-semibold text-lg",children:Qa(n.earliestExpiration)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Average Unit Cost"}),u.jsx("p",{className:"text-cyan-400 font-semibold text-lg",children:r(h)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Inventory Value"}),u.jsx("p",{className:"text-green-400 font-semibold text-lg",children:r(f)})]})]})]}),u.jsxs("div",{className:"p-6 overflow-y-auto",children:[u.jsx("h3",{className:"text-lg font-semibold text-cyan-400 mb-3",children:"Batch Details (First-Expired, First-Out)"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[u.jsx("thead",{className:"bg-gray-800",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"py-3 pl-4 pr-3 text-left text-sm font-semibold text-gray-300 sm:pl-0",children:"Quantity"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Exp. Date"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Supplier"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Inventory Date"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Cost / Unit"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Buy Price"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Sell Price"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Line Value"}),u.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-sm font-semibold text-gray-300",children:"Batch"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-700",children:c.map(m=>{var v,b,S;return u.jsxs("tr",{children:[u.jsxs("td",{className:"py-3 pl-4 pr-3 text-sm text-white sm:pl-0",children:[m.quantity," ",m.quantityType]}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-300",children:Qa(m.expirationDate)}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-400",children:((v=m.batch)==null?void 0:v.supplier)??"N/A"}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-400",children:Qa((b=m.batch)==null?void 0:b.inventoryDate)}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-300",children:r(m.costPerUnit)}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-300",children:r(m.buyPrice)}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-300",children:typeof m.sellPrice=="number"?r(m.sellPrice):""}),u.jsx("td",{className:"px-3 py-3 text-sm text-gray-300",children:r((m.costPerUnit||0)*m.quantity)}),u.jsx("td",{className:"px-3 py-3 text-xs text-gray-500",children:((S=m.batch)==null?void 0:S.id)??String(m.batchId)})]},m.id)})})]})}),y.length>0&&u.jsxs("div",{className:"mt-6",children:[u.jsx("h4",{className:"text-md font-semibold text-gray-200 mb-3",children:"Cost Overview by Batch"}),u.jsx("div",{className:"space-y-3",children:y.map(m=>u.jsxs("div",{className:"p-4 bg-gray-900/40 border border-gray-700 rounded-lg flex flex-wrap gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Batch"}),u.jsx("p",{className:"text-white font-semibold",children:m.batchId})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Supplier"}),u.jsx("p",{className:"text-white",children:m.supplier})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Inventory Date"}),u.jsx("p",{className:"text-white",children:Qa(m.inventoryDate)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Quantity"}),u.jsxs("p",{className:"text-white",children:[m.quantity," ",n.quantityType]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400",children:"Batch Value"}),u.jsx("p",{className:"text-green-400 font-semibold",children:r(m.totalValue)})]})]},m.batchId))})]}),u.jsxs("div",{className:"mt-6 p-4 bg-gray-900/50 rounded-lg border border-cyan-800/50",children:[u.jsx("h4",{className:"font-semibold text-cyan-500",children:"POS Integration Note"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'The list above is sorted by expiration date. For a "First-Expired, First-Out" (FEFO) strategy, a Point-of-Sale system would automatically deduct sold items from the top of this list, ensuring optimal stock rotation and minimizing waste.'})]})]})]})})},cx=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),u.jsx("polyline",{points:"17 8 12 3 7 8"}),u.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),gu={supplier:"",deliveryDate:"",inventoryDate:new Date().toISOString().split("T")[0]},og={productName:"",manufacturer:"",category:"",productDescription:"",productId:void 0,supplierId:void 0,expirationDate:"",quantity:0,quantityType:"units",costPerUnit:0,location:"",buyPrice:0,sellPrice:void 0,images:[],scanMetadata:null,shareScope:["local"]},P_=({onAddBatch:n,summaries:e,pendingScanResult:i})=>{const[s,r]=T.useState(gu),[c,f]=T.useState(og),[h,y]=T.useState([]),[m,v]=T.useState(!1),[b,S]=T.useState(null),[w,C]=T.useState(null),[I,P]=T.useState(!1),k=T.useRef(null),[V,q]=T.useState(new Map),[D,R]=T.useState(new Map),[z,F]=T.useState([]),[ie,K]=T.useState([]),[Y,fe]=T.useState(""),[ue,Ne]=T.useState(""),[we,Re]=T.useState("existing"),[A,B]=T.useState("existing"),[Z,re]=T.useState({name:"",email:""}),[ae,_]=T.useState(!1),[L,$]=T.useState(null),[se,me]=T.useState(!1),ye=T.useRef(null),te=T.useRef(!1),Q=T.useMemo(()=>{const oe=new Map;return z.forEach(le=>{oe.set(le.name,{productId:le.id,productName:le.name})}),e.forEach(le=>{oe.has(le.productName)||oe.set(le.productName,{productId:le.productId,productName:le.productName})}),Array.from(oe.values())},[z,e]),W=T.useCallback(oe=>{const le=new Set(["local"]);return(oe||[]).forEach(Ee=>Ee&&le.add(Ee)),Array.from(le)},[]),ce=T.useCallback(oe=>oe?oe.toLowerCase().trim().replace(/[^a-z0-9]+/gi,"-"):"unlabeled-product",[]),je=T.useCallback((oe,le)=>{f(Ee=>{const Ve=new Set(W(Ee.shareScope));return le?Ve.add(oe):Ve.delete(oe),Ve.size||Ve.add("local"),{...Ee,shareScope:Array.from(Ve)}})},[W]);T.useEffect(()=>()=>{D.forEach(oe=>URL.revokeObjectURL(oe))},[D]),T.useEffect(()=>{we==="new"&&(fe(""),f(oe=>({...oe,productId:void 0})))},[we]),T.useEffect(()=>{A==="new"&&(Ne(""),f(oe=>({...oe,supplierId:void 0})))},[A]);const Ye=T.useCallback(async()=>{try{const[oe,le]=await Promise.all([Hr(),_a()]);F(oe),K(le)}catch(oe){console.error("Failed to load reference data",oe)}},[]);T.useEffect(()=>{Ye()},[Ye]);const Ze=T.useCallback(async oe=>{C(URL.createObjectURL(oe)),v(!0),S(null);try{const le=await Or(oe);r(Ee=>({...Ee,supplier:Ee.supplier||le.supplier||"",deliveryDate:Ee.deliveryDate||le.deliveryDate||""})),f(Ee=>({...Ee,productName:le.productName||"",manufacturer:le.manufacturer||"",category:le.category||"",expirationDate:le.expirationDate||"",quantity:le.quantity||0,quantityType:le.quantityType||"units",costPerUnit:le.costPerUnit||0}))}catch(le){S(le instanceof Error?le.message:"An unknown error occurred.")}finally{v(!1)}},[]),ke=T.useCallback(oe=>{var Ee;const le=(Ee=oe.target.files)==null?void 0:Ee[0];le&&Ze(le)},[Ze]),ht=T.useCallback(oe=>{const{data:le,blobs:Ee,identifiedProductId:Ve}=oe;P(!1),C(null),k.current&&(k.current.value=""),$(oe),D.forEach(_e=>URL.revokeObjectURL(_e));const In=new Map;if(Ee.forEach((_e,_t)=>In.set(_t,URL.createObjectURL(_e))),R(In),q(Ee),r(_e=>({..._e,supplier:_e.supplier||le.supplier||"",deliveryDate:_e.deliveryDate||le.deliveryDate||""})),Ve){const _e=z.find(_t=>_t.id===Ve);if(_e){me(!1),Re("existing"),fe(_e.id),f(_t=>({..._t,productId:_e.id,productName:_e.name,manufacturer:_e.manufacturer,category:_e.category,productDescription:_e.description||"",expirationDate:le.expirationDate||_t.expirationDate||"",quantity:le.quantity||_t.quantity||1,quantityType:le.quantityType||_t.quantityType||"units",costPerUnit:le.costPerUnit||_t.costPerUnit||0}));return}}Re("new"),me(!0),f(_e=>({..._e,productName:le.productName||_e.productName||"",manufacturer:le.manufacturer||_e.manufacturer||"",category:le.category||_e.category||"",expirationDate:le.expirationDate||_e.expirationDate||"",quantity:le.quantity||_e.quantity||0,quantityType:le.quantityType||_e.quantityType||"units",costPerUnit:le.costPerUnit||_e.costPerUnit||0}))},[D,z]);T.useEffect(()=>{i&&i!==ye.current&&!te.current&&(te.current=!0,ye.current=i,ht(i),setTimeout(()=>{te.current=!1},100))},[i]);const ct=oe=>{const{name:le,value:Ee}=oe.target;r(Ve=>({...Ve,[le]:Ee}))},nt=oe=>{const{name:le,value:Ee,type:Ve}=oe.target,In=Ve==="number";f(_e=>({..._e,[le]:In?parseFloat(Ee)||0:Ee}))},_n=oe=>{var Ee;Ne(oe),f(Ve=>({...Ve,supplierId:oe||void 0}));const le=(Ee=ie.find(Ve=>Ve.id===oe))==null?void 0:Ee.name;le&&r(Ve=>({...Ve,supplier:le}))},dn=oe=>{const{name:le,value:Ee}=oe.target;re(Ve=>({...Ve,[le]:Ee}))},Zt=async oe=>{if(oe.preventDefault(),!Z.name.trim()){S("Supplier name is required.");return}_(!0),S(null);try{const le=await Ki({name:Z.name.trim(),contactEmail:Z.email.trim()||void 0});await Ye(),B("existing"),Ne(le.id),f(Ee=>({...Ee,supplierId:le.id})),r(Ee=>({...Ee,supplier:le.name||le.id})),re({name:"",email:""})}catch(le){S(le instanceof Error?le.message:"Failed to create supplier.")}finally{_(!1)}},Vt=async oe=>{if(oe.preventDefault(),c.productName&&c.quantity>0){let le=[];if(V.size>0&&c.productName){v(!0),S(null);try{const _e=await Promise.all(Array.from(V.entries()).map(async([Sn,Fr])=>{const Yr=await Wu(c.productName,Sn,Fr,{productId:Y||c.productId||ce(c.productName),source:(L==null?void 0:L.fieldSources.get(Sn))||"manual"});return{field:String(Sn),captureId:Yr,source:(L==null?void 0:L.fieldSources.get(Sn))||"manual",confidence:L==null?void 0:L.fieldConfidences.get(Sn)}})),_t=new Date().toISOString();le=_e.map(Sn=>({...Sn,capturedAt:_t}))}catch(_e){console.error(_e),S("Could not save scan images.")}finally{v(!1)}}const Ee=L?Array.from(L.fieldConfidences.values()).filter(_e=>typeof _e=="number"):[],Ve=Ee.length>0?Ee.reduce((_e,_t)=>_e+_t,0)/Ee.length:void 0,In=le.length?{confidence:Ve,fieldCaptures:le}:Ve!==void 0?{confidence:Ve}:null;y(_e=>[..._e,{...c,productId:Y||c.productId,supplierId:ue||c.supplierId,shareScope:W(c.shareScope),scanMetadata:In}]),f(og),fe(""),Ne(""),C(null),$(null),me(!1),k.current&&(k.current.value=""),q(new Map),D.forEach(_e=>URL.revokeObjectURL(_e)),R(new Map),ye.current=null,te.current=!1}},An=()=>{h.length>0&&s.supplier&&s.deliveryDate?(n(s,h),r(gu),y([])):S("Please add at least one item and fill in all batch details (Supplier, Delivery Date).")};return u.jsxs(u.Fragment,{children:[I&&u.jsx(Zs,{onDataScanned:ht,onClose:()=>P(!1),productOptions:Q}),u.jsxs("div",{className:"bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-sm p-8 rounded-xl border border-gray-700/50 shadow-2xl",children:[u.jsxs("h2",{className:"text-2xl font-bold mb-6 text-white flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-lg",children:u.jsx(cd,{className:"w-6 h-6 text-cyan-400"})}),"Add New Inventory Batch"]}),u.jsxs("div",{className:"space-y-6 p-6 bg-gray-900/40 border border-gray-700/50 rounded-xl mb-6 backdrop-blur-sm shadow-inner",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center",children:u.jsx("span",{className:"text-cyan-400 font-bold text-sm",children:"1"})}),u.jsx("h3",{className:"font-bold text-xl text-gray-100",children:"Batch Details"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/30 rounded-lg border border-gray-700/30",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-gray-200 mb-3",children:"Product Selection"}),u.jsx("div",{className:"flex gap-2 mb-4",children:["existing","new"].map(oe=>u.jsx("button",{type:"button",onClick:()=>Re(oe),className:`flex-1 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${we===oe?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white shadow-lg shadow-cyan-500/30":"bg-gray-700/50 text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:oe==="existing"?"Existing Product":"New Product"},oe))})]}),se&&we==="new"&&u.jsx("div",{className:"p-3 bg-amber-500/10 border border-amber-500/40 rounded-lg text-sm text-amber-100",children:"New product detected. Review the static fields below so we can register it in the catalog when this batch is saved."}),we==="existing"?u.jsx("div",{children:u.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",value:Y,onChange:oe=>{const le=oe.target.value;if(fe(le),!le){f(Ve=>({...Ve,productId:void 0,productName:"",manufacturer:"",category:"",productDescription:""}));return}const Ee=z.find(Ve=>Ve.id===le);Ee&&f(Ve=>({...Ve,productId:Ee.id,productName:Ee.name,manufacturer:Ee.manufacturer,category:Ee.category,productDescription:Ee.description||""}))},children:[u.jsx("option",{value:"",children:"Select from catalog"}),z.map(oe=>u.jsxs("option",{value:oe.id,children:[oe.name,"  ",oe.manufacturer]},oe.id))]})}):u.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:u.jsx("p",{className:"text-sm text-blue-300",children:"Manual entry enabled. Fill in the product fields below to register a new product as you scan it."})})]}),u.jsxs("div",{className:"space-y-4 p-4 bg-gray-800/30 rounded-lg border border-gray-700/30",children:[u.jsx("div",{className:"flex items-center justify-between gap-2 mb-2",children:u.jsx("p",{className:"text-sm font-semibold text-gray-200",children:"Supplier Management"})}),u.jsx("div",{className:"flex gap-2 mb-4",children:["existing","new"].map(oe=>u.jsx("button",{type:"button",onClick:()=>B(oe),className:`flex-1 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200 ${A===oe?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white shadow-lg shadow-cyan-500/30":"bg-gray-700/50 text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:oe==="existing"?"Choose Supplier":"Create Supplier"},oe))}),A==="existing"?u.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",value:ue,onChange:oe=>_n(oe.target.value),children:[u.jsx("option",{value:"",children:"Select Supplier"}),ie.map(oe=>u.jsx("option",{value:oe.id,children:oe.name},oe.id))]}):u.jsxs("form",{onSubmit:Zt,className:"space-y-3",children:[u.jsx("input",{name:"name",value:Z.name,onChange:dn,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",placeholder:"Supplier name"}),u.jsx("input",{type:"email",name:"email",value:Z.email,onChange:dn,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",placeholder:"Contact email (optional)"}),u.jsx("button",{type:"submit",disabled:ae,className:"w-full px-4 py-2.5 rounded-lg bg-gradient-to-r from-cyan-600 to-cyan-500 text-white text-sm font-semibold disabled:opacity-60 hover:from-cyan-500 hover:to-cyan-400 transition-all shadow-lg shadow-cyan-500/20",children:ae?"Creating...":"Create & Use Supplier"})]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-700/50",children:Object.keys(gu).map(oe=>u.jsxs("div",{children:[u.jsx("label",{htmlFor:`batch-${oe}`,className:"block text-sm font-medium text-gray-300 mb-2 capitalize",children:oe.replace(/([A-Z])/g," $1")}),u.jsx("input",{type:oe.includes("Date")?"date":"text",name:oe,id:`batch-${oe}`,value:s[oe],onChange:ct,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all shadow-sm"})]},oe))})]}),u.jsxs("div",{className:"space-y-6 p-6 bg-gray-900/40 border border-gray-700/50 rounded-xl backdrop-blur-sm shadow-inner",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-cyan-500/20 flex items-center justify-center",children:u.jsx("span",{className:"text-cyan-400 font-bold text-sm",children:"2"})}),u.jsx("h3",{className:"font-bold text-xl text-gray-100",children:"Add Items to Batch"})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"flex justify-center px-6 pt-6 pb-6 border-2 border-gray-600/50 border-dashed rounded-xl cursor-pointer hover:border-cyan-400/50 hover:bg-cyan-500/5 transition-all duration-200 group",onClick:()=>{var oe;return(oe=k.current)==null?void 0:oe.click()},children:u.jsxs("div",{className:"space-y-2 text-center",children:[w?u.jsx("img",{src:w,alt:"Preview",className:"mx-auto h-32 w-auto rounded-lg object-cover shadow-lg"}):u.jsx("div",{className:"mx-auto p-4 bg-gray-800/50 rounded-full group-hover:bg-cyan-500/10 transition-all",children:u.jsx(cx,{className:"h-10 w-10 text-gray-400 group-hover:text-cyan-400 transition-colors"})}),u.jsx("p",{className:"text-sm text-gray-400 group-hover:text-cyan-300 transition-colors",children:m?"Analyzing...":"Click to upload image"})]})}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:ke,ref:k,accept:"image/*"}),u.jsxs("button",{type:"button",onClick:()=>P(!0),className:"w-full flex items-center justify-center gap-2 py-3 px-4 border border-gray-600/50 rounded-lg text-sm font-semibold text-gray-200 bg-gray-700/30 hover:bg-gray-700/50 hover:border-cyan-500/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all shadow-sm",children:[u.jsx(Oi,{className:"w-5 h-5"}),"Live Scan Item"]})]}),m&&u.jsxs("div",{className:"flex items-center justify-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-7 w-7 border-2 border-cyan-400 border-t-transparent"}),u.jsx("p",{className:"ml-3 text-cyan-400 font-medium",children:"Extracting data..."})]}),b&&u.jsx("div",{className:"p-3 bg-red-900/30 border border-red-700/50 rounded-lg",children:u.jsx("p",{className:"text-red-400 text-sm",children:b})}),u.jsxs("form",{onSubmit:Vt,className:"space-y-5 pt-2",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Name"}),u.jsx("input",{name:"productName",value:c.productName,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white disabled:bg-gray-800/50 disabled:text-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",disabled:!!Y})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Manufacturer"}),u.jsx("input",{name:"manufacturer",value:c.manufacturer,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white disabled:bg-gray-800/50 disabled:text-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",disabled:!!Y})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),u.jsx("input",{name:"category",value:c.category,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white disabled:bg-gray-800/50 disabled:text-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",disabled:!!Y})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expiration Date"}),u.jsx("input",{type:"date",name:"expirationDate",value:c.expirationDate,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Description"}),u.jsx("textarea",{name:"productDescription",value:c.productDescription,onChange:nt,rows:3,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white disabled:bg-gray-800/50 disabled:text-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all resize-none",disabled:!!Y})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quantity"}),u.jsx("input",{type:"number",name:"quantity",value:c.quantity,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quantity Type"}),u.jsx("input",{name:"quantityType",value:c.quantityType,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),u.jsx("input",{name:"location",value:c.location,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cost Per Unit"}),u.jsx("input",{type:"number",name:"costPerUnit",value:c.costPerUnit,onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",step:"0.01"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Buy Price"}),u.jsx("input",{type:"number",name:"buyPrice",value:c.buyPrice??"",onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",step:"0.01"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sell Price"}),u.jsx("input",{type:"number",name:"sellPrice",value:c.sellPrice??"",onChange:nt,className:"w-full px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-cyan-500/50 focus:border-cyan-500 transition-all",step:"0.01"})]})]}),Qn&&u.jsxs("div",{className:"p-4 bg-cyan-900/10 border border-cyan-800/40 rounded-lg space-y-2",children:[u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{id:"dan-sharing",type:"checkbox",className:"mt-1 h-4 w-4 rounded border-gray-500 text-cyan-500 focus:ring-cyan-400 bg-gray-900",checked:(c.shareScope||[]).includes("dan"),onChange:oe=>je("dan",oe.target.checked)}),u.jsxs("label",{htmlFor:"dan-sharing",className:"text-sm text-gray-200",children:[u.jsx("span",{className:"font-semibold text-cyan-200",children:"Share with DAN network (beta)"}),u.jsx("span",{className:"block text-gray-400",children:"Broadcast anonymized surplus signals (product, quantity, expiration bucket, aisle zone) so trusted partners can discover this offer."})]})]}),u.jsx("p",{className:"text-xs text-gray-500 pl-7",children:"Provenance proofs are signed with your shop key. Disable anytime to keep inventory local-only."})]}),u.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg text-sm font-semibold text-white bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed transition-all shadow-lg shadow-indigo-500/20",children:m?"Saving Scan...":"Add This Item"})]})]}),h.length>0&&u.jsxs("div",{className:"mt-6",children:[u.jsxs("h3",{className:"font-semibold text-lg text-gray-200 mb-2",children:["Items in this Batch (",h.length,")"]}),u.jsx("ul",{className:"space-y-2 max-h-40 overflow-y-auto p-2 bg-gray-900/50 rounded-md",children:h.map((oe,le)=>{var Ee;return u.jsxs("li",{className:"text-sm text-gray-300 p-2 bg-gray-700/50 rounded-md flex justify-between items-center gap-3",children:[u.jsxs("span",{children:[oe.quantity,"x ",oe.productName]}),u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsxs("span",{children:["Exp: ",oe.expirationDate]}),((Ee=oe.shareScope)==null?void 0:Ee.includes("dan"))&&u.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border border-cyan-600/40 bg-cyan-900/40 text-cyan-200",children:"DAN"})]})]},le)})})]}),u.jsx("button",{onClick:An,disabled:h.length===0,className:"mt-6 w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 disabled:bg-gray-600 disabled:cursor-not-allowed transition-all",children:"Finish and Save Batch"})]})]})},q_=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),u.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),u.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),u.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]}),k_=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),u.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),u.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),u.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),u.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),u.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),L_=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),u.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),u.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),u.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),u.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),j_=({summaries:n,items:e,batches:i,onAddBatch:s,onDataRefresh:r})=>{const[c,f]=T.useState(null),[h,y]=T.useState("grid"),[m,v]=T.useState("overview"),[b,S]=T.useState(!1),[w,C]=T.useState(null),[I,P]=T.useState(!1);T.useRef(null);const{showToast:k}=Zn(),[V,q]=T.useState(null),[D,R]=T.useState({}),[z,F]=T.useState(null),[ie,K]=T.useState(null),[Y,fe]=T.useState(!1),ue=T.useMemo(()=>n.map(te=>({productId:te.productId,productName:te.productName})),[n]),Ne=T.useMemo(()=>{const te=new Date,Q=new Date(te.getTime()+10080*60*1e3);return n.filter(W=>{const ce=new Date(W.earliestExpiration);return ce<=Q&&ce>=te})},[n]),we=T.useMemo(()=>{const te=new Date;return n.filter(Q=>new Date(Q.earliestExpiration)<te)},[n]);T.useCallback(()=>{r(),k("New product successfully learned and added to catalog!","success")},[r,k]);const[Re,A]=T.useState(null),B=T.useCallback(te=>{S(!1),A(te),v("manual"),k('Scan complete! Review the extracted data in the form below and click "Add Item to Batch" when ready.',"success")},[k]),Z=T.useCallback(()=>{v("overview"),r(),k("Inventory batch added successfully!","success")},[r,k]),[re,ae]=T.useState(!1),_=T.useCallback(async te=>{ae(!1),P(!0),C(null);try{const Q=ad();if(!Q){k("No active shop context. Please ensure you are logged in.","error"),P(!1);return}const W=await fd(te,Q);C(W),W.length>0?k(`Found ${W.length} matching items in inventory!`,"success"):k("This item is not in the inventory.","info")}catch(Q){k("Visual search failed: "+(Q instanceof Error?Q.message:"Unknown error"),"error")}finally{P(!1)}},[k]),L=T.useCallback(te=>{if(!te.inventoryUuid){k("This entry was imported without a Qdrant reference and cannot be edited.","error");return}K(null),R({quantity:te.quantity,expirationDate:te.expirationDate,location:te.location||"",costPerUnit:te.costPerUnit,sellPrice:te.sellPrice??void 0}),q(te)},[k]),$=T.useCallback(te=>{if(!te.inventoryUuid){k("This entry was imported without a Qdrant reference and cannot be deleted.","error");return}K(null),F(te)},[k]),se=T.useCallback((te,Q)=>{if(te==="quantity"||te==="costPerUnit"||te==="sellPrice"){R(W=>({...W,[te]:Q===""?void 0:Number(Q)}));return}R(W=>({...W,[te]:Q}))},[]),me=T.useCallback(async te=>{if(te.preventDefault(),!!(V!=null&&V.inventoryUuid)){fe(!0),K(null);try{await qy(V.inventoryUuid,D),await Promise.resolve(r()),k("Inventory item updated.","success"),q(null)}catch(Q){K(Q instanceof Error?Q.message:"Failed to update inventory item.")}finally{fe(!1)}}},[V,D,r,k]),ye=T.useCallback(async()=>{if(z!=null&&z.inventoryUuid){fe(!0),K(null);try{await ky(z.inventoryUuid),await Promise.resolve(r()),k("Inventory item deleted.","success"),F(null)}catch(te){K(te instanceof Error?te.message:"Failed to delete inventory item.")}finally{fe(!1)}}},[z,r,k]);return u.jsxs(u.Fragment,{children:[c&&u.jsx(U_,{product:c,allItems:e,allBatches:i,onClose:()=>f(null)}),b&&u.jsx(Zs,{onDataScanned:B,onClose:()=>S(!1),productOptions:ue}),re&&u.jsx(Zs,{onDataScanned:te=>{const Q=te.blobs.get("productName")||te.blobs.get("manufacturer")||Array.from(te.blobs.values())[0];Q?_(Q):(k("No image captured. Please try again.","error"),ae(!1))},onClose:()=>ae(!1),productOptions:ue,mode:"visual-search"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Inventory Management"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>v("overview"),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${m==="overview"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Overview"}),u.jsx("button",{onClick:()=>v("scan"),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${m==="scan"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Scan Item"}),u.jsx("button",{onClick:()=>v("manual"),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${m==="manual"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Manual Entry"})]})]}),(Ne.length>0||we.length>0)&&u.jsxs("div",{className:"mt-4 p-4 rounded-lg border-l-4 bg-yellow-900/20 border-yellow-500",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Pu,{className:"w-5 h-5 text-yellow-400"}),u.jsxs("h3",{className:"font-semibold text-yellow-300",children:[we.length>0&&`${we.length} Expired`,we.length>0&&Ne.length>0&&"  ",Ne.length>0&&`${Ne.length} Expiring Soon`]})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[we.slice(0,5).map(te=>u.jsxs("span",{className:"px-2 py-1 bg-red-900/50 text-red-300 rounded text-xs",children:[te.productName," (Expired)"]},te.productId)),Ne.slice(0,5).map(te=>u.jsxs("span",{className:"px-2 py-1 bg-yellow-900/50 text-yellow-300 rounded text-xs",children:[te.productName," (Expires: ",new Date(te.earliestExpiration).toLocaleDateString(),")"]},te.productId))]})]})]}),m==="overview"&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[u.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 shadow-lg",children:[u.jsx("h2",{className:"text-xl font-semibold mb-4 text-white",children:"Quick Actions"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("button",{onClick:()=>S(!0),className:"w-full flex items-center justify-center gap-3 py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all",children:[u.jsx(Oi,{className:"w-6 h-6"}),"Live Scan Item"]}),u.jsx("p",{className:"text-xs text-gray-400 text-center px-2",children:"Use your camera to automatically extract product data"}),u.jsxs("button",{onClick:()=>ae(!0),disabled:I,className:"w-full flex items-center justify-center gap-3 py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(Oi,{className:"w-6 h-6"}),I?"Searching...":"Visual Search (Live)"]}),u.jsx("p",{className:"text-xs text-gray-400 text-center px-2",children:"Use camera to search if item is in inventory"}),u.jsxs("button",{onClick:()=>v("manual"),className:"w-full flex items-center justify-center gap-3 py-3 px-4 border border-gray-600 rounded-md shadow-sm text-base font-medium text-gray-200 bg-gray-700/50 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all",children:[u.jsx(L_,{className:"w-6 h-6"}),"Manual Entry"]}),u.jsx("p",{className:"text-xs text-gray-400 text-center px-2",children:"Enter inventory details manually or complete a scan"})]}),w&&w.length>0&&u.jsxs("div",{className:"mt-4 p-4 bg-purple-900/20 border border-purple-700 rounded-lg",children:[u.jsxs("h3",{className:"text-sm font-semibold text-purple-300 mb-2",children:["Visual Search Results (",w.length," found)"]}),u.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:w.map((te,Q)=>u.jsxs("div",{className:"text-xs p-2 bg-gray-900/50 rounded",children:[u.jsxs("p",{className:"text-white font-medium",children:["Product ID: ",te.productId]}),u.jsxs("p",{className:"text-gray-400",children:["Qty: ",te.quantity," | Exp: ",te.expirationDate]})]},Q))}),u.jsx("button",{onClick:()=>C(null),className:"mt-2 text-xs text-purple-400 hover:text-purple-300",children:"Clear results"})]})]}),u.jsx(R_,{items:e,batches:i})]}),u.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:"Current Inventory"}),u.jsxs("div",{className:"flex items-center p-1 bg-gray-900/50 rounded-lg border border-gray-700",children:[u.jsx("button",{onClick:()=>y("grid"),className:`p-2 rounded-md transition-colors ${h==="grid"?"bg-cyan-600 text-white":"text-gray-400 hover:text-white"}`,"aria-label":"Grid view",title:"Grid View",children:u.jsx(q_,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>y("table"),className:`p-2 rounded-md transition-colors ${h==="table"?"bg-cyan-600 text-white":"text-gray-400 hover:text-white"}`,"aria-label":"Table view",title:"Table View",children:u.jsx(k_,{className:"w-5 h-5"})})]})]}),h==="grid"?u.jsx(D_,{summaries:n,inventoryItems:e,onSelectProduct:f,onEditItem:L,onDeleteItem:$}):u.jsx(M_,{inventory:e,batches:i,onEditRequest:L,onDeleteRequest:$})]})]}),m==="scan"&&u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:u.jsxs("div",{className:"text-center space-y-4",children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:"Live Scan Item"}),u.jsx("p",{className:"text-gray-400",children:"Use your camera to automatically extract product information. You can also draw rectangles on the screen to focus on specific areas."}),u.jsxs("button",{onClick:()=>S(!0),className:"mx-auto flex items-center justify-center gap-3 py-4 px-8 border border-transparent rounded-md shadow-sm text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all",children:[u.jsx(Oi,{className:"w-8 h-8"}),"Start Live Scan"]}),u.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"After scanning, you'll be able to review and complete the form with the extracted data."})]})}),m==="manual"&&u.jsx(P_,{onAddBatch:(te,Q)=>{s(te,Q),Z(),A(null)},summaries:n,pendingScanResult:Re,onScanResultProcessed:()=>A(null)}),V&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 w-full max-w-lg",children:[u.jsxs("div",{className:"flex justify-between items-center border-b border-gray-700 p-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Edit Inventory Item"}),u.jsx("p",{className:"text-sm text-gray-400",children:V.productName})]}),u.jsx("button",{onClick:()=>{q(null),K(null)},className:"text-gray-400 hover:text-white text-2xl leading-5","aria-label":"Close edit item modal",children:""})]}),u.jsxs("form",{onSubmit:me,className:"p-4 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"text-sm text-gray-300",children:["Quantity",u.jsx("input",{type:"number",min:0,className:"mt-1 w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-white",value:D.quantity??"",onChange:te=>se("quantity",te.target.value)})]}),u.jsxs("label",{className:"text-sm text-gray-300",children:["Expiration Date",u.jsx("input",{type:"date",className:"mt-1 w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-white",value:D.expirationDate??"",onChange:te=>se("expirationDate",te.target.value)})]}),u.jsxs("label",{className:"text-sm text-gray-300",children:["Cost / Unit",u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-white",value:D.costPerUnit??"",onChange:te=>se("costPerUnit",te.target.value)})]}),u.jsxs("label",{className:"text-sm text-gray-300",children:["Sell Price",u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-white",value:D.sellPrice??"",onChange:te=>se("sellPrice",te.target.value)})]})]}),u.jsxs("label",{className:"text-sm text-gray-300 block",children:["Location",u.jsx("input",{type:"text",className:"mt-1 w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-white",value:D.location??"",onChange:te=>se("location",te.target.value)})]}),ie&&u.jsx("p",{className:"text-sm text-red-400",children:ie}),u.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[u.jsx("button",{type:"button",onClick:()=>{q(null),K(null)},className:"px-4 py-2 rounded-md bg-gray-700 text-white hover:bg-gray-600",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:Y,className:"px-4 py-2 rounded-md bg-cyan-600 text-white hover:bg-cyan-500 disabled:opacity-60",children:Y?"Saving...":"Save Changes"})]})]})]})}),z&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 w-full max-w-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete Inventory Item"}),u.jsxs("p",{className:"text-sm text-gray-300",children:["Are you sure you want to remove ",u.jsx("span",{className:"text-white font-semibold",children:z.productName})," from inventory? This action cannot be undone."]}),ie&&u.jsx("p",{className:"text-sm text-red-400 mt-3",children:ie}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx("button",{onClick:()=>{F(null),K(null)},className:"px-4 py-2 rounded-md bg-gray-700 text-white hover:bg-gray-600",children:"Cancel"}),u.jsx("button",{onClick:ye,disabled:Y,className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-500 disabled:opacity-60",children:Y?"Deleting...":"Delete"})]})]})})]})]})},qu=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"9",cy:"21",r:"1"}),u.jsx("circle",{cx:"20",cy:"21",r:"1"}),u.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),ux=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),dx=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})}),Rr=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("polyline",{points:"3 6 5 6 21 6"}),u.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),u.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),u.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),fx=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),u.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),u.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),u.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),u.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),V_=({summaries:n,onProductScanned:e,onClose:i})=>{const s=T.useRef(null),r=T.useRef(null),c=T.useRef(null),[f,h]=T.useState("SCANNING"),[y,m]=T.useState(null),[v,b]=T.useState(null),S=T.useMemo(()=>n.map(V=>V.productName),[n]),w=T.useCallback(()=>{c.current&&(clearInterval(c.current),c.current=null)},[]),C=T.useCallback(async()=>{if(!s.current||!r.current||document.hidden)return;const V=s.current,q=r.current;q.width=V.videoWidth,q.height=V.videoHeight;const D=q.getContext("2d");D&&(D.drawImage(V,0,0,V.videoWidth,V.videoHeight),q.toBlob(async R=>{if(R&&c.current)try{const z=await dd(R,S);z?(m(z),h("DETECTED"),e(z),w(),setTimeout(()=>{h("SCANNING"),m(null),c.current=window.setInterval(C,2e3)},2500)):h("NO_PRODUCT")}catch(z){console.warn("Scan failed:",z),h("ERROR")}},"image/jpeg",.8))},[S,e,w]);T.useEffect(()=>{let V=null;return(async()=>{try{V=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}}),s.current&&(s.current.srcObject=V),w(),c.current=window.setInterval(C,2e3)}catch(D){console.error("Error accessing camera:",D),b("Could not access the camera. Please ensure permissions are granted."),h("ERROR")}})(),()=>{w(),V&&V.getTracks().forEach(D=>D.stop())}},[C,w]);const I=()=>{switch(f){case"SCANNING":return{message:"Point camera at a product",color:"border-gray-500"};case"DETECTED":return{message:`${y} added to cart!`,color:"border-green-500 animate-pulse-border"};case"NO_PRODUCT":return{message:"Searching for product...",color:"border-yellow-500"};case"ERROR":return{message:"Scanner error. Please try again.",color:"border-red-500"};default:return{message:"",color:"border-transparent"}}},{message:P,color:k}=I();return u.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex flex-col items-center justify-center","aria-modal":"true",children:[u.jsx("style",{children:`
            @keyframes pulse-border {
                0%, 100% { box-shadow: 0 0 0 0 rgba(4, 120, 87, 0.7); }
                50% { box-shadow: 0 0 0 10px rgba(4, 120, 87, 0); }
            }
            .animate-pulse-border {
                animation: pulse-border 1.5s infinite;
            }
        `}),u.jsxs("div",{className:`relative w-full max-w-4xl aspect-video bg-black rounded-lg overflow-hidden border-4 ${k} transition-all`,children:[u.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),u.jsx("canvas",{ref:r,className:"hidden"})]}),u.jsxs("div",{className:"mt-4 text-center",children:[u.jsx("p",{className:"text-white text-lg font-semibold",children:P}),v&&u.jsx("p",{className:"text-red-400 text-sm mt-1",children:v})]}),u.jsx("button",{onClick:i,className:"absolute top-4 right-4 text-white bg-black/50 rounded-full p-2 hover:bg-black/80 transition-colors z-30","aria-label":"Close scanner",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),u.jsx("button",{onClick:i,className:"mt-8 px-8 py-3 bg-cyan-600 text-white font-bold rounded-lg hover:bg-cyan-700 transition-colors shadow-lg",children:"Done Scanning"})]})},rg=1.4,B_=({summaries:n,onPurchase:e})=>{const[i,s]=T.useState([]),[r,c]=T.useState(!1),[f,h]=T.useState("All"),[y,m]=T.useState(!1),v=T.useMemo(()=>n.map(D=>({...D,price:D.averageCostPerUnit*rg})).filter(D=>f==="All"?!0:D.category===f),[n,f]),b=T.useMemo(()=>{const D=new Set(n.map(R=>R.category));return["All",...Array.from(D)]},[n]),S=D=>{s(R=>{const z=R.find(F=>F.productName===D.productName);if(z){const F=k(D.productName);return z.quantity>=F?R:R.map(ie=>ie.productName===D.productName?{...ie,quantity:ie.quantity+1}:ie)}return[...R,{productName:D.productName,quantity:1,price:D.price}]})},w=(D,R)=>{s(z=>z.map(ie=>ie.productName===D?{...ie,quantity:ie.quantity+R}:ie).filter(ie=>ie.quantity>0))},C=D=>{s(R=>R.filter(z=>z.productName!==D))},I=T.useMemo(()=>i.reduce((D,R)=>D+R.price*R.quantity,0),[i]),P=()=>{e(i.map(({productName:D,quantity:R})=>({productName:D,quantity:R}))),s([]),c(!0),setTimeout(()=>c(!1),4e3)},k=D=>{var R;return((R=n.find(z=>z.productName===D))==null?void 0:R.totalQuantity)||0},V=D=>{var R;return((R=i.find(z=>z.productName===D))==null?void 0:R.quantity)||0},q=D=>{const R=n.find(z=>z.productName===D);if(R){const z={...R,price:R.averageCostPerUnit*rg};S(z)}};return u.jsxs(u.Fragment,{children:[y&&u.jsx(V_,{summaries:n,onProductScanned:q,onClose:()=>m(!1)}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"lg:col-span-2",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-3xl font-bold text-white",children:"Welcome to the Kiosk"}),u.jsxs("button",{onClick:()=>m(!0),className:"flex items-center justify-center gap-2 py-2 px-4 border border-cyan-600 rounded-md shadow-sm text-sm font-medium text-cyan-400 bg-cyan-900/30 hover:bg-cyan-900/60 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all",children:[u.jsx(fx,{className:"w-5 h-5"}),"Scan Item to Add"]})]}),u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(D=>u.jsx("button",{onClick:()=>h(D),className:`px-4 py-2 text-sm font-medium rounded-full transition-colors ${f===D?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:D},D))})}),v.length===0?u.jsx("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 text-center text-gray-400",children:u.jsx("p",{children:"There are no products available in this category. Please check back later."})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:v.map(D=>{const R=V(D.productName),z=D.totalQuantity,F=R<z;return u.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden flex flex-col",children:[u.jsxs("div",{className:"p-4 flex-grow",children:[u.jsx("div",{className:"flex justify-center items-center h-24 w-24 bg-gray-700/50 rounded-lg mx-auto mb-4",children:u.jsx(Xy,{className:"w-12 h-12 text-gray-500"})}),u.jsx("h3",{className:"font-semibold text-white truncate",children:D.productName}),u.jsx("p",{className:"text-sm text-gray-400 mb-2 truncate",children:D.manufacturer}),u.jsxs("p",{className:"text-xl font-bold text-cyan-400",children:["$",D.price.toFixed(2)]})]}),u.jsx("div",{className:"p-4 bg-gray-900/50",children:u.jsxs("button",{onClick:()=>S(D),disabled:!F,className:"w-full flex items-center justify-center gap-2 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all disabled:bg-gray-600 disabled:cursor-not-allowed",children:[u.jsx(qu,{className:"w-5 h-5"}),F?"Add to Cart":"Out of Stock"]})})]},D.productName)})})]}),u.jsx("div",{className:"lg:col-span-1",children:u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700 sticky top-28",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[u.jsx(qu,{className:"w-6 h-6 text-cyan-400"}),"Your Cart"]}),r&&u.jsxs("div",{className:"bg-green-800/50 border border-green-600 text-green-300 p-4 rounded-lg mb-4 text-center",children:[u.jsx("h3",{className:"font-bold",children:"Purchase Successful!"}),u.jsx("p",{className:"text-sm",children:"Thank you for your order."})]}),i.length>0?u.jsxs("div",{className:"space-y-4",children:[u.jsx("ul",{className:"space-y-3 max-h-80 overflow-y-auto pr-2 -mr-2",children:i.map(D=>u.jsxs("li",{className:"flex items-center gap-4 text-sm",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-medium text-white truncate",children:D.productName}),u.jsxs("p",{className:"text-gray-400",children:["$",D.price.toFixed(2)]})]}),u.jsxs("div",{className:"flex items-center gap-1 bg-gray-700/50 rounded-md",children:[u.jsx("button",{onClick:()=>w(D.productName,-1),className:"p-1 text-gray-300 hover:text-white",children:u.jsx(dx,{className:"w-4 h-4"})}),u.jsx("span",{className:"font-bold text-white px-1",children:D.quantity}),u.jsx("button",{onClick:()=>w(D.productName,1),disabled:D.quantity>=k(D.productName),className:"p-1 text-gray-300 hover:text-white disabled:text-gray-600",children:u.jsx(ux,{className:"w-4 h-4"})})]}),u.jsx("button",{onClick:()=>C(D.productName),className:"p-1 text-gray-400 hover:text-red-400",children:u.jsx(Rr,{className:"w-4 h-4"})})]},D.productName))}),u.jsxs("div",{className:"border-t border-gray-700 pt-4 space-y-4",children:[u.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[u.jsx("span",{className:"text-gray-300",children:"Total:"}),u.jsxs("span",{className:"text-white",children:["$",I.toFixed(2)]})]}),u.jsx("button",{onClick:P,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all",children:"Checkout"})]})]}):u.jsx("p",{className:"text-center text-gray-500 py-8",children:"Your cart is empty."})]})})]})]})},G_=({summaries:n,onClose:e,onListProduct:i})=>{const[s,r]=T.useState(""),[c,f]=T.useState(1),[h,y]=T.useState(0),[m,v]=T.useState(""),b=n.find(C=>C.productName===s),S=(b==null?void 0:b.totalQuantity)||0,w=C=>{if(C.preventDefault(),v(""),!s||c<=0||h<=0){v("Please fill all fields with valid values.");return}if(c>S){v(`Quantity cannot exceed available stock of ${S}.`);return}i(s,c,h)};return u.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 flex items-center justify-center p-4",onClick:e,children:u.jsxs("div",{className:"bg-gray-800 border border-gray-700 rounded-lg shadow-2xl w-full max-w-lg",onClick:C=>C.stopPropagation(),children:[u.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:"List Product on Marketplace"}),u.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"product",className:"block text-sm font-medium text-gray-300",children:"Product"}),u.jsxs("select",{id:"product",value:s,onChange:C=>r(C.target.value),className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm",children:[u.jsx("option",{value:"",children:"Select a product..."}),n.map(C=>u.jsxs("option",{value:C.productName,children:[C.productName," (In Stock: ",C.totalQuantity,")"]},C.productName))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-300",children:"Quantity to List"}),u.jsx("input",{type:"number",id:"quantity",value:c,onChange:C=>f(Math.max(1,parseInt(C.target.value)||1)),min:"1",max:S,className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-300",children:"Price per Unit ($)"}),u.jsx("input",{type:"number",id:"price",value:h,onChange:C=>y(parseFloat(C.target.value)||0),min:"0.01",step:"0.01",className:"mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-cyan-500 focus:border-cyan-500 sm:text-sm"})]}),m&&u.jsx("p",{className:"text-red-400 text-sm",children:m}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[u.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 border border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-300 bg-gray-700/50 hover:bg-gray-700",children:"Cancel"}),u.jsx("button",{type:"submit",className:"py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700",children:"List Product"})]})]})]})})},H_=({summaries:n,user:e,onPurchase:i})=>{const[s,r]=T.useState([]),[c,f]=T.useState([]),[h,y]=T.useState(!0),[m,v]=T.useState(null),[b,S]=T.useState(!1),[w,C]=T.useState("peer"),[I,P]=T.useState([]),[k,V]=T.useState(!1),[q,D]=T.useState(null),R=T.useCallback(async()=>{if(!e.isVerified){y(!1);return}y(!0),v(null);try{const[Y,fe]=await Promise.all([Q2(e),cy()]);r(Y),f(fe)}catch(Y){v(Y instanceof Error?Y.message:"Failed to load marketplace data.")}finally{y(!1)}},[e]),z=T.useCallback(async()=>{if(Qn){V(!0),D(null);try{const Y=await Uy();P(Y)}catch(Y){D(Y instanceof Error?Y.message:"Failed to load DAN offers.")}finally{V(!1)}}},[]);T.useEffect(()=>{R()},[R]),T.useEffect(()=>{Qn&&w==="dan"&&z()},[w,z]);const F=async(Y,fe,ue)=>{if(!n.find(Re=>Re.productName===Y))return;const we=Y.toLowerCase().replace(/ /g,"-");await ly({productId:we,productName:Y,quantity:fe,price:ue}),S(!1),R()},ie=Y=>{alert(`Signal sent! Coordinate with ${Y.shopName||Y.shopId} to fulfill ${Y.productName}.`)},K=Y=>{const fe=prompt(`How many units of ${Y.productName} would you like to buy? (Available: ${Y.quantity})`,"1");if(fe){const ue=parseInt(fe,10);!isNaN(ue)&&ue>0&&ue<=Y.quantity?(i(Y,ue),alert(`Successfully purchased ${ue} ${Y.productName}! It has been added to your inventory.`)):alert("Invalid quantity entered.")}};return e.isVerified?u.jsxs(u.Fragment,{children:[b&&u.jsx(G_,{summaries:n,onClose:()=>S(!1),onListProduct:F}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-white",children:"Marketplace"}),u.jsx("p",{className:"text-lg text-gray-400",children:"Buy and sell inventory with other verified shops in the network."})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[u.jsx("div",{className:"lg:col-span-4",children:u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"My Listings"}),u.jsx("button",{onClick:()=>S(!0),className:"w-full text-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all",children:"List a Product"}),u.jsx("div",{className:"mt-4 space-y-3 max-h-96 overflow-y-auto",children:c.length>0?c.map(Y=>u.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-md text-sm",children:[u.jsx("p",{className:"font-semibold text-white",children:Y.productName}),u.jsxs("p",{className:"text-gray-400",children:[Y.quantity," units at $",Y.price.toFixed(2),"/each"]})]},Y.id)):u.jsx("p",{className:"text-center text-gray-500 py-4",children:"You haven't listed any products."})})]})}),u.jsx("div",{className:"lg:col-span-8",children:u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:w==="dan"?"DAN Offers":"Peer Offerings"}),Qn&&u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>C("peer"),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${w==="peer"?"bg-cyan-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Peer Network"}),u.jsx("button",{onClick:()=>C("dan"),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${w==="dan"?"bg-indigo-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"DAN Offers Only"})]})]}),w==="peer"&&u.jsxs(u.Fragment,{children:[h&&u.jsx("p",{className:"text-cyan-400 mt-4",children:"Loading peer listings..."}),m&&u.jsx("p",{className:"text-red-400 mt-4",children:m}),!h&&!m&&u.jsx("div",{className:"space-y-6 mt-4",children:s.map(Y=>u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-bold text-cyan-400",children:Y.name}),u.jsx("div",{className:"mt-2 divide-y divide-gray-700 border-t border-b border-gray-700",children:Y.listings.map(fe=>u.jsxs("div",{className:"p-3 grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-white",children:fe.productName}),u.jsx("p",{className:"text-xs text-gray-400",children:fe.manufacturer})]}),u.jsx("div",{className:"text-sm",children:u.jsxs("p",{className:"text-gray-300",children:[fe.quantity," ",fe.quantityType]})}),u.jsx("div",{className:"text-sm font-bold",children:u.jsxs("p",{className:"text-white",children:["$",fe.price.toFixed(2)]})}),u.jsx("div",{children:u.jsx("button",{onClick:()=>K(fe),className:"w-full md:w-auto text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-cyan-500 transition-all",children:"Buy"})})]},fe.listingId))})]},Y.id))})]}),w==="dan"&&Qn&&u.jsxs("div",{className:"mt-4 space-y-4",children:[k&&u.jsx("p",{className:"text-indigo-300",children:"Syncing DAN offers..."}),q&&u.jsx("p",{className:"text-red-400",children:q}),!k&&!q&&u.jsx(u.Fragment,{children:I.filter(Y=>Y.shopId!==(e.shopId||e.clientId)).length===0?u.jsx("p",{className:"text-gray-400",children:"No external DAN offers yet. Encourage peers to opt-in sharing from Inventory > Manual Entry."}):u.jsx("div",{className:"grid grid-cols-1 gap-4",children:I.filter(Y=>Y.shopId!==(e.shopId||e.clientId)).map(Y=>{var fe;return u.jsxs("div",{className:"p-4 rounded-lg border border-gray-700 bg-gray-900/40",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-white",children:Y.productName}),u.jsxs("p",{className:"text-xs text-gray-400",children:["From ",Y.shopName||Y.shopId]})]}),u.jsx("span",{className:"text-xs px-2 py-1 rounded-full border border-indigo-400 text-indigo-300",children:"DAN"})]}),u.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-4 gap-3 text-sm text-gray-300",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 text-xs uppercase",children:"Quantity"}),u.jsxs("p",{children:[Y.quantity," units"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 text-xs uppercase",children:"Expires"}),u.jsx("p",{children:new Date(Y.expirationDate).toLocaleDateString()})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 text-xs uppercase",children:"Aisle Zone"}),u.jsx("p",{children:Y.locationBucket||"Hidden"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 text-xs uppercase",children:"Signal Hash"}),u.jsx("p",{className:"font-mono text-xs",children:((fe=Y.proofHash)==null?void 0:fe.slice(0,12))??""})]})]}),u.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[u.jsx("div",{className:"text-sm text-gray-400",children:Y.sellPrice?`Listed at $${Y.sellPrice.toFixed(2)} / unit`:"Price shared privately"}),u.jsx("button",{onClick:()=>ie(Y),className:"w-full md:w-auto text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all",children:"Signal Interest"})]})]},Y.inventoryUuid)})})})]})]})})]})]})]}):u.jsxs("div",{className:"text-center bg-gray-800/50 p-12 rounded-lg border border-gray-700",children:[u.jsx("h1",{className:"text-2xl font-bold text-yellow-400",children:"Verification Pending"}),u.jsx("p",{className:"text-lg text-gray-400 mt-2",children:"Your shop is awaiting verification by the network admin."}),u.jsx("p",{className:"text-gray-500 mt-4",children:"Once verified, you will be able to access the peer-to-peer marketplace here."}),u.jsx("p",{className:"text-gray-500 mt-1",children:'Navigate to the "Backend" tab to simulate the admin view and verify this shop.'})]})},z_=()=>{const[n,e]=T.useState([]),[i,s]=T.useState([]),[r,c]=T.useState([]),[f,h]=T.useState([]),[y,m]=T.useState(!0),[v,b]=T.useState(new Date),S=T.useCallback(async()=>{m(!0);const[I,P,k,V]=await Promise.all([G2(),H2(),z2(),O2()]);e(I),s(P),c(k),h(V),m(!1)},[]);T.useEffect(()=>{S()},[S,v]);const w=async I=>{await F2(I),b(new Date)},C=async I=>{await Y2(I),b(new Date)};return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-white",children:"Backend Admin Panel"}),u.jsx("p",{className:"text-lg text-gray-400",children:"Simulated proxy server for verifying new shops and drivers."})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Pending Shop Verifications (",n.length,")"]}),u.jsx("button",{onClick:()=>b(new Date),className:"text-sm text-cyan-400 hover:text-cyan-300",children:"Refresh"})]}),y?u.jsx("p",{className:"text-center text-gray-400",children:"Loading..."}):n.length===0?u.jsx("p",{className:"text-center text-gray-500 py-8",children:"No shops are awaiting verification."}):u.jsx(vr,{users:n,onVerify:w})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white mb-4",children:["Pending Driver Verifications (",r.length,")"]}),y?u.jsx("p",{className:"text-center text-gray-400",children:"Loading..."}):r.length===0?u.jsx("p",{className:"text-center text-gray-500 py-8",children:"No drivers are awaiting verification."}):u.jsx(vr,{users:r,onVerify:C,isDriverTable:!0})]}),u.jsxs("div",{className:"bg-gray-800/50 p-6 rounded-lg border border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Active Network Participants"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-cyan-400",children:["Verified Shops (",i.length,")"]}),i.length>0?u.jsx(vr,{users:i}):u.jsx("p",{className:"text-gray-500 text-sm",children:"No verified shops."}),u.jsxs("h3",{className:"text-lg font-semibold text-cyan-400 mt-6",children:["Verified Drivers (",f.length,")"]}),f.length>0?u.jsx(vr,{users:f,isDriverTable:!0}):u.jsx("p",{className:"text-gray-500 text-sm",children:"No verified drivers."})]})]}),u.jsxs("div",{className:"mt-6 p-4 bg-gray-900/50 rounded-lg border border-cyan-800/50",children:[u.jsx("h4",{className:"font-semibold text-cyan-500",children:"How this simulation works:"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'When a new user registers, they appear in the appropriate "Pending" list. Clicking "Verify" updates a shared `localStorage` value. The main application is continuously polling for this change. Once it detects it has been verified, it will automatically unlock the relevant features (Marketplace, Orders, or Driver panel).'})]})]})},vr=({users:n,onVerify:e,isDriverTable:i})=>u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[u.jsx("thead",{className:"bg-gray-800",children:u.jsxs("tr",{children:[u.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-300 sm:pl-6",children:i?"Name":"Company"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Email"}),u.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-300",children:"Client ID"}),e&&u.jsx("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:u.jsx("span",{className:"sr-only",children:"Verify"})})]})}),u.jsx("tbody",{className:"divide-y divide-gray-700 bg-gray-900/50",children:n.map(s=>u.jsxs("tr",{children:[u.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-white sm:pl-6",children:s.companyName}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-400",children:s.email}),u.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 font-mono text-xs",children:s.clientId}),e&&u.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:u.jsx("button",{onClick:()=>e(s.clientId),className:"py-1 px-3 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-green-600 hover:bg-green-700",children:"Verify"})})]},s.clientId))})]})}),px=T.createContext(void 0),O_=({children:n})=>{const[e,i]=T.useState(()=>{if(typeof window<"u"){const s=sessionStorage.getItem("current_shop");return s?JSON.parse(s):null}return null});return T.useEffect(()=>{typeof window<"u"&&(e?sessionStorage.setItem("current_shop",JSON.stringify(e)):sessionStorage.removeItem("current_shop"))},[e]),u.jsx(px.Provider,{value:{currentShop:e,setCurrentShop:i},children:n})},pd=()=>{const n=T.useContext(px);if(n===void 0)throw new Error("useShopContext must be used within a ShopContextProvider");return n},mx=T.createContext(void 0),F_=({children:n,initialCustomer:e})=>{const[i,s]=T.useState(()=>{if(e)return e;if(typeof window<"u"){const f=sessionStorage.getItem("customer_profile");return f?JSON.parse(f):null}return null});T.useEffect(()=>{e&&s(f=>(f==null?void 0:f.user.clientId)===e.user.clientId?f:e)},[e]),T.useEffect(()=>{typeof window<"u"&&(i?sessionStorage.setItem("customer_profile",JSON.stringify(i)):sessionStorage.removeItem("customer_profile"))},[i]);const r=f=>{s(f)},c=()=>{s(null)};return u.jsx(mx.Provider,{value:{customer:i,setCustomer:r,clearCustomer:c},children:n})},hx=()=>{const n=T.useContext(mx);if(n===void 0)throw new Error("useCustomerContext must be used within a CustomerContextProvider");return n},lg=({onShopSelected:n,showQRScanner:e=!1})=>{const{currentShop:i,setCurrentShop:s}=pd(),[r,c]=T.useState([]),[f,h]=T.useState(!0),[y,m]=T.useState(!1),[v,b]=T.useState(""),{showToast:S}=Zn();T.useEffect(()=>{w()},[]);const w=async()=>{try{h(!0);const P=await ny();c(P)}catch(P){console.error("Failed to load shops:",P),S("Failed to load shops","error")}finally{h(!1)}},C=P=>{s(P),S(`Selected shop: ${P.name}`,"success"),n&&n()},I=async()=>{if(!v.trim()){S("Please enter a shop ID","error");return}try{const P=await ay(v.trim());P?(C(P),b(""),m(!1)):S("Shop not found. Please check the QR code.","error")}catch(P){console.error("Error validating shop:",P),S("Failed to validate shop","error")}};return i?u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Current Shop"}),u.jsx("p",{className:"text-gray-300",children:i.name})]}),u.jsx("button",{onClick:()=>s(null),className:"px-4 py-2 text-sm text-cyan-400 hover:text-cyan-300 border border-cyan-600 rounded-lg hover:bg-cyan-900/30 transition",children:"Change Shop"})]})}):u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Select a Shop"}),e&&u.jsxs("div",{className:"mb-6",children:[u.jsxs("button",{onClick:()=>m(!y),className:"w-full flex items-center justify-center gap-3 py-3 px-6 border border-transparent rounded-lg shadow-lg text-base font-semibold text-white bg-cyan-600 hover:bg-cyan-700 transition-all mb-4",children:[u.jsx(fx,{className:"w-5 h-5"}),y?"Hide QR Scanner":"Scan Shop QR Code"]}),y&&u.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Enter shop ID from QR code:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:v,onChange:P=>b(P.target.value),onKeyPress:P=>P.key==="Enter"&&I(),placeholder:"Shop ID",className:"flex-1 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),u.jsx("button",{onClick:I,className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-semibold transition",children:"Go"})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Or Browse Shops"}),f?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-400 mx-auto"}),u.jsx("p",{className:"text-gray-400 mt-2",children:"Loading shops..."})]}):r.length===0?u.jsx("div",{className:"text-center py-8",children:u.jsx("p",{className:"text-gray-400",children:"No shops available"})}):u.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.map(P=>u.jsxs("button",{onClick:()=>C(P),className:"w-full text-left px-4 py-3 bg-gray-900/50 border border-gray-700 rounded-lg hover:bg-gray-900 hover:border-cyan-600 transition text-white",children:[u.jsx("div",{className:"font-semibold",children:P.name}),P.contactEmail&&u.jsx("div",{className:"text-sm text-gray-400",children:P.contactEmail})]},P.id))})]})]})},gx=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),u.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Y_=({cart:n,totalPrice:e,shopId:i,customerId:s,onComplete:r,onCancel:c})=>{const[f,h]=T.useState(!1),[y,m]=T.useState(!1),{showToast:v}=Zn(),b=async()=>{try{h(!0);const S=await zr(),w=new Map(S.map(I=>[I.productName,{id:I.productId,name:I.productName}])),C=n.map(I=>({productName:I.productName,quantity:I.quantity}));$s({id:i,name:null,contactEmail:null,location:null,qdrantNamespace:null});try{await id(C,w)}finally{$s(null)}m(!0),v("Purchase completed successfully!","success"),setTimeout(()=>{r()},2e3)}catch(S){console.error("Purchase error:",S),v("Purchase failed: "+(S instanceof Error?S.message:"Unknown error"),"error"),h(!1)}};return y?u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 text-center",children:[u.jsx(gx,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Purchase Complete!"}),u.jsx("p",{className:"text-gray-400",children:"Thank you for your purchase"})]}):u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Checkout"}),u.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-lg p-4 mb-4",children:[u.jsx("h3",{className:"font-semibold text-white mb-3",children:"Order Summary"}),u.jsx("div",{className:"space-y-2",children:n.map(S=>u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsxs("span",{className:"text-gray-300",children:[S.productName," x ",S.quantity]}),u.jsxs("span",{className:"text-white font-semibold",children:["$",(S.price*S.quantity).toFixed(2)]})]},S.productId))}),u.jsxs("div",{className:"border-t border-gray-700 mt-3 pt-3 flex justify-between",children:[u.jsx("span",{className:"text-lg font-semibold text-white",children:"Total"}),u.jsxs("span",{className:"text-xl font-bold text-cyan-400",children:["$",e.toFixed(2)]})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Payment Method"}),u.jsx("div",{className:"bg-gray-900/50 border border-gray-700 rounded-lg p-3",children:u.jsx("p",{className:"text-gray-300 text-sm",children:"Cash / Card at pickup"})})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:c,disabled:f,className:"flex-1 py-3 px-4 bg-gray-700 hover:bg-gray-600 text-white font-semibold rounded-lg transition disabled:opacity-50",children:"Cancel"}),u.jsx("button",{onClick:b,disabled:f,className:"flex-1 py-3 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-semibold rounded-lg transition disabled:opacity-50",children:f?"Processing...":"Complete Purchase"})]})]})},J_=({cart:n,onUpdateQuantity:e,onRemoveItem:i,totalPrice:s,shopId:r,onPurchaseComplete:c})=>{const{customer:f}=hx(),[h,y]=T.useState(!1);return h?u.jsx(Y_,{cart:n,totalPrice:s,shopId:r,customerId:(f==null?void 0:f.user.customerId)||(f==null?void 0:f.user.clientId),onComplete:c,onCancel:()=>y(!1)}):u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 sticky top-4",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(qu,{className:"w-6 h-6 text-cyan-400"}),u.jsx("h2",{className:"text-xl font-bold text-white",children:"Cart"}),n.length>0&&u.jsx("span",{className:"bg-cyan-600 text-white text-xs font-semibold px-2 py-1 rounded-full",children:n.length})]}),n.length===0?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("p",{className:"text-gray-400",children:"Your cart is empty"}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Add items to get started"})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto mb-4",children:n.map(m=>u.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-lg p-3",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"font-semibold text-white text-sm",children:m.productName}),u.jsxs("p",{className:"text-xs text-gray-400",children:["$",m.price.toFixed(2)," each"]})]}),u.jsx("button",{onClick:()=>i(m.productId),className:"text-gray-400 hover:text-red-400 transition","aria-label":"Remove item",children:u.jsx(Rr,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>e(m.productId,-1),className:"p-1 bg-gray-700 hover:bg-gray-600 rounded text-white transition","aria-label":"Decrease quantity",children:u.jsx(dx,{className:"w-4 h-4"})}),u.jsx("span",{className:"text-white font-semibold w-8 text-center",children:m.quantity}),u.jsx("button",{onClick:()=>e(m.productId,1),className:"p-1 bg-gray-700 hover:bg-gray-600 rounded text-white transition","aria-label":"Increase quantity",children:u.jsx(ux,{className:"w-4 h-4"})})]}),u.jsxs("p",{className:"text-cyan-400 font-semibold",children:["$",(m.price*m.quantity).toFixed(2)]})]})]},m.productId))}),u.jsxs("div",{className:"border-t border-gray-700 pt-4 space-y-3",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-lg font-semibold text-white",children:"Total"}),u.jsxs("span",{className:"text-2xl font-bold text-cyan-400",children:["$",s.toFixed(2)]})]}),u.jsx("button",{onClick:()=>{if(!f){alert("Please log in to checkout");return}y(!0)},className:"w-full py-3 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-semibold rounded-lg transition",children:f?"Checkout":"Login to Checkout"})]})]})]})},Q_=()=>{const{currentShop:n,setCurrentShop:e}=pd(),[i,s]=T.useState([]),[r,c]=T.useState([]),[f,h]=T.useState([]),[y,m]=T.useState(!0),{showToast:v}=Zn();T.useEffect(()=>{n&&b()},[n]);const b=async()=>{if(n)try{m(!0);const V=(await oy(n.id)).filter(D=>D.quantity>0&&(!D.status||D.status==="ACTIVE"));s(V);const q=await zr();c(q)}catch(k){console.error("Failed to load inventory:",k),v("Failed to load inventory","error")}finally{m(!1)}},S=k=>{const V=r.find(q=>q.productId===k);return(V==null?void 0:V.productName)||"Unknown Product"},w=k=>{const V=S(k.productId),q=f.find(D=>D.productId===k.productId);if(q)q.quantity<k.quantity?(h(f.map(D=>D.productId===k.productId?{...D,quantity:D.quantity+1}:D)),v(`Added ${V} to cart`,"success")):v(`Only ${k.quantity} available`,"warning");else{const D=k.sellPrice||k.costPerUnit*1.4;h([...f,{productId:k.productId,productName:V,quantity:1,price:D,stockItem:k}]),v(`Added ${V} to cart`,"success")}},C=(k,V)=>{h(f.map(q=>{if(q.productId===k){const D=q.quantity+V,R=q.stockItem.quantity;return D<=0?null:D>R?(v(`Only ${R} available`,"warning"),q):{...q,quantity:D}}return q}).filter(Boolean))},I=k=>{h(f.filter(V=>V.productId!==k))};if(!n)return u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 text-center",children:u.jsx("p",{className:"text-gray-400",children:"Please select a shop to start shopping"})});const P=f.reduce((k,V)=>k+V.price*V.quantity,0);return u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:n.name}),n.contactEmail&&u.jsx("p",{className:"text-gray-400 text-sm",children:n.contactEmail})]}),u.jsx("button",{onClick:()=>{e(null),h([])},className:"px-4 py-2 text-sm text-cyan-400 hover:text-cyan-300 border border-cyan-600 rounded-lg hover:bg-cyan-900/30 transition whitespace-nowrap",children:"Change Shop"})]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Available Products"}),y?u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400 mx-auto"}),u.jsx("p",{className:"text-gray-400 mt-4",children:"Loading inventory..."})]}):i.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-400",children:"No products available at this shop"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(k=>{const V=S(k.productId),q=k.sellPrice||k.costPerUnit*1.4,D=f.find(z=>z.productId===k.productId),R=D!==void 0;return u.jsxs("div",{className:"bg-gray-900/50 border border-gray-700 rounded-lg p-4 hover:border-cyan-600 transition",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"font-semibold text-white",children:V}),u.jsxs("p",{className:"text-sm text-gray-400",children:[k.quantity," ",k.quantityType||"units"," available"]})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"text-lg font-bold text-cyan-400",children:["$",q.toFixed(2)]}),k.expirationDate&&u.jsxs("p",{className:"text-xs text-gray-500",children:["Exp: ",new Date(k.expirationDate).toLocaleDateString()]})]})]}),u.jsx("button",{onClick:()=>w(k),disabled:k.quantity===0||R&&D.quantity>=k.quantity,className:`w-full py-2 px-4 rounded-lg font-semibold transition ${k.quantity===0||R&&D.quantity>=k.quantity?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-cyan-600 hover:bg-cyan-700 text-white"}`,children:R?`In Cart (${D.quantity})`:"Add to Cart"})]},k.id)})})]})}),u.jsx("div",{className:"lg:col-span-1",children:u.jsx(J_,{cart:f,onUpdateQuantity:C,onRemoveItem:I,totalPrice:P,shopId:n.id,onPurchaseComplete:()=>{h([]),b()}})})]})]})},$_=({name:n})=>{const[e,i]=T.useState([]),[s,r]=T.useState([]),[c,f]=T.useState(""),[h,y]=T.useState(!0),[m,v]=T.useState(!1),[b,S]=T.useState(null),[w,C]=T.useState(!1),[I,P]=T.useState(null),[k,V]=T.useState(""),q=T.useRef(!1);T.useEffect(()=>{let R=!1;const z=setTimeout(async()=>{const F=c.trim();v(!!F),!F&&!q.current&&y(!0);try{const ie=await Mu(F,30);if(R)return;F&&ie.length===0?(S("No such product found!"),i([])):(i(ie),S(null)),q.current=!0}catch(ie){R||S(ie instanceof Error?ie.message:"Failed to load products.")}finally{R||(y(!1),v(!1))}},250);return()=>{R=!0,clearTimeout(z)}},[c]),T.useEffect(()=>{(async()=>{try{const z=await Mu("",200);r(z)}catch(z){console.warn("Failed to preload scanner catalog",z)}})()},[]);const D=async R=>{C(!1),v(!0),S(null);try{const z=s.length>0?s:e,{identifyProductNameFromImage:F}=await Ky(async()=>{const{identifyProductNameFromImage:Y}=await Promise.resolve().then(()=>C_);return{identifyProductNameFromImage:Y}},void 0),ie=z.map(Y=>Y.name),K=await F(R,ie);if(K){const Y=z.find(fe=>fe.name===K);Y?(i([Y]),V(Y.name),f(Y.name),P(Y),S(null)):(S("Product found in image but not in catalog."),i([]))}else S("Could not identify product from image. Please try again."),i([])}catch(z){S("Visual search failed: "+(z instanceof Error?z.message:"Unknown error"))}finally{v(!1)}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("h1",{className:"text-3xl font-bold text-white mb-2",children:["Welcome, ",n,"!"]}),u.jsx("p",{className:"text-gray-300",children:"Search the live catalog to see if a product is available in nearby autonomous shops. You can search by name, manufacturer, category, or use the live visual search to find products by image."}),u.jsxs("div",{className:"mt-4 flex flex-col gap-3 sm:flex-row sm:items-center",children:[u.jsx("input",{type:"search",value:c,onChange:R=>f(R.target.value),placeholder:"Search products by name, category, or manufacturer...",className:"flex-1 px-4 py-2.5 rounded-lg bg-gray-900/80 border border-gray-700 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),u.jsxs("button",{onClick:()=>C(!0),className:"flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-500",children:[u.jsx(Oi,{className:"w-5 h-5"}),"Live Visual Search"]})]}),(I||k)&&u.jsx("p",{className:"mt-3 text-sm text-cyan-300",children:k?u.jsxs(u.Fragment,{children:["Showing results for visual search: ",u.jsx("span",{className:"font-semibold",children:k})]}):u.jsxs(u.Fragment,{children:["Showing matches for ",u.jsx("span",{className:"font-semibold",children:I==null?void 0:I.name})," based on the latest scan."]})}),b&&u.jsx("p",{className:"mt-3 text-sm text-red-400",children:b})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:"Product Catalog"}),h?u.jsx("span",{className:"text-sm text-gray-400",children:"Loading catalog..."}):m?u.jsx("span",{className:"text-sm text-gray-400",children:"Searching"}):u.jsxs("span",{className:"text-sm text-gray-400",children:[e.length," result(s)"]})]}),h?u.jsx("p",{className:"text-gray-400",children:"Fetching catalog..."}):e.length===0&&c.trim()?u.jsx("p",{className:"text-gray-400",children:"No such product found! Try a different keyword or use the live visual search."}):e.length===0?u.jsx("p",{className:"text-gray-400",children:"No products available. Try searching or use the live visual search."}):u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:e.map(R=>u.jsxs("div",{className:"p-4 rounded-lg bg-gray-900/60 border border-gray-700",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-white truncate",title:R.name,children:R.name}),R.category&&u.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-cyan-900/40 text-cyan-200 border border-cyan-700/40",children:R.category})]}),u.jsx("p",{className:"text-sm text-gray-400 mb-2",children:R.manufacturer||"Unknown manufacturer"}),R.description&&u.jsx("p",{className:"text-xs text-gray-400 line-clamp-3",children:R.description})]},R.id))})]}),w&&u.jsx(Zs,{onDataScanned:R=>{const z=R.blobs.get("productName")||R.blobs.get("manufacturer")||Array.from(R.blobs.values())[0];z?D(z):(S("No image captured. Please try again."),C(!1))},onClose:()=>C(!1),productOptions:s.map(R=>({productId:R.id,productName:R.name})),mode:"visual-search"})]})},K_=({onLogout:n,name:e})=>{const{currentShop:i,setCurrentShop:s}=pd(),{customer:r,setCustomer:c,clearCustomer:f}=hx(),[h,y]=T.useState(!1),[m,v]=T.useState("discovery"),{showToast:b}=Zn(),S=C=>{var P;const I=C.user;if((P=I.roles)!=null&&P.shop||I.shopId){b("Shop account detected. Please sign in via the shop dashboard.","info"),y(!1);return}c(C),y(!1),b("Welcome! You can now checkout.","success")},w=()=>{f(),b("Logged out successfully","success"),n==null||n(),y(!1)};return T.useEffect(()=>{i&&v("shop")},[i]),u.jsxs("div",{className:"min-h-screen bg-gray-900",children:[u.jsx("div",{className:"bg-gray-800/50 border-b border-gray-700 p-4",children:u.jsxs("div",{className:"container mx-auto flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-white",children:"ShopNexus Customer"}),r&&u.jsxs("p",{className:"text-sm text-gray-400",children:["Logged in as ",r.user.companyName||r.user.email]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[i&&u.jsx("button",{onClick:()=>{s(null),v("discovery")},className:"px-4 py-2 text-sm text-cyan-400 hover:text-cyan-300 border border-cyan-600 rounded-lg hover:bg-cyan-900/30 transition",children:"Change Shop"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>v("discovery"),className:`px-4 py-2 text-sm border rounded-lg transition ${m==="discovery"?"bg-cyan-600 text-white border-cyan-600":"text-gray-300 border-gray-600 hover:bg-gray-700"}`,children:"Browse Catalog"}),i&&u.jsx("button",{onClick:()=>v("shop"),className:`px-4 py-2 text-sm border rounded-lg transition ${m==="shop"?"bg-cyan-600 text-white border-cyan-600":"text-gray-300 border-gray-600 hover:bg-gray-700"}`,children:"Shop View"})]}),r?u.jsx("button",{onClick:w,className:"px-4 py-2 text-sm text-gray-300 hover:text-white border border-gray-600 rounded-lg hover:bg-gray-700 transition",children:"Logout"}):u.jsx("button",{onClick:()=>y(!0),className:"px-4 py-2 text-sm text-cyan-400 hover:text-cyan-300 border border-cyan-600 rounded-lg hover:bg-cyan-900/30 transition",children:"Login"})]})]})}),u.jsx("div",{className:"container mx-auto p-4 md:p-8",children:h?u.jsxs("div",{className:"max-w-lg mx-auto",children:[u.jsx($y,{onAuthenticated:S}),u.jsx("button",{onClick:()=>y(!1),className:"mt-4 w-full py-2 px-4 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition",children:"Cancel"})]}):m==="discovery"?u.jsxs(u.Fragment,{children:[!i&&u.jsx(lg,{}),i&&u.jsx("div",{className:"mb-6",children:u.jsx(lg,{})}),u.jsx($_,{name:e||"Guest"})]}):u.jsx(Q_,{})})]})},cg=({name:n,initialProfile:e,onLogout:i})=>u.jsx(O_,{children:u.jsx(F_,{initialCustomer:e,children:u.jsx(K_,{name:n,onLogout:i})})}),X_=({name:n})=>{const[e,i]=T.useState([]),[s,r]=T.useState(!0),[c,f]=T.useState(""),[h,y]=T.useState(""),[m,v]=T.useState(null),b=async()=>{r(!0),v(null);try{const w=await _a();i(w)}catch(w){v(w instanceof Error?w.message:"Failed to load suppliers.")}finally{r(!1)}};T.useEffect(()=>{b()},[]);const S=async w=>{if(w.preventDefault(),!c.trim()){v("Supplier name is required.");return}v(null);try{await Ki({name:c.trim(),contactEmail:h.trim()||void 0}),f(""),y(""),await b()}catch(C){v(C instanceof Error?C.message:"Failed to create supplier.")}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"Supplier Console"}),u.jsxs("p",{className:"text-gray-300",children:["Hello ",n,"! Manage your supplier network here. Register local suppliers (created by your shop) or review existing ones (local or global suppliers linked to registered users)."]})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Register Local Supplier"}),u.jsxs("form",{onSubmit:S,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Supplier Name"}),u.jsx("input",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:c,onChange:w=>f(w.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Contact Email (optional)"}),u.jsx("input",{type:"email",className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:h,onChange:w=>y(w.target.value)})]}),u.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md bg-cyan-600 text-white font-semibold",children:"Add Supplier"})]}),m&&u.jsx("p",{className:"text-red-400 text-sm mt-2",children:m})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:"Suppliers"}),u.jsx("button",{onClick:b,className:"px-3 py-1.5 bg-gray-700 rounded-md text-sm text-white hover:bg-gray-600",children:"Refresh"})]}),s?u.jsx("p",{className:"text-gray-400",children:"Loading suppliers..."}):e.length===0?u.jsx("p",{className:"text-gray-500",children:"No suppliers yet. Add a local supplier above."}):u.jsx("div",{className:"space-y-3",children:e.map(w=>u.jsx("div",{className:"p-3 bg-gray-900/40 rounded-lg border border-gray-700 hover:bg-gray-900/60 transition-colors",children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("p",{className:"text-white font-semibold",children:w.name}),w.shopId?u.jsx("span",{className:"text-xs bg-cyan-600/20 text-cyan-400 px-2 py-1 rounded",children:"Local"}):w.linkedUserId?u.jsx("span",{className:"text-xs bg-green-600/20 text-green-400 px-2 py-1 rounded",children:"Global"}):null]}),w.contact&&u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:w.contact}),w.linkedUserId&&u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Linked User ID: ",w.linkedUserId]}),w.shopId&&u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Shop ID: ",w.shopId]})]})})},w.id))})]})]})},Z_=({onClose:n,onProductCreated:e})=>{const i=T.useRef(null),s=T.useRef(null),r=T.useRef(null),c=T.useRef(null),[f,h]=T.useState("scanning"),[y,m]=T.useState(null),[v,b]=T.useState({}),[S,w]=T.useState(new Set),[C,I]=T.useState(new Map),[P,k]=T.useState(null),[V,q]=T.useState(null),[D,R]=T.useState(null),[z,F]=T.useState(!1),ie=T.useCallback(()=>{c.current&&(clearInterval(c.current),c.current=null)},[]),K=T.useCallback(()=>{if(i.current&&r.current){const A=i.current,B=r.current,Z=A.getBoundingClientRect();B.width=Z.width,B.height=Z.height}},[]);T.useEffect(()=>{let A=null;return(async()=>{try{A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}}),i.current&&(i.current.srcObject=A,i.current.onloadedmetadata=()=>K())}catch{m("Could not access camera. Please grant permissions.")}})(),window.addEventListener("resize",K),()=>{window.removeEventListener("resize",K),ie(),A==null||A.getTracks().forEach(Z=>Z.stop())}},[K,ie]);const Y=T.useCallback(async()=>{if(!i.current||!s.current||document.hidden||f!=="scanning")return;const A=i.current,B=s.current;B.width=A.videoWidth,B.height=A.videoHeight;const Z=B.getContext("2d");if(!Z)return;Z.drawImage(A,0,0,A.videoWidth,A.videoHeight);const re=await new Promise(ae=>B.toBlob(ae,"image/jpeg",.8));if(!(!re||f!=="scanning"))try{const ae=await Or(re);b(_=>{const L={..._};for(const $ in ae){const se=$;S.has(se)||(L[se]=ae[se])}return L})}catch(ae){console.warn("Auto-scan failed:",ae)}},[f,S]);T.useEffect(()=>{f==="scanning"&&!c.current?c.current=window.setInterval(Y,3500):f!=="scanning"&&ie()},[f,Y,ie]);const fe=A=>{k(A),h("drawingBox"),q(null),R(null)},ue=A=>{var ae;if(f!=="drawingBox"||!P)return;const B=(ae=r.current)==null?void 0:ae.getBoundingClientRect();if(!B)return;const Z=A.clientX-B.left,re=A.clientY-B.top;if(!V)q({x:Z,y:re});else{const _={x:Math.min(V.x,Z),y:Math.min(V.y,re),width:Math.abs(Z-V.x),height:Math.abs(re-V.y)};_.width>5&&_.height>5&&(R(_),Ne(_)),q(null)}},Ne=T.useCallback(async A=>{if(!i.current||!s.current||!P)return;h("analyzing");const B=i.current,Z=s.current,re=B.videoWidth/B.clientWidth,ae=B.videoHeight/B.clientHeight,_=A.x*re,L=A.y*ae,$=A.width*re,se=A.height*ae;Z.width=$,Z.height=se;const me=Z.getContext("2d");if(me){me.drawImage(B,_,L,$,se,0,0,$,se);const ye=await new Promise(te=>Z.toBlob(te,"image/jpeg",.9));if(ye){I(te=>new Map(te).set(P,ye));try{const te=await ud(ye,P);b(Q=>({...Q,[P]:te})),w(Q=>new Set(Q).add(P))}catch(te){m(te instanceof Error?te.message:"Analysis failed")}}}k(null),R(null),h("scanning")},[P]),we=async()=>{const A=v;if(!A.productName||!A.manufacturer||!A.category){m("Product Name, Manufacturer, and Category are required to save."),h("scanning");return}F(!0),m(null);try{const B=await $i({name:A.productName,manufacturer:A.manufacturer,category:A.category,description:A.productDescription||""}),Z=Array.from(C.entries()).map(([re,ae])=>Wu(B.name,re,ae,{productId:B.id,source:"manual"}));await Promise.all(Z),e(),n()}catch(B){m(B instanceof Error?B.message:"Failed to save product.")}finally{F(!1)}},Re=()=>f==="scanning"?"Auto-scanning product... Tap screen to manually select a field.":f==="drawingBox"?V?"Tap the opposite corner to create a selection.":`Tap the first corner for ${$t[P].displayName}.`:f==="analyzing"?`Analyzing ${$t[P].displayName}...`:f==="verifying"?"Review the extracted data and confirm to save the new product.":"";return f==="verifying"?u.jsxs("div",{className:"fixed inset-0 bg-gray-900 z-50 p-4 sm:p-8 flex flex-col","aria-modal":"true",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Verify New Product"}),y&&u.jsx("p",{className:"bg-red-900/50 text-red-300 p-3 rounded-md mb-4",children:y}),u.jsx("div",{className:"flex-grow overflow-y-auto space-y-4 bg-gray-800/50 p-4 rounded-lg",children:Object.entries(v).map(([A,B])=>{var ae;const Z=A,re=C.get(Z);return u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-400",children:((ae=$t[Z])==null?void 0:ae.displayName)||A}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("input",{value:String(B),onChange:_=>b(L=>({...L,[Z]:_.target.value})),className:"flex-grow px-3 py-2 rounded-md bg-gray-700 border border-gray-600 text-white"}),re&&u.jsx("img",{src:URL.createObjectURL(re),alt:`Crop of ${A}`,className:"w-24 h-12 object-contain rounded-md bg-black"})]})]},A)})}),u.jsxs("div",{className:"flex-shrink-0 pt-6 flex justify-end gap-4",children:[u.jsx("button",{onClick:()=>h("scanning"),disabled:z,className:"px-6 py-2 rounded-md bg-gray-600 text-white font-semibold",children:"Back to Scanner"}),u.jsx("button",{onClick:we,disabled:z,className:"px-6 py-2 rounded-md bg-cyan-600 text-white font-semibold",children:z?"Saving...":"Confirm & Save Product"})]})]}):u.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex","aria-modal":"true",children:[u.jsxs("div",{className:"flex-grow relative",children:[u.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),u.jsx("canvas",{ref:s,className:"hidden"}),u.jsx("canvas",{ref:r,className:"absolute inset-0 w-full h-full z-10",onClick:ue}),y&&u.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-red-800/80 text-white p-3 rounded-lg text-center z-30 max-w-md mx-auto",children:y}),u.jsx("div",{className:"absolute top-4 left-4 bg-black/50 text-white px-4 py-2 rounded-full z-20 text-center text-sm",children:Re()})]}),u.jsxs("div",{className:"w-full md:w-96 bg-gray-900/80 backdrop-blur-sm border-l border-gray-700 flex flex-col p-4 space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h2",{className:"text-xl font-bold text-white",children:"Learn Product"}),u.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white",children:""})]}),u.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 pr-2",children:Object.keys($t).map(A=>{const B=S.has(A),Z=v[A]!==void 0&&v[A]!==""&&v[A]!==0;return u.jsxs("button",{onClick:()=>fe(A),className:`w-full text-left p-3 rounded-md transition-colors flex items-center justify-between ${B?"bg-indigo-800/50":"bg-gray-700/50 hover:bg-gray-700"}`,children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-semibold text-white",children:$t[A].displayName}),Z&&u.jsx("p",{className:"text-sm text-cyan-300 truncate",children:String(v[A])})]}),B&&u.jsx(rx,{className:"w-5 h-5 text-indigo-300 flex-shrink-0"})]},A)})}),u.jsx("div",{className:"flex-shrink-0",children:u.jsxs("button",{onClick:()=>h("verifying"),className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-cyan-600 text-white font-semibold rounded-md hover:bg-cyan-700 transition-colors",children:[u.jsx(gx,{className:"w-6 h-6"}),"Verify & Save"]})})]})]})},W_=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),u.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),eA=()=>{const[n,e]=T.useState([]),[i,s]=T.useState([]),[r,c]=T.useState(!0),[f,h]=T.useState(null),[y,m]=T.useState(""),[v,b]=T.useState(""),[S,w]=T.useState(""),[C,I]=T.useState(""),[P,k]=T.useState(void 0),[V,q]=T.useState(""),[D,R]=T.useState(!1),[z,F]=T.useState([]),[ie,K]=T.useState(""),[Y,fe]=T.useState(""),[ue,Ne]=T.useState(""),[we,Re]=T.useState(null),[A,B]=T.useState(null),[Z,re]=T.useState(!1),{showToast:ae}=Zn(),_=async()=>{c(!0),h(null);try{const[Q,W]=await Promise.all([Hr(),_a()]);e(Q),s(Q),F(W.map(ce=>({id:ce.id,name:ce.name||ce.id})))}catch(Q){h(Q instanceof Error?Q.message:"Failed to load products.")}finally{c(!1)}};dg.useEffect(()=>{let Q=n;if(ie.trim()){const W=ie.toLowerCase();Q=Q.filter(ce=>ce.name.toLowerCase().includes(W)||ce.manufacturer.toLowerCase().includes(W)||ce.category.toLowerCase().includes(W)||ce.description&&ce.description.toLowerCase().includes(W))}Y&&(Q=Q.filter(W=>W.category===Y)),ue&&(Q=Q.filter(W=>W.manufacturer===ue)),s(Q)},[n,ie,Y,ue]),T.useEffect(()=>{_()},[]);const L=()=>{_(),ae("New product successfully learned and added to catalog!","success")},$=async Q=>{if(Q.preventDefault(),!y.trim()){h("Name is required.");return}R(!0),h(null);try{const W=V?[{url:V.trim(),type:"manual",source:"user",addedAt:new Date().toISOString()}]:[];await $i({name:y,manufacturer:v,category:S,description:C,defaultSupplierId:P,images:W}),m(""),b(""),w(""),I(""),q(""),k(void 0),await _(),ae("Product created successfully!","success")}catch(W){const ce=W instanceof Error?W.message:"Failed to create product.";h(ce),ae(ce,"error")}finally{R(!1)}},se=Q=>{var W,ce;Re(Q),m(Q.name),b(Q.manufacturer),w(Q.category),I(Q.description||""),q(((ce=(W=Q.images)==null?void 0:W[0])==null?void 0:ce.url)||""),k(Q.defaultSupplierId||void 0)},me=()=>{Re(null),m(""),b(""),w(""),I(""),q(""),k(void 0),h(null)},ye=async Q=>{if(Q.preventDefault(),!we||!y.trim()){h("Name is required.");return}R(!0),h(null);try{const W=V?[{url:V.trim(),type:"manual",source:"user",addedAt:new Date().toISOString()}]:[];await Qg(we.id,{name:y,manufacturer:v,category:S,description:C,defaultSupplierId:P,images:W}),me(),await _(),ae("Product updated successfully!","success")}catch(W){const ce=W instanceof Error?W.message:"Failed to update product.";h(ce),ae(ce,"error")}finally{R(!1)}},te=async Q=>{try{await $g(Q),B(null),await _(),ae("Product deleted successfully!","success")}catch(W){const ce=W instanceof Error?W.message:"Failed to delete product.";ae(ce,"error")}};return u.jsxs(u.Fragment,{children:[Z&&u.jsx(Z_,{onClose:()=>re(!1),onProductCreated:L}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Product Catalog"}),u.jsxs("button",{onClick:()=>re(!0),className:"flex items-center justify-center gap-3 py-3 px-6 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500 transition-all",children:[u.jsx(lx,{className:"w-6 h-6"}),"Scan & Train New Product"]})]}),u.jsx("p",{className:"text-gray-400 text-sm",children:"Use the AI scanner to learn new products. The system will extract all relevant information sections from the product image and learn where to look for specific data fields for future scans."})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:we?"Edit Product":"Create Product Manually"}),u.jsxs("form",{onSubmit:we?ye:$,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Name"}),u.jsx("input",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:y,onChange:Q=>m(Q.target.value),required:!0})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Manufacturer"}),u.jsx("input",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:v,onChange:Q=>b(Q.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Category"}),u.jsx("input",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:S,onChange:Q=>w(Q.target.value)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Description"}),u.jsx("textarea",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:C,onChange:Q=>I(Q.target.value),rows:3})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Default Supplier"}),u.jsxs("select",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:P||"",onChange:Q=>k(Q.target.value||void 0),children:[u.jsx("option",{value:"",children:"None"}),z.map(Q=>u.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Image URL"}),u.jsx("input",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:V,onChange:Q=>q(Q.target.value),placeholder:"https://example.com/photo.jpg"})]})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{type:"submit",disabled:D,className:"px-4 py-2 rounded-md bg-cyan-600 text-white font-semibold disabled:opacity-60 hover:bg-cyan-700 transition-colors",children:D?we?"Updating...":"Creating...":we?"Update Product":"Create Product"}),we&&u.jsx("button",{type:"button",onClick:me,disabled:D,className:"px-4 py-2 rounded-md bg-gray-700 text-white font-semibold disabled:opacity-60 hover:bg-gray-600 transition-colors",children:"Cancel"})]})]}),f&&u.jsx("p",{className:"text-red-400 text-sm mt-2",children:f})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:"All Products"}),u.jsx("button",{onClick:_,className:"px-3 py-1.5 rounded-md bg-gray-700 text-sm text-white hover:bg-gray-600",children:"Refresh"})]}),u.jsxs("div",{className:"mb-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Search Products"}),u.jsx("input",{type:"text",className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",placeholder:"Search by name, manufacturer, category, or description...",value:ie,onChange:Q=>K(Q.target.value)})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Filter by Category"}),u.jsxs("select",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:Y,onChange:Q=>fe(Q.target.value),children:[u.jsx("option",{value:"",children:"All Categories"}),Array.from(new Set(n.map(Q=>Q.category).filter(Boolean))).sort().map(Q=>u.jsx("option",{value:Q,children:Q},Q))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Filter by Manufacturer"}),u.jsxs("select",{className:"w-full px-3 py-2 rounded-md bg-gray-900 border border-gray-700 text-white",value:ue,onChange:Q=>Ne(Q.target.value),children:[u.jsx("option",{value:"",children:"All Manufacturers"}),Array.from(new Set(n.map(Q=>Q.manufacturer).filter(Boolean))).sort().map(Q=>u.jsx("option",{value:Q,children:Q},Q))]})]})]})]}),r?u.jsx("p",{className:"text-gray-400",children:"Loading products..."}):i.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(W_,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500 text-lg mb-2",children:n.length===0?"No products yet.":"No products match your filters."}),n.length===0&&u.jsx("button",{onClick:()=>re(!0),className:"mt-4 px-6 py-3 rounded-md bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors",children:"Scan Your First Product"})]}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("p",{className:"text-sm text-gray-400",children:["Showing ",i.length," of ",n.length," products"]}),i.map(Q=>{var W;return u.jsxs("div",{className:"p-4 bg-gray-900/40 rounded-lg border border-gray-700 hover:bg-gray-900/60 transition-colors",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{className:"flex items-start gap-3",children:[Q.images&&Q.images[0]&&u.jsx("img",{src:Q.images[0].url,alt:Q.name,className:"w-16 h-16 object-cover rounded-md flex-shrink-0",onError:ce=>{ce.target.style.display="none"}}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-white font-semibold text-lg",children:Q.name}),u.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[Q.manufacturer,"  ",Q.category]}),Q.description&&u.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:Q.description}),Q.defaultSupplierId&&u.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700",children:[u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Default Supplier:"}),u.jsx("span",{className:"inline-block px-2 py-0.5 text-xs bg-blue-900/30 text-blue-300 rounded border border-blue-700/50",children:((W=z.find(ce=>ce.id===Q.defaultSupplierId))==null?void 0:W.name)||Q.defaultSupplierId})]})]})]})}),u.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[u.jsx("button",{onClick:()=>se(Q),className:"px-3 py-1.5 rounded-md bg-blue-600/80 text-white text-sm hover:bg-blue-600 transition-colors",title:"Edit product",children:"Edit"}),u.jsx("button",{onClick:()=>B(Q.id),className:"px-3 py-1.5 rounded-md bg-red-600/80 text-white text-sm hover:bg-red-600 transition-colors",title:"Delete product",children:"Delete"})]})]}),A===Q.id&&u.jsxs("div",{className:"mt-4 p-3 bg-red-900/30 border border-red-700 rounded-md",children:[u.jsxs("p",{className:"text-red-300 text-sm mb-3",children:['Are you sure you want to delete "',Q.name,'"?']}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>te(Q.id),className:"px-3 py-1.5 rounded-md bg-red-600 text-white text-sm hover:bg-red-700 transition-colors",children:"Yes, Delete"}),u.jsx("button",{onClick:()=>B(null),className:"px-3 py-1.5 rounded-md bg-gray-700 text-white text-sm hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})]},Q.id)})]})]})]})]})},tA=()=>{const[n,e]=T.useState([]),[i,s]=T.useState([]),[r,c]=T.useState([]),[f,h]=T.useState(!0),[y,m]=T.useState({deliveryDate:new Date().toISOString().split("T")[0],lineItems:[],documents:[]}),[v,b]=T.useState([]),[S,w]=T.useState(!1),[C,I]=T.useState(!1),[P,k]=T.useState(!1),[V,q]=T.useState(null),D=T.useRef(null),R=T.useMemo(()=>new Map(r.map(A=>[A.id,A])),[r]),z=T.useMemo(()=>new Map(i.map(A=>[A.id,A.name||A.id])),[i]),F=async()=>{h(!0),q(null);try{const[A,B,Z]=await Promise.all([Zg(),_a(),Hr()]);e(A.sort((re,ae)=>new Date(ae.deliveryDate).getTime()-new Date(re.deliveryDate).getTime())),s(B),c(Z)}catch(A){q(A instanceof Error?A.message:"Failed to load data.")}finally{h(!1)}};T.useEffect(()=>{F()},[]);const ie=()=>{m({deliveryDate:new Date().toISOString().split("T")[0],lineItems:[],documents:[]}),b([]),D.current&&(D.current.value="")},K=A=>{A.target.files&&b(B=>[...B,...Array.from(A.target.files)])},Y=A=>{b(B=>B.filter((Z,re)=>re!==A))},fe=async()=>{if(v.length!==0){I(!0),q(null);try{const A=await Zy(v),B=i.find(re=>A.supplierName&&re.name.toLowerCase().includes(A.supplierName.toLowerCase())),Z=A.items.map(re=>{const ae=r.find(_=>_.name.toLowerCase()===re.productName.toLowerCase());return{productId:(ae==null?void 0:ae.id)||"",productName:re.productName,quantity:re.quantity,cost:re.costPerUnit}});m(re=>({...re,supplierId:(B==null?void 0:B.id)||re.supplierId,invoiceNumber:A.invoiceNumber||re.invoiceNumber,deliveryDate:A.deliveryDate||re.deliveryDate,lineItems:Z}))}catch(A){q(A instanceof Error?A.message:"Failed to analyze documents.")}finally{I(!1)}}},ue=(A,B,Z)=>{const re=[...y.lineItems||[]];if(re[A]={...re[A],[B]:Z},B==="productId"){const ae=R.get(Z);ae&&(re[A].productName=ae.name)}m(ae=>({...ae,lineItems:re}))},Ne=()=>{const A={productId:"",productName:"Manual Entry",quantity:1,cost:0};m(B=>({...B,lineItems:[...B.lineItems||[],A]}))},we=A=>{m(B=>{var Z;return{...B,lineItems:(Z=B.lineItems)==null?void 0:Z.filter((re,ae)=>ae!==A)}})},Re=async A=>{if(A.preventDefault(),!y.deliveryDate||!y.lineItems||y.lineItems.length===0){q("Delivery date and at least one valid line item are required.");return}const B=y.lineItems.filter(Z=>Z.productId&&Z.quantity>0);if(B.length===0){q("At least one line item must be assigned to a product.");return}w(!0),q(null);try{await Js({...y,deliveryDate:y.deliveryDate,lineItems:B}),ie(),await F()}catch(Z){q(Z instanceof Error?Z.message:"Failed to create batch.")}finally{w(!1)}};return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[u.jsx(cd,{className:"w-6 h-6 text-cyan-400"}),"Log New Delivery Batch"]}),u.jsxs("form",{onSubmit:Re,className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Delivery Date"}),u.jsx("input",{type:"date",className:"form-input",value:y.deliveryDate||"",onChange:A=>m(B=>({...B,deliveryDate:A.target.value})),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Supplier"}),u.jsxs("select",{className:"form-input",value:y.supplierId||"",onChange:A=>m(B=>({...B,supplierId:A.target.value||void 0})),children:[u.jsx("option",{value:"",children:"Select Supplier..."}),i.map(A=>u.jsx("option",{value:A.id,children:A.name},A.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Invoice Number"}),u.jsx("input",{className:"form-input",value:y.invoiceNumber||"",onChange:A=>m(B=>({...B,invoiceNumber:A.target.value}))})]})]}),u.jsxs("div",{className:"p-4 border border-gray-700 rounded-lg space-y-3",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-200",children:"Upload Documents"}),u.jsx("input",{type:"file",ref:D,onChange:K,accept:"image/*",className:"hidden",multiple:!0}),u.jsxs("button",{type:"button",onClick:()=>{var A;return(A=D.current)==null?void 0:A.click()},className:"button-secondary w-full",children:[u.jsx(cx,{className:"w-5 h-5"})," Add Document(s)"]}),u.jsx("div",{className:"space-y-2",children:v.map((A,B)=>u.jsxs("div",{className:"flex items-center justify-between bg-gray-900/50 p-2 rounded text-sm",children:[u.jsx("span",{className:"truncate text-gray-300",children:A.name}),u.jsx("button",{type:"button",onClick:()=>Y(B),className:"text-red-400 hover:text-red-300",children:u.jsx(Rr,{className:"w-4 h-4"})})]},B))}),v.length>0&&u.jsx("button",{type:"button",onClick:fe,disabled:C,className:"button-primary w-full",children:C?"Analyzing...":`Analyze ${v.length} Document(s) with AI`})]})]}),u.jsxs("div",{className:"space-y-4 p-4 border border-gray-700 rounded-lg bg-gray-900/20",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-200",children:"Line Items"}),u.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:(y.lineItems||[]).map((A,B)=>u.jsxs("div",{className:"p-2 rounded-md bg-gray-800/50 grid grid-cols-12 gap-2 items-center",children:[u.jsxs("div",{className:"col-span-6",children:[u.jsxs("select",{className:"form-input text-sm",value:A.productId,onChange:Z=>ue(B,"productId",Z.target.value),required:!0,children:[u.jsx("option",{value:"",children:"Match Product..."}),r.map(Z=>u.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),A.productId===""&&u.jsxs("p",{className:"text-xs text-yellow-400 mt-1",children:['Unmatched: "',A.productName,'"']})]}),u.jsx("div",{className:"col-span-2",children:u.jsx("input",{type:"number",placeholder:"Qty",className:"form-input text-sm",value:A.quantity,onChange:Z=>ue(B,"quantity",Number(Z.target.value))})}),u.jsx("div",{className:"col-span-3",children:u.jsx("input",{type:"number",placeholder:"Cost",step:"0.01",className:"form-input text-sm",value:A.cost,onChange:Z=>ue(B,"cost",Number(Z.target.value))})}),u.jsx("div",{className:"col-span-1",children:u.jsx("button",{type:"button",onClick:()=>we(B),className:"text-red-400 hover:text-red-300",children:u.jsx(Rr,{className:"w-4 h-4"})})})]},B))}),u.jsx("button",{type:"button",onClick:Ne,className:"button-secondary text-sm",children:"Add Manual Item"}),u.jsx("button",{type:"submit",disabled:S,className:"button-primary w-full",children:S?"Saving Batch...":"Save Batch"})]})]}),V&&u.jsx("p",{className:"text-red-400 text-sm mt-4",children:V})]}),u.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-white",children:"Logged Batches"}),u.jsx("button",{onClick:F,className:"button-secondary text-sm",children:"Refresh"})]}),f?u.jsx("p",{className:"text-gray-400",children:"Loading batches..."}):n.length===0?u.jsx("p",{className:"text-gray-500 text-center py-4",children:"No batches logged yet."}):u.jsx("div",{className:"space-y-3",children:n.map(A=>{var B,Z;return u.jsxs("details",{className:"p-3 bg-gray-900/40 rounded-lg border border-gray-700 transition-colors",children:[u.jsx("summary",{className:"cursor-pointer",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-white font-semibold",children:["Delivery: ",A.deliveryDate]}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Supplier: ",z.get(A.supplierId||"")||A.supplierId||"N/A"]}),u.jsxs("p",{className:"text-xs text-gray-500",children:["Invoice #: ",A.invoiceNumber||"N/A"]})]}),u.jsx("div",{className:"text-right text-sm",children:u.jsxs("span",{className:"text-gray-300",children:[((B=A.lineItems)==null?void 0:B.length)||0," items"]})})]})}),u.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700",children:u.jsx("ul",{className:"space-y-1 text-sm",children:(Z=A.lineItems)==null?void 0:Z.map((re,ae)=>{var _;return u.jsxs("li",{className:"flex justify-between text-gray-300",children:[u.jsxs("span",{children:[re.quantity,"x ",((_=R.get(re.productId))==null?void 0:_.name)||re.productName]}),u.jsxs("span",{className:"text-gray-400",children:["$",re.cost.toFixed(2),"/unit"]})]},ae)})})})]},A.id)})})]}),u.jsx("style",{children:`
        .form-input {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            background-color: #1f2937;
            border: 1px solid #4b5563;
            color: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus {
            outline: none;
            border-color: #22d3ee;
            box-shadow: 0 0 0 2px rgba(34, 211, 238, 0.4);
        }
        .button-primary {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.625rem 1rem;
            border-radius: 0.375rem;
            background-color: #0891b2;
            color: white;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .button-primary:hover {
            background-color: #0e7490;
        }
        .button-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .button-secondary {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            background-color: #4b5563;
            color: white;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .button-secondary:hover {
            background-color: #6b7280;
        }
      `})]})},nA=()=>{var A,B,Z,re;const[n,e]=T.useState(null),{toasts:i,removeToast:s}=Zn(),r=(n==null?void 0:n.user)??null,c=!!((A=r==null?void 0:r.roles)!=null&&A.shop||r!=null&&r.shopId),f=!!((B=r==null?void 0:r.roles)!=null&&B.customer||r!=null&&r.customerId),h=!!((Z=r==null?void 0:r.roles)!=null&&Z.supplier||r!=null&&r.supplierId),[y,m]=T.useState([]),[v,b]=T.useState([]),[S,w]=T.useState([]),[C,I]=T.useState("dashboard"),[P,k]=T.useState(!0),V=!r,q=T.useMemo(()=>{if(!(n!=null&&n.shopContext)||!r)return null;let ae;if(typeof n.shopContext=="string")ae=n.shopContext;else if(n.shopContext&&typeof n.shopContext=="object"&&"id"in n.shopContext)ae=n.shopContext.id;else return null;return{id:ae,name:r.companyName,contactEmail:r.email,location:r.address,qdrantNamespace:ae}},[n==null?void 0:n.shopContext,(re=n==null?void 0:n.user)==null?void 0:re.shopId,r==null?void 0:r.shopId,r==null?void 0:r.companyName,r==null?void 0:r.email,r==null?void 0:r.address]),D=T.useRef(null);T.useEffect(()=>{var L;const ae=(L=D.current)==null?void 0:L.id,_=q==null?void 0:q.id;ae!==_&&(D.current=q,$s(q))},[q]);const R=T.useCallback(async ae=>{var L;if(!ae){k(!1);return}const _=!!((L=ae.roles)!=null&&L.shop||ae.shopId);if(k(!0),_){const $=await zr(),se=await Ly(),me=await sd();b($),m(se),w(me)}else b([]),m([]),w([]);k(!1)},[]),z=T.useRef(!1),F=T.useRef(null);T.useEffect(()=>{var $;if(V||!r){z.current=!1;return}const ae=!!(($=r.roles)!=null&&$.shop||r.shopId),_=r.shopId||null;if(!ae||z.current&&F.current===_)return;(async()=>{await Py(),await R(r),z.current=!0,F.current=_})()},[V,r==null?void 0:r.shopId,R]),T.useEffect(()=>{if(!r||!c)return;const ae=setInterval(()=>{R(r)},6e4);return()=>clearInterval(ae)},[r,c,R]);const ie=T.useCallback(ae=>{var L,$,se;e(ae),k(!1);const _=ae.user;_.shopId||(L=_.roles)!=null&&L.shop?I("dashboard"):_.supplierId||($=_.roles)!=null&&$.supplier?I("supplier"):_.customerId||(se=_.roles)!=null&&se.customer?I("customer"):I("dashboard")},[]),K=T.useCallback(()=>{e(null),m([]),b([]),w([]),I("dashboard")},[]),Y=async(ae,_)=>{await zi(ae,_),r&&await R(r)},fe=async ae=>{await id(ae),r&&await R(r)},ue=async(ae,_)=>{await jy(ae,_),await $2(ae.listingId,_),r&&await R(r)},Ne=ae=>I(ae),we=T.useMemo(()=>{if(!r||!c)return[];const ae=S.filter(L=>L.quantity>0&&(!L.status||L.status==="ACTIVE")),_=new Map(v.map(L=>[L.productId,L]));return ae.map(L=>{const $=_.get(L.productId);return{id:L.id,batchId:String(L.batchId),productId:L.productId,inventoryUuid:L.inventoryUuid,productName:($==null?void 0:$.productName)||"N/A",manufacturer:($==null?void 0:$.manufacturer)||"N/A",category:($==null?void 0:$.category)||"N/A",expirationDate:L.expirationDate,quantity:L.quantity,quantityType:($==null?void 0:$.quantityType)||"units",costPerUnit:L.costPerUnit,location:L.location||void 0,createdAt:L.createdAt,updatedAt:L.updatedAt,supplierId:L.supplierId||null,buyPrice:L.buyPrice??L.costPerUnit,sellPrice:L.sellPrice??void 0}})},[S,v,r==null?void 0:r.shopId,c]);return r&&f&&!c?u.jsx(cg,{name:r.companyName||"Guest",initialProfile:n??void 0,onLogout:K}):V?u.jsx($y,{onAuthenticated:ie}):!r||c&&P?u.jsxs("div",{className:"min-h-screen bg-gray-900 flex flex-col items-center justify-center text-white",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400"}),u.jsx("p",{className:"mt-4 text-lg",children:"Initializing Application..."})]}):u.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 font-sans",children:[u.jsx(h_,{activeTab:C,onTabChange:Ne,user:r,onLogout:K,isBackendAvailable:l2}),u.jsxs("main",{className:"container mx-auto p-4 md:p-8",children:[C==="dashboard"&&u.jsx(A_,{summaries:c?v:[],onNavigateToInventory:()=>c&&Ne("inventory"),onRefreshData:r?()=>R(r):void 0}),C==="inventory"&&c&&u.jsx(j_,{summaries:v,items:we,batches:y,onAddBatch:Y,onDataRefresh:()=>r&&R(r)}),C==="catalog"&&c&&u.jsx(eA,{}),C==="batches"&&c&&u.jsx(tA,{}),C==="kiosk"&&c&&u.jsx(B_,{summaries:v,onPurchase:fe}),C==="marketplace"&&c&&u.jsx(H_,{summaries:v,user:r,onPurchase:ue}),C==="customer"&&f&&u.jsx(cg,{name:r.companyName}),C==="supplier"&&h&&u.jsx(X_,{name:r.companyName}),C==="backend"&&u.jsx(z_,{}),!c&&["inventory","catalog","batches","kiosk","marketplace"].includes(C)&&u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 text-center",children:u.jsx("p",{className:"text-red-400",children:"Access Denied: Shop role required"})}),!f&&C==="customer"&&u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 text-center",children:u.jsx("p",{className:"text-red-400",children:"Access Denied: Customer role required"})}),!h&&C==="supplier"&&u.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-xl p-6 text-center",children:u.jsx("p",{className:"text-red-400",children:"Access Denied: Supplier role required"})})]}),u.jsx("footer",{className:"text-center p-4 mt-8 text-gray-500 text-sm",children:u.jsx("p",{children:"Built for the modern autonomous shop.  2024 Inventory AI"})}),u.jsx(b_,{toasts:i,onRemove:s})]})};console.log("[index.tsx] Starting app initialization...");const yx=document.getElementById("root");if(!yx)throw console.error("[index.tsx] Root element not found!"),new Error("Could not find root element to mount to");console.log("[index.tsx] Root element found, creating React root...");const aA=Ob.createRoot(yx);console.log("[index.tsx] Rendering App component...");aA.render(u.jsx(dg.StrictMode,{children:u.jsx(nA,{})}));console.log("[index.tsx] App rendered successfully");
